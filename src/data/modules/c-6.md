# Mapping Attacks to Defensive Controls

## 1. Orientation

### What this module covers
This module is the "Battle Map". Connecting the Sword (Attack) to the Shield (Control).

### Fit in the Learning Path
"We have a Firewall." "Okay, which attacks does that stop?" You must map capabilities to specific threats.

### Learning Objectives
By the end of this module, you should understand:
*   **Control Frameworks** (NIST CSF).
*   **Overlaying Maps**.
*   **Efficacy**.

---

## 2. Core Content

### The Mapping Logic
**Attack**: Phishing (Delivery).
*   **Control 1**: Email Gateway options (Filter).
*   **Control 2**: User Training (Human firewall).
*   **Control 3**: 2FA (Mitigation if Phishing succeeds).

**Attack**: Credential Dumping (Mimikatz).
*   **Control 1**: AV/EDR (Block execution).
*   **Control 2**: LSA Protection (Hardening).
*   **Control 3**: Log Analysis (Detection).

### Primary vs Compensating
*   **Primary**: Stops it. (Patch).
*   **Compensating**: Mitigates it if Primary fails. (WAF is a compensating control for bad code).

---

## 3. Guided Practice

### Workshop
**Threat**: Ransomware via RDP Brute Force.

**Map Controls**:
1.  **Prevent**: Close Port 3389 (Firewall).
2.  **Prevent**: Strong Passwords / MFA (Auth).
3.  **Detect**: Failed Login Alerts (SIEM).
4.  **Respond**: Isolate Host (EDR).
5.  **Recover**: Offline Backups.

**Gap Analysis**:
If "Offline Backups" is missing?
*   *Risk*: Total Data Loss.

---

## 4. Reflection Check

1.  **Redundancy**: Why have 3 controls for 1 threat? (Defense in Depth. If one fails, the others catch it).
2.  **Cost**: Is it worth spending $100k to block a $10 threat? (No. Risk Management).
3.  **Visualization**: Use Bow-Tie diagrams to visualize this.

---

## 5. Completion Criteria

This module is complete when:
1.  You can take a TTP (e.g., T1003) and list 3 controls for it.
2.  You distinguish between **Prevention** and **Detection** controls.
3.  You see defenses as a **Mesh**, not a Wall.
