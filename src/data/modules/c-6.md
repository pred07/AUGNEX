# Mapping Attacks to Defensive Controls

## 1. What this module covers
How to connect specific attacker techniques (TTPs) to specific defensive controls. If you can't draw a line between the attack and the defense, you have a gap.

## 2. Why this matters for purple teams
Randomly buying tools doesn't stop attacks. You must explicitly map "What stops Tactic X?".

## 3. Core concepts explained clearly

### The Matrix
*   **Technique**: Credential Dumping (T1003).
*   **Control**: Endpoint Detection & Response (EDR).
*   **Status**: Blocked? Detected? Logged? None?

### Layers of Controls
1.  **Preventative**: AppLocker blocks the mimikatz binary.
2.  **Detective**: EDR alerts on `lsass.exe` access.
3.  **Responsive**: SOAR script isolates the host.

## 4. Validation examples

### The Mapping Exercise
*   **Goal**: Stop Phishing (T1566).
*   **Map**:
    *   *Email Gateway*: Filters malicious attachments. (Prevent).
    *   *User Training*: Recognizes the lure. (Prevent).
    *   *EDR*: Blocks the payload if clicked. (Prevent/Detect).
    *   *DNS Firewall*: Blocks the C2 domain. (Prevent).
*   **Validation**: Test each layer. Does the Email Gateway actually block `.vbs` files?

## 5. Common gaps and failures
*   **Assumption of Overlap**: "We have Firewall and AV, so we are covered." Reality: Neither stops a PowerShell memory injection.
*   **Documentation Rot**: The documentation says "AV protects Servers". Reality: Servers were excluded from AV for performance 3 years ago.

## 6. Key takeaways
*   **Visualizing Coverage**: Use a heatmap. Green = Covered. Red = Open.
*   **Specifics**: Don't just say "Firewall". Say "Firewall Rule #55".
