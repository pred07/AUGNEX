# Git, Version Control, and Tool Management

## 1. Orientation

### What this module covers
This module covers Git and version control—essential skills for security professionals. Git is how you obtain security tools, manage scripts, collaborate with teams, and maintain audit trails.

### Fit in the Learning Path
Security tools live on GitHub. Exploits are shared via Git. Your own tooling and scripts need version control. Mastering Git is essential for any modern security practitioner.

### Learning Objectives
By the end of this module, you will:
*   Use Git to obtain and update security tools
*   Understand repository structure and safety
*   Manage your own scripts with version control
*   Recognize Git-related security risks

---

## 2. Core Content

### Mental Model: Time Machine for Code

**How professionals think about this:**
Git is a time machine—every change is recorded, and you can go back to any point. It's also a collaboration tool—multiple people can work on the same code without conflicts. For security professionals, it's both a tool library and evidence trail.

```
GIT CONCEPT:

VERSION HISTORY:
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  v1.0 ──► v1.1 ──► v1.2 ──► v1.3 ──► v2.0                         │
│   │                          │                                     │
│   └── Each version saved     └── Can go back to any point         │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘

DISTRIBUTED MODEL:
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  GitHub (Remote)                                                   │
│       │                                                            │
│       ├── Your Clone (Full copy + history)                        │
│       ├── Colleague's Clone (Full copy + history)                 │
│       └── Security Researcher's Clone                             │
│                                                                     │
│  Everyone has complete copy                                        │
│  Work offline, sync when ready                                     │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### Essential Git Commands

**Daily operations:**

```
GETTING CODE:
─────────────────────────────
# Download a repository
git clone https://github.com/user/repo.git

# Update to latest version
cd repo
git pull

BASIC WORKFLOW:
─────────────────────────────
# Check status
git status

# Add changes
git add filename.py
git add .  # All files

# Commit changes
git commit -m "Description of what changed"

# Push to remote
git push

VIEWING HISTORY:
─────────────────────────────
# View commit log
git log
git log --oneline  # Compact view

# View specific commit
git show abc123

# View changes
git diff

BRANCHES:
─────────────────────────────
# List branches
git branch

# Create and switch to new branch
git checkout -b new-feature

# Switch to existing branch
git checkout main

# Merge branch
git merge new-feature
```

### GitHub Repository Analysis

**Vetting before use:**

```
REPOSITORY ASSESSMENT:

TRUST INDICATORS:
─────────────────────────────
Stars:            Popularity/credibility
Forks:            Community adoption
Contributors:     Collaborative effort
Last commit:      Still maintained?
Issues:           Known bugs, responsiveness
Organization:     Official backing

RED FLAGS:
─────────────────────────────
0 stars, 0 forks:      Possibly malicious plant
Last commit 5+ years:  Abandoned, may not work
No license:            Legal uncertainty
Obfuscated code:       What's it hiding?
Asks for sudo/root:    Why does it need this?
No README:             Poor quality indicator

SECURITY ANALYSIS:
─────────────────────────────
1. Read the code before running
2. Check issues for security reports
3. Look at recent commits for suspicious changes
4. Verify author reputation
5. Use virtual environment for testing
```

### Security Tool Repositories

**Essential security resources:**

| Repository | Purpose | URL |
|------------|---------|-----|
| **SecLists** | Wordlists, payloads | github.com/danielmiessler/SecLists |
| **PayloadsAllTheThings** | Payload collections | github.com/swisskyrepo/PayloadsAllTheThings |
| **Impacket** | Python network tools | github.com/fortra/impacket |
| **BloodHound** | AD visualization | github.com/BloodHoundAD/BloodHound |
| **Responder** | LLMNR/NBT-NS poisoner | github.com/lgandx/Responder |
| **CrackMapExec** | Network pentest | github.com/byt3bl33d3r/CrackMapExec |
| **Nuclei Templates** | Vulnerability scanning | github.com/projectdiscovery/nuclei-templates |

```
SETTING UP TOOLS:
─────────────────────────────
# Clone tool
git clone https://github.com/fortra/impacket.git
cd impacket

# Read installation requirements
cat README.md

# Create virtual environment (isolation)
python3 -m venv venv
source venv/bin/activate

# Install dependencies
pip install -r requirements.txt
pip install .

# Keep updated
git pull
pip install . --upgrade
```

### Your Own Repository

**Managing your scripts:**

```
CREATING YOUR REPO:
─────────────────────────────
# Initialize new repo
mkdir my-scripts
cd my-scripts
git init

# Create initial content
echo "# My Security Scripts" > README.md
git add README.md
git commit -m "Initial commit"

# Connect to GitHub (after creating repo on GitHub)
git remote add origin https://github.com/you/my-scripts.git
git push -u origin main

GOOD PRACTICES:
─────────────────────────────
- Meaningful commit messages
- .gitignore for sensitive files
- README with usage instructions
- No credentials in code
- Organize with directories
```

### Git Security Considerations

**Risks and protections:**

```
SECURITY RISKS IN GIT:

1. CREDENTIALS IN HISTORY
   ─────────────────────────────
   git log shows deleted code
   Even if you delete password, it's in history
   
   NEVER commit:
   - API keys
   - Passwords
   - Private keys
   - .env files with secrets
   
   Use: .gitignore, environment variables

2. MALICIOUS REPOSITORIES
   ─────────────────────────────
   Clone + run = arbitrary code execution
   
   Attack vectors:
   - setup.py executes on install
   - Post-checkout hooks
   - Malware disguised as tools
   
   Defense: Audit code, use VMs, verify repos

3. EXPOSED .GIT DIRECTORIES
   ─────────────────────────────
   Web servers exposing /.git/
   Allows downloading entire repo + history
   
   Check: curl https://target.com/.git/HEAD
   
   Defense: Block .git in web server config

4. SENSITIVE DATA LEAKS
   ─────────────────────────────
   Developers commit secrets to public repos
   Tools like TruffleHog, GitLeaks find them
   
   Attack: Search GitHub for "password" in org's repos
```

### Git for Incident Response

**Forensic applications:**

```
GIT FORENSICS:

INVESTIGATING CHANGES:
─────────────────────────────
# Who changed what when
git log --follow -- suspicious-file.php

# What exactly changed
git show commit_hash

# Blame: Who wrote each line
git blame suspicious-file.php

# Find when code was added
git log -S "malicious_function" --source

COMPARING VERSIONS:
─────────────────────────────
# Diff between versions
git diff v1.0..v2.0

# Find commits in range
git log v1.0..v2.0 --oneline

RECOVERY:
─────────────────────────────
# Restore file from history
git checkout commit_hash -- filename

# View deleted files
git log --diff-filter=D --summary

# Recover deleted file
git checkout <commit_before_deletion>^ -- filename
```

### Advanced Git Operations

**Power user commands:**

```
ADVANCED COMMANDS:

# Stash changes temporarily
git stash
git stash pop

# Rebase (clean history)
git rebase main

# Cherry-pick specific commit
git cherry-pick abc123

# Reset to previous state
git reset --hard HEAD~1  # Careful! Destructive

# Find commit that introduced bug
git bisect start
git bisect bad
git bisect good v1.0
# Binary search through history

# Search code history
git grep "pattern"  # Current files
git log -p --all -S "pattern"  # All history
```

---

## 3. Guided Practice

### Exercise 1: Clone and Explore

Clone SecLists:
```bash
git clone https://github.com/danielmiessler/SecLists.git
```

1. How many commits in history? `git log --oneline | wc -l` ___
2. When was last commit? ___
3. How many contributors? ___

### Exercise 2: Repository Assessment

Evaluate a tool repository:

| Criteria | Finding |
|----------|---------|
| Stars | ___ |
| Last commit date | ___ |
| Open issues | ___ |
| Does setup.py exist? | ___ |
| Would you trust it? | ___ |

### Exercise 3: Create Your Repo

1. Create a local repo for your scripts
2. Add a README.md
3. Make initial commit
4. Check log to see your commit

---

## 4. Reflection Check

### Git Understanding
1. You push credentials to GitHub. You delete them and push again. Safe?

2. Tool hasn't been updated in 3 years but has 5000 stars. Use it?

3. Repository has 1 contributor, 0 stars, created yesterday. Run it?

### Practical Application
1. How do you keep security tools updated?

2. You find .git exposed on a website. Ethical considerations?

3. Team member commits API key. What's the proper remediation?

---

## 5. Key Misconceptions

**MYTH: "Deleting from code removes it from Git"**
REALITY: Git keeps full history. Secrets in history are recoverable. Must rewrite history (complex).

**MYTH: "Popular repo = safe repo"**
REALITY: Popular repos can be compromised. Supply chain attacks happen. Verify critical tools.

**MYTH: "git clone is like downloading a file"**
REALITY: Git clone downloads entire history and may execute hooks. Treat as code execution.

**MYTH: "Private repos are secure"**
REALITY: Private repos can leak via tokens, CI/CD, or team members. Don't commit secrets.

**MYTH: "GitHub is just for developers"**
REALITY: GitHub is essential for security—tools, research, collaboration, and investigation.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Clone** and update repositories
2. **Assess** repository trustworthiness
3. **Manage** your own scripts with Git
4. **Recognize** Git security risks
5. **Search** Git history for forensic analysis

---

## 7. Further Depth (Optional)

*   **Practice:** Create GitHub account and public repo
*   **Tool:** Use GitLeaks to find secrets in repos
*   **Research:** Git hook security implications
*   **Advanced:** Learn git rebase and history rewriting
