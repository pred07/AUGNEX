# Directory and Endpoint Enumeration

## 1. Orientation

### What this module covers
This module covers the tools, techniques, and wordlists used for brute-force discovery of hidden web content—directories, files, endpoints, and parameters that aren't linked from the visible application.

### Fit in the Learning Path
Finding /admin often equals game over. This module teaches the brute-force phase of web reconnaissance—systematically discovering content that developers assumed would remain hidden.

### Learning Objectives
By the end of this module, you will:
*   Master directory brute-forcing tools (Gobuster, FFuF, Feroxbuster)
*   Select and customize wordlists effectively
*   Interpret and act on scan results
*   Apply recursive and extension-based scanning

---

## 2. Core Content

### Mental Model: Guess and Check at Scale

**How professionals think about this:**
Brute-force discovery is educated guessing at scale. Every web application has paths the developers assumed you wouldn't guess—admin panels, backup files, debug endpoints. Systematic enumeration finds these.

```
DIRECTORY ENUMERATION LOGIC:

INPUT:
├── Target URL: https://target.com
├── Wordlist: [admin, backup, config, test, api, debug, ...]
└── Extensions: [.php, .bak, .zip, .txt]

PROCESS:
For each word in wordlist:
  ├── Request: GET /word HTTP/1.1
  │   └── Response: 200? 403? 301? 404?
  │
  └── For each extension:
      └── Request: GET /word.ext HTTP/1.1
          └── Response: 200? 403? 301? 404?

OUTPUT:
/admin        → 301 (Redirect to /admin/)
/admin/       → 200 (Admin panel found!)
/backup.zip   → 200 (Backup file!)
/config.php   → 403 (Exists but forbidden)
/api          → 301 (API endpoint!)
/test         → 404 (Doesn't exist)
```

### Core Tools

**Tool comparison:**

| Tool | Speed | Language | Best For |
|------|-------|----------|----------|
| **Gobuster** | Very Fast | Go | General directory busting |
| **FFuF** | Very Fast | Go | Flexible fuzzing, parameters |
| **Feroxbuster** | Fast | Rust | Recursive scanning |
| **Dirbuster** | Slow | Java | GUI, legacy |
| **Dirb** | Slow | C | Simple, reliability |
| **wfuzz** | Medium | Python | Complex fuzzing |

### Gobuster

**Basic usage:**

```bash
# Basic directory scan
gobuster dir -u http://target.com -w /path/wordlist.txt

# With file extensions
gobuster dir -u http://target.com -w wordlist.txt -x php,txt,bak,zip

# Common options
-t 50          # Threads (default 10)
-o results.txt # Output file
-r             # Follow redirects
-k             # Skip TLS verification
-a "Mozilla"   # Custom User-Agent
-c "cookie"    # Cookie for authenticated scan
-H "Header"    # Custom header
--timeout 10   # Timeout in seconds
-b 404,500     # Blacklist status codes
-s 200,301,302 # Whitelist status codes
```

**Gobuster modes:**

```bash
# Directory/file mode
gobuster dir -u http://target.com -w wordlist.txt

# DNS subdomain mode
gobuster dns -d target.com -w subdomains.txt

# Virtual host mode
gobuster vhost -u http://target.com -w vhosts.txt

# S3 bucket mode
gobuster s3 -w bucketnames.txt
```

### FFuF (Fuzz Faster U Fool)

**Flexible fuzzing:**

```bash
# Basic directory fuzzing
ffuf -u http://target.com/FUZZ -w wordlist.txt

# File extension fuzzing
ffuf -u http://target.com/FUZZ.EXT -w wordlist.txt:FUZZ -w extensions.txt:EXT

# Parameter fuzzing
ffuf -u "http://target.com/page?FUZZ=value" -w params.txt

# Value fuzzing
ffuf -u "http://target.com/page?id=FUZZ" -w numbers.txt

# POST data fuzzing
ffuf -u http://target.com/login -X POST \
     -d "username=admin&password=FUZZ" \
     -w passwords.txt

# Header fuzzing
ffuf -u http://target.com/api -H "X-Custom: FUZZ" -w values.txt

# Common options
-mc 200,301      # Match codes
-fc 404          # Filter codes
-fs 1234         # Filter by size
-fw 100          # Filter by word count
-fl 50           # Filter by line count
-t 50            # Threads
-o results.json  # Output
-of json         # Output format
```

### Feroxbuster

**Recursive scanning:**

```bash
# Basic scan (recursive by default)
feroxbuster -u http://target.com -w wordlist.txt

# Control recursion
--depth 3        # Limit depth
-n               # Disable recursion

# With extensions
feroxbuster -u http://target.com -w wordlist.txt -x php,bak

# Useful options
-t 50            # Threads
-o results.txt   # Output
--no-recursion   # Single level only
--extract-links  # Extract and scan links
--collect-words  # Build dynamic wordlist
-k               # Insecure (skip TLS)
-C 404,500       # Don't recurse into these
```

### Wordlists

**Essential wordlists (SecLists):**

```
SECLISTS DIRECTORY STRUCTURE:

/usr/share/seclists/
├── Discovery/
│   ├── Web-Content/
│   │   ├── directory-list-2.3-small.txt      (87K words)
│   │   ├── directory-list-2.3-medium.txt     (220K words)
│   │   ├── directory-list-2.3-big.txt        (1.2M words)
│   │   ├── common.txt                        (4.6K words)
│   │   ├── raft-small-words.txt              (43K words)
│   │   ├── raft-medium-words.txt             (63K words)
│   │   ├── raft-large-words.txt              (80K words)
│   │   └── big.txt                           (20K words)
│   └── DNS/
│       └── subdomains-top1million-*.txt
└── Fuzzing/
    └── Various specialized lists
```

**Wordlist selection strategy:**

| Scenario | Recommended Wordlist |
|----------|---------------------|
| Quick initial scan | common.txt, raft-small |
| Standard scan | directory-list-2.3-medium |
| Thorough scan | directory-list-2.3-big |
| CMS-specific | WordPress, Drupal specific lists |
| API endpoints | api-endpoints.txt |
| Sensitive files | .git, .env, backup.txt |

### Scanning Strategy

**Systematic approach:**

```
ENUMERATION WORKFLOW:

PHASE 1: QUICK SCAN
─────────────────────
gobuster dir -u http://target.com -w common.txt -t 50
Time: ~1 minute
Goal: Find obvious things quickly

PHASE 2: STANDARD SCAN
─────────────────────
gobuster dir -u http://target.com -w medium.txt -x php,bak,txt -t 50
Time: ~10 minutes
Goal: Comprehensive coverage

PHASE 3: RECURSIVE SCAN
─────────────────────
feroxbuster -u http://target.com/admin -w common.txt --depth 3
Time: Varies
Goal: Deep dive into interesting directories

PHASE 4: PARAMETER FUZZING
─────────────────────
ffuf -u "http://target.com/page?FUZZ=1" -w params.txt
Time: ~5 minutes
Goal: Find hidden parameters
```

### Interpreting Results

**Status code analysis:**

```
RESPONSE INTERPRETATION:

200 OK
└── Content exists, accessible
└── ACTION: Examine content

301 Moved Permanently
└── Directory exists, redirects (often to / version)
└── ACTION: Follow redirect, explore

302 Found (Temporary Redirect)
└── Might redirect to login
└── ACTION: Note destination

401 Unauthorized
└── Exists, requires authentication
└── ACTION: Try default creds, bypass techniques

403 Forbidden
└── Exists, access denied
└── ACTION: Try bypass (.., //, case changes)

404 Not Found
└── Usually doesn't exist
└── ACTION: Skip (unless custom 404)

500 Internal Server Error
└── Server-side issue, might be exploitable
└── ACTION: Investigate, might indicate vulnerability

503 Service Unavailable
└── Server overloaded or rate limiting
└── ACTION: Slow down scan
```

### Bypass Techniques

**When 403 Forbidden:**

```bash
# Path normalization bypasses
/admin             → 403
/admin/            → 200 (trailing slash)
/admin/.           → 200
/./admin           → 200
/admin/../admin    → 200
//admin            → 200
/admin;/           → 200 (Java)

# Case variations
/Admin
/ADMIN
/AdMiN

# URL encoding
/admin → /%61%64%6d%69%6e
/admin → /admin%00

# HTTP method variations
GET /admin → 403
POST /admin → 200

# Headers that might bypass
X-Original-URL: /admin
X-Rewrite-URL: /admin
X-Forwarded-For: 127.0.0.1
```

### Reducing Noise

**Rate limiting and stealth:**

```bash
# Gobuster delay
gobuster dir -u http://target.com -w wordlist.txt --delay 100ms

# FFuF rate limiting
ffuf -u http://target.com/FUZZ -w wordlist.txt -rate 100

# Random delays
ffuf -u http://target.com/FUZZ -w wordlist.txt -p 0.5-2.0

# Custom User-Agent
-a "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

# Rotate User-Agents
ffuf with multiple -H headers or custom script
```

---

## 3. Guided Practice

### Exercise 1: Basic Gobuster Scan

Write the command for:

1. Scan target.com with common.txt:
   ```bash
   ___
   ```

2. Add php, txt, bak extensions:
   ```bash
   ___
   ```

3. Output to file and use 50 threads:
   ```bash
   ___
   ```

### Exercise 2: FFuF Parameter Fuzzing

Write FFuF commands for:

1. Fuzz GET parameter names:
   ```bash
   ffuf -u "http://target.com/api?___=test" -w params.txt
   ```

2. Fuzz POST username field:
   ```bash
   ffuf -u http://target.com/login ___ -d "username=___&password=test" -w users.txt
   ```

### Exercise 3: Result Analysis

You get these results. What's your action for each?

| Path | Status | Action |
|------|--------|--------|
| /admin | 301 | ___ |
| /backup.zip | 200 | ___ |
| /config | 403 | ___ |
| /api/v2 | 401 | ___ |
| /debug | 500 | ___ |

---

## 4. Reflection Check

### Tool Understanding
1. You're scanning an API with JSON responses. Which tool and why?

2. You found /admin/ with 403. What techniques would you try?

3. The server is rate-limiting your scan. How do you proceed?

### Strategic Thinking
1. Bigger wordlist = longer scan. When is big.txt worth it?

2. You found /api/v1/. What's your next enumeration step?

3. Target uses a WAF that blocks fast scanning. Strategy?

---

## 5. Key Misconceptions

**MYTH: "Bigger wordlists are always better"**
REALITY: Time matters. Start small, expand if needed. A million-word scan takes hours.

**MYTH: "404 means it doesn't exist"**
REALITY: Custom 404 pages might return different status codes. Check response size.

**MYTH: "403 means it's fully protected"**
REALITY: 403 can often be bypassed with path tricks, headers, or method changes.

**MYTH: "One tool is enough"**
REALITY: Different tools have different strengths. FFuF for parameters, Feroxbuster for recursion.

**MYTH: "Automated scanning finds everything"**
REALITY: Manual inspection of JavaScript, error messages, and responses reveals more.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Construct** gobuster/ffuf commands for various scenarios
2. **Select** appropriate wordlists based on context
3. **Interpret** status codes and determine actions
4. **Apply** bypass techniques for 403 responses
5. **Implement** recursive and extension-based scanning

---

## 7. Further Depth (Optional)

*   **Wordlists:** Study and customize SecLists
*   **Tool:** Master FFuF for complex fuzzing scenarios
*   **Practice:** HackTheBox/TryHackMe enumeration challenges
*   **Automation:** Build custom enumeration scripts
