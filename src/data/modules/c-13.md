# Validating Process Execution Visibility

## 1. What this module covers
Verifying that you record every program that runs. If it ran, you must know about it.

## 2. Why this matters for purple teams
Malware is a process. Tools are processes. If you miss the process execution, you miss the attack execution.

## 3. Core concepts explained clearly

### EID 4688 (Process Creation)
*   The standard Windows Event.
*   Must enable "Include Command Line" in GPO.
*   Without Command Line, you see `powershell.exe`. (Useless).
*   With Command Line, you see `powershell.exe -enc <Base64>`. (Critical).

### Sysmon Event 1
*   Sysinternals Sysmon is better than native 4688.
*   Hashes the executable (MD5/SHA256).
*   Shows Parent Process GUID (Correlation).

## 4. Validation examples

### The "Obfuscation" Test
1.  **Action**: Rename `mimikatz.exe` to `winword.exe`. Run it.
2.  **Log Check (Name)**: Events show `winword.exe`. (Looks safe).
3.  **Log Check (Hash)**: Sysmon shows Hash `ABC...` (Matches Mimikatz).
4.  **Log Check (Description)**: "Mimikatz tool". (Metadata inside binary).
5.  **Conclusion**: Name-based logging failed. Hash-based logging succeeded.

## 5. Common gaps and failures
*   **No Command Lines**: The #1 failure. "Process Started: Cmd.exe". Doing what? We don't know.
*   **Short Retention**: Process logs are huge. If you only keep 1 day, you can't investigate yesterday's incident.

## 6. Key takeaways
*   **Hash everything**: Names are lies. Hashes are truth.
*   **Parent-Child**: Relationships define context. `explorer` -> `chrome` is fine. `tomcat` -> `cmd` is a webshell.
