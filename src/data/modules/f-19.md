# Windows Architecture (High-Level)

## 1. Orientation

### What this module covers
This module shifts focus from Linux to Windows. We explore the Registry, the Service Control Manager (SCM), and the core subsystems.

### Fit in the Learning Path
You cannot hack an Enterprise without hacking Windows. While Linux is the attacker's OS, Windows is usually the victim's OS. You must know your target.

### Learning Objectives
By the end of this module, you should understand:
*   The **Registry** (The central nervous system).
*   **Services** vs **Processes**.
*   The **HAL** (Hardware Abstraction Layer).

---

## 2. Core Content

### The Windows Philosophy
Unlike Linux's "Everything is a file", Windows uses distinct, structured APIs for everything. Objects are opaque.

### Key Components
1.  **The Registry**: A massive hierarchical database storing all configuration.
    *   **Hives**: `HKLM` (Local Machine), `HKCU` (Current User).
    *   *Security*: Malware loves to hide here for persistence (RunKeys).
2.  **Services (services.exe)**: Background processes (like Daemons in Linux). They start at boot.
3.  **DLLs (Dynamic Link Libraries)**: Shared code libraries.
    *   *Attack Vector*: DLL Injection / DLL Hijacking.
4.  **NT Kernel**: A Hybrid kernel. Drivers run in Kernel mode, but many subsystems run in User mode.

### The Filesystem structure
*   `C:\Windows`: The OS.
*   `C:\Program Files`: 64-bit Apps.
*   `C:\Program Files (x86)`: 32-bit Apps (Legacy).
*   `C:\Users`: User profiles.

---

## 3. Guided Practice

### Exploring the Registry
**Warning**: Do not *change* anything unless you want a broken PC.

**Step 1: Open RegEdit**
*   Press `Win + R`.
*   Type `regedit` and hit Enter.

**Step 2: Navigate to Run Keys**
This is where programs set themselves to auto-start.
*   Go to: `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run`.
*   **Observation**: You will see apps like OneDrive, Steam, or Spotify here.
*   **Malware**: If you see `random_name.exe` here, you are infected.

**Step 3: View Services**
*   Press `Win + R`.
*   Type `services.msc`.
*   **Action**: Find "Windows Update". Note that it is likely "Running" and set to "Manual" or "Automatic".

---

## 4. Reflection Check

1.  **Persistence**: Why do attackers prefer the Registry over the Startup Folder? (It's harder for normal users to inspect).
2.  **Architecture**: Why does Windows split 32-bit and 64-bit programs into different folders?
3.  **Kernel**: What is the "Blue Screen of Death" physically showing you? (A memory dump of the crashed Kernel).

---

## 5. Completion Criteria

This module is complete when:
1.  You have opened `regedit` without panicking.
2.  You have navigated to the `Run` key.
3.  You understand that Windows configuration is centralized in a database, not text files.
