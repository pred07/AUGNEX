# Data Protection: KMS & Encryption

## 1. Orientation

### What this module covers
In the cloud, you don't control the physical hard drives. You must rely on Encryption. This module covers **KMS (Key Management Service)**, Server-Side Encryption (SSE), and Protecting S3 buckets.

### Learning Objectives
*   Understand **Envelope Encryption**.
*   Differentiate between **Customer Managed Keys (CMK)** and AWS Managed Keys.
*   Secure S3 Buckets against public leaks.

---

## 2. Core Content

### Key Management Service (KMS)
KMS creates and manages the Root Keys. 
*   **AWS Managed Key:** Free, easy. You don't control the policy.
*   **Symmetric CMK:** You control the rotation and policy. Used for EBS/S3.

### Envelope Encryption
KMS does not encrypt your 1TB database. It's too slow. 
1.  KMS generates a **Data Key**. 
2.  The Data Key encrypts the Database.
3.  KMS encrypts the Data Key with the Root Key.
4.  The Encrypted Data Key is stored *with* the database.

### S3 Security
S3 leaks are the most common cloud vulnerability.
*   **Block Public Access (BPA):** A global setting on the bucket. Turn this ON.
*   **Bucket Policy:** JSON policy similar to IAM.
*   **Encryption:** SSE-S3 (AWS Keys) or SSE-KMS (Your Keys).

---

## 3. Lab: Encrypting the World

### Task
You have a requirement: "If a drive is pulled from the rack in the data center, the data must be unreadable."

**Solution: EBS Encryption.**
*   When creating an EC2 instance, check "Encrypt EBS Volume".
*   Choose a KMS Key.
*   *Result:* The data is encrypted at rest. AWS handles the decryption transparently when the instance reads from the disk **IF** the instance role has permissions to use the Key.

---

## 4. Reflection
1.  If you confuse the KMS Key Policy, can you lock yourself out of your own data? (Yes. Key Policies are the only way to control access to the key. Even Root can be locked out if the policy denies it).
2.  What is "Crypto-shredding"? (Deleting the Key effectively deletes the data, because the data can never be decrypted again. Useful for GDPR 'Right to be Forgotten').
