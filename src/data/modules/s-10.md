# The Dark Web & Underground Forums

## 1. Orientation

### What this module covers
This module de-mystifies the "Dark Web" by treating it as a network architecture problem, not a ghost story. We cover the **Onion Routing protocol**, the **cryptographic mechanics** of Hidden Services, and the **operational security (OPSEC)** required to conduct research without becoming a victim.

### Fit in the Learning Path
Before you can track adversaries or monitor ransomware leak sites (S-36), you must understand the terrain. You wouldn't enter a hostile physical territory without a map and protection; the Dark Web is no different.

### Learning Objectives
*   Explain the **3-hop circuit** architecture of Tor (Guard, Middle, Exit) vs Onion Services (6-hop).
*   Configuring a segregated research environment (VM/Whonix).
*   Understand the difference between **Surface**, **Deep**, and **Dark** web.
*   Identify the risks of "deanonymization" attacks.

---

## 2. Core Content

### The Topology of the Internet

1.  **Surface Web (~4%):** Indexed by search engines (Google, Bing). Traceable connections.
2.  **Deep Web (~90%):** Non-indexed but standard technology. Corporate intranets, medical databases, iCloud storage. Accessible via standard browsers but requires auth.
3.  **Dark Web (~6%):** Overlay networks requiring specific software (Tor, I2P, Freenet). Not indexed, encrypted, anonymized.

### Engineering the Onion (Tor)

Tor (The Onion Router) is not magic; itâ€™s **layered encryption**.

**Standard Circuit (Accessing clear web via Tor):**
Client `[Layer 1 + Layer 2 + Layer 3]` ->
1.  **Entry Guard (Knows You):** Peels Layer 1. Does not know destination.
2.  **Middle Relay (Knows Nothing):** Peels Layer 2. Passing encrypted data.
3.  **Exit Node (Knows Destination):** Peels Layer 3. Sends unencrypted request to `example.com`.
    *   *Risk:* The Exit Node can see the traffic content (if HTTP) but not the source.

**Hidden Services (`.onion`):**
A different beast. The server (e.g., LockBit Blog) is also hidden.
*   **Rendezvous Point:** The client and server meet in the middle.
*   **6 Hops:** 3 hops from Client + 3 hops from Server.
*   **Result:** End-to-end encryption. The Exit Node concept does not apply. No one knows where the server is hosted physically.

### The Analyst's Workbench: OPSEC

**Rule 1: Isolation**
*   **Never** use your host OS browser.
*   **Gold Standard:** Whonix (Gateway VM + Workstation VM). Even if the Workstation is compromised, it only sees the Gateway's local IP, not your real Public IP.
*   **Silver Standard:** Tails OS (Live USB). Ammesic (forgets everything on reboot).
*   **Bronze Standard:** Tor Browser Bundle (Bare metal). Vulnerable to browser exploits leaking local IP.

**Rule 2: Identity Hygiene**
*   Never log into personal accounts (Gmail, Facebook) while on a research identity.
*   Window sizing: Keep default size. Resizing creates a unique fingerprint (resolution) traceable across sessions.
*   Javascript: **Disable it** (Security Level: Safest). 99% of deanonymization attacks use JS.

---

## 3. Lab: Research Station Setup (Conceptual)

### Task 1: Architecture Design
Design a research station for a CTI team.
*   **Requirement:** Persistent storage for evidence, but total network isolation.
*   **Solution:**
    *   **Host:** Linux (Ubuntu).
    *   **Virtualizer:** VirtualBox / KVM.
    *   **VM 1 (Gateway):** Whonix Gateway (Connects to Tor). Two NICs (NAT + Internal).
    *   **VM 2 (Workstation):** Whonix Workstation (Connects ONLY to Internal Network).
    *   **Logic:** VM 2 has *no route* to the internet except through Tor. Malware cannot beacon to a non-Tor IP.

### Task 2: Access Check
(If you have Tor Browser installed)
1.  Connect to `check.torproject.org`.
2.  Verify the IP address is NOT your ISP's IP.
3.  Notice the "Circuit" view in the browser: Guard (Germany) -> Middle (France) -> Exit (USA).

---

## 4. Advanced: Bridges and Pluggable Transports
What if your ISP or Government blocks Tor?
*   **Bridges:** Secret entry nodes not listed in the public directory.
*   **Obfs4:** Obfuscation protocol that makes Tor traffic look like random noise or unencrypted TCP, bypassing Deep Packet Inspection (DPI).

---

## 5. Reflection
1.  **Ethical Boundary:** Is it illegal to visit a drug market? (Generally no). Is it illegal to buy? (Yes). Is it illegal to view Child Sexual Abuse Material (CSAM)? (YES - Strict liability. **Stay away.** Accidental exposure is a career-ending risk for analysts without legal cover).
2.  **Deanonymization:** How did the FBI catch Silk Road users? (Often operational mistakes, not breaking Tor encryption. Captchas, shipping addresses, or correlation attacks).

---

## 6. Completion Criteria
1.  **Draw** the path of a packet from a Client to a Hidden Service (Rendezvous Point).
2.  **Explain** why resizing the Tor Browser window is an OPSEC failure.
3.  **Define** the purpose of an Entry Guard logic (preventing correlation attacks).
