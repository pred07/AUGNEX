# Network Device Logging (Firewalls, Routers)

## 1. Orientation

### What this module covers
This module covers logs from the infrastructure: **Firewalls**, **Routers**, and **VPN Concentrators**.

### Fit in the Learning Path
Endpoint logs show what happened *on the box*. Network logs show how they got there.

### Learning Objectives
By the end of this module, you should understand:
*   **NetFlow** (Metadata).
*   **Packet Capture** (Full Content).
*   **Deny vs Permit** logs.

---

## 2. Core Content

### Firewall Logs
"Who talked to Whom?"
*   Format: `SrcIP:Port -> DstIP:Port | Action (Allow/Block)`.
*   *Constraint*: High volume. A firewall logs millions of events per hour.

### NetFlow (Cisco)
Records the *metadata* of a connection, not the content.
*   "1.1.1.1 sent 500MB to 2.2.2.2 using port 443".
*   Value: Bandwidth usage, Data Exfiltration detection.

### PCAP (Packet Capture)
Full recording of the traffic.
*   Value: Infinite. You can see the actual malware download.
*   Cost: Massive storage. Usually only triggered on alerts.

---

## 3. Guided Practice

### Reading a Firewall Log
**Log Entry**:
`Deny TCP 203.0.113.5:54321 -> 192.168.1.10:22`

**Analysis**:
1.  **Attacker**: `203.0.113.5` (Public IP).
2.  **Target**: `192.168.1.10` (Internal Server).
3.  **Port**: 22 (SSH).
4.  **Action**: Denied. The firewall did its job.

**Decision**:
Ignore? Yes. The firewall blocked it. It's just background internet noise.

---

## 4. Reflection Check

1.  **Exfiltration**: If you see an Internal IP sending 50GB to a Public IP via Port 53 (DNS), what is happening? (DNS Tunneling exfiltration).
2.  **Encryption**: Can Firewall logs read the content of HTTPS traffic? (No. They only see the IPs and Ports. You need a Proxy for content).
3.  **Correlation**: Why match Firewall logs with Endpoint logs? (The Firewall says "Packet Arrived". The Endpoint says "Application Accepted It". You need both to confirm impact).

---

## 5. Completion Criteria

This module is complete when:
1.  You can read a "5-Tuple" (SrcIP, SrcPort, DstIP, DstPort, Protocol).
2.  You understand the difference between NetFlow (Envelope) and PCAP (Letter).
3.  You treat massive outbound traffic spikes as suspicious.
