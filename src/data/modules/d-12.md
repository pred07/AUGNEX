# Network Device Logging (Firewalls, Routers)

## 1. Unit Brief: Traffic Control
Servers tell you what happened on the host. Network devices tell you what happened on the wire. They spot C2 beacons, extraction large files, and port scanning.

## 2. Real-World Relevance
*   If a hacker installs a Rootkit, the host logs might be tampered with.
*   The Network Logs (Firewall) cannot be tampered with by the host. They are the "Source of Truth".

## 3. Core Concepts

### Firewall Logs
*   **Allow/Deny**: Packet from A to B on Port X.
*   **State**: Start, End, Duration, Bytes Transferred.
*   **Next Gen FW (L7)**: Can see "URL Visited", "User ID", "Application (Spotify)".

### Router/Switch Logs
*   **NetFlow/IPFIX**: Metadata. "Who talk to whom". Great for bandwidth analysis and DDoS detection.
*   **Config Changes**: "User changed the routing table". (Critical security event).

## 4. Practical Examples

### Finding the Beacon
Review firewall logs for "Deny" outbound traffic.
*   Internal Server (10.0.0.5) tries to connect to Unknown IP on Port 4444. Denied.
*   Repeats every 60 seconds exactly.
*   **Conclusion**: Malware trying to phone home.

### Data Exfiltration
Review byte counters (NetFlow).
*   User PC typically uploads 50MB/day.
*   Today uploaded 4GB to a Dropbox IP.
*   **Alert**: Potential data theft.

## 5. Common Mistakes Beginners Make
*   **Logging Deny only**: You need to log "Accept" too. If the attacker gets *in*, the Deny log won't show it. You need the Accept log to trace their movement.
*   **No Names**: Logs show IPs. DHCP changes IPs. You need to map IP->Hostname (DNS logs) to know who it was *at that time*.

## 6. Key Takeaways
*   **NetFlow is efficient**: Stores months of traffic data in small space.
*   **Firewalls see all**: The chokepoint of the network.
