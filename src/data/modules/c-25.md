# Baseline Creation and Drift Detection

## 1. What this module covers
Defining "Normal" so that "Abnormal" stands out.

## 2. Why this matters for purple teams
Anomalies are only visible against a baseline. If you don't know what your servers usually do, you can't tell if they are hacked.

## 3. Core concepts explained clearly

### The Baseline
*   **User**: Logs in 9-5, Mon-Fri, from London.
*   **Server**: Talks to DB on port 1433. Never talks to Internet.
*   **Process**: `iis.exe` always runs. `cmd.exe` never runs.

### Drift
*   A change from the baseline.
*   **Benign Drift**: Admin installs new software.
*   **Malicious Drift**: Hacker adds persistence key.

## 4. Validation examples

### Stacking
A technique to find outliers.
1.  **Query**: Count Occurrences of `ProcessName` across all servers.
2.  **Result**:
    *   `svchost.exe`: 500 servers. (Normal).
    *   `evil.exe`: 1 server. (Outlier!).
3.  **Purple Test**: Introduce a unique process on one server. see if the Stacking Report catches it.

## 5. Common gaps and failures
*   **Dynamic Environments**: In the Cloud, IPs change every minute. Baselining by IP fails. Baseline by *Role* (Tag).
*   **Alerting on Noise**: Setting tight baselines results in false positives every time an update runs.

## 6. Key takeaways
*   **Least Frequency**: The most rare event is usually the most interesting.
*   **Updates**: Baselines must auto-update or they become useless.
