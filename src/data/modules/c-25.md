# Baseline Creation and Drift Detection

## 1. Orientation

### What this module covers
This module covers **Drift**. How systems change over time and how to detect it.

### Fit in the Learning Path
Attackers change the system. Persistence, New Users, New Services. Detection is "Diffing the State".

### Learning Objectives
By the end of this module, you should understand:
*   **Golden Images**.
*   **Configuration Management** (Ansible/Terraform).
*   **Integrity Monitoring** (FIM).

---

## 2. Core Content

### The Gold Standard
You know what Server A *should* look like.
*   Open Ports: 80, 443, 22.
*   Services: Nginx, Sshd.

### The Drift
*   **Scan**: Port 8080 is now open.
*   **Verdict**: Anomaly. Did an admin open it? Or a hacker?
*   *Action*: Alert on Drift.

### File Integrity Monitoring (FIM)
*   Watch `/etc/passwd` and `C:\Windows\System32`.
*   If checksum changes -> Alert.

---

## 3. Guided Practice

### Simulating Persistence
**Action**: Create a new Scheduled Task `Updater.exe`.
**Detection**:
1.  FIM should catch the new file creation.
2.  Registry Monitor should catch the new Task Key.
3.  Baseline Monitor should see "New Autorun Item".

---

## 4. Reflection Check

1.  **Noise**: Patch Tuesday changes 5,000 files. FIM explodes. (Solution: Maintenance Windows. Silence alerts during patching).
2.  **DevOps**: "Infrastructure as Code" makes this easier. If it's not in the Terraform file, it shouldn't exist.
3.  **Quick Win**: Monitor "Domain Admins" group membership. It should almost never change.

---

## 5. Completion Criteria

This module is complete when:
1.  You implement **FIM** on critical files.
2.  You detect **New Open Ports**.
3.  You review **Group Membership Changes** daily.
