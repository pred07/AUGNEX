# Malware Analysis: Static Properties

## 1. Orientation

### What this module covers
Malware Analysis is the art of dissecting malicious software to understand *what* it does and *how* to stop it. We start with **Basic Static Analysis**â€”examining the file without running it. It is safe, fast, but limited by obfuscation.

### Learning Objectives
*   Calculate and search file **Hashes**.
*   Extract **Strings** to find IP addresses or text.
*   Inspect the **PE Header** (Import Address Table).
*   Use **Packer Detection** (PEiD/Die).

---

## 2. Core Content

### Hashing & VirusTotal
The first step: Fingerprint the file.
*   `sha256sum malware.exe`
*   Search the hash on VirusTotal. If 50/60 vendors detect it, you save time.

### Strings
Running `strings malware.exe` extracts printable characters. 
*   *Look for:* IPs (`1.2.3.4`), URLs (`http://evil.com`), filenames (`ransom_note.txt`), API calls (`CreateProcess`).
*   *Limitation:* Packed malware looks like garbage code.

### The PE Header (Windows Executables)
The Portable Executable (PE) header tells the OS how to load the program. The **Import Address Table (IAT)** lists the DLLs and functions the malware imports.
*   *Suspicious Imports:* `InternetOpen` (Network), `CryptEncrypt` (Ransomware?), `SetWindowsHookEx` (Keylogger?).

### Packing
Malware authors "Pack" (compress/encrypt) their verify code to hide strings.
*   **Signs of Packing:** High Entropy (randomness), very few Imports (`GetProcAddress`, `LoadLibrary`), section names like UPX.

---

## 3. Lab: The Skeptic's View

### Scenario
You have a file `invoice.exe`.
1.  **Hash:** Unknown in VirusTotal.
2.  **Strings:** You see nothing readable except "UPX0" and "UPX1".
3.  **Imports:** Only `LoadLibrary` and `GetProcAddress`.

**Conclusion:** The file is **Packed**. Static analysis is hitting a wall. You must unpack it or use Dynamic Analysis.

---

## 4. Reflection
1.  Why is entropy a sign of packing? (Encrypted data looks statistically random/high noise, whereas code has patterns).
2.  Can static analysis detonate the malware? (No. You are reading the file, not executing CPU instructions).
