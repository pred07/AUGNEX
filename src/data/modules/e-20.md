# Parameter Discovery and Mapping

## 1. Unit Brief: The Hidden Variables
Sometimes the endpoint is known, but the parameters are hidden. An API might accept a `debug=true` parameter that isn't documented. Parameter discovery helps you find these hidden knobs to turn.

## 2. Real-World Relevance
*   **Mass Assignment**: An update profile endpoint takes `username` and `email`. But if you add `&role=admin`, the backend blindly processes it. You wouldn't know to try `role` without parameter discovery.

## 3. Core Concepts

### Purpose
To identify undocumented arguments that the server processes.
*   Debug flags: `debug`, `test`, `verbose`.
*   Privilege flags: `admin`, `role`, `privilege`.
*   Routing flags: `redirect`, `url`, `next`.

### Tools
*   **Arjun**: Specialized tool for parameter discovery.
*   **Param Miner**: Burp Suite extension (Excellent for finding header poisoning too).

## 4. Practical Examples

### Using Arjun
```bash
$ arjun -u http://target.com/search
Scanning...
[+] Heuristic scan found 1 parameter: q
[+] Brute force found 2 parameters: id, debug
```
*   **Discovery**: `id` and `debug` were not in the HTML form.
*   **Exploitation**: Try `?debug=true`. The server creates a stack trace, revealing internal paths.

### Identifying Reflection
If you send `?page=user`, does "user" appear on the page?
*   Yes: Potential XSS.
*   No: Maybe it's used in a SQL query (SQLi)?

## 5. Common Mistakes Beginners Make
*   **Only testing visible params**: Focusing only on the form inputs you see.
*   **Ignoring Headers**: Parameters aren't just in the URL. They can be in the POST body or Headers.

## 6. Key Takeaways
*   **Hidden does not mean Secure**: Developers leave backdoor parameters for testing and forget to remove them.
*   **Fuzz everything**: If there is an endpoint, fuzz it for params.
