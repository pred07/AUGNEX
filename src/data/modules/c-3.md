# Why Security Controls Fail

## 1. What this module covers
An analysis of why expensive security tools often fail to stop basic attacks. It explores the gap between "Purchased" and "Deployed".

## 2. Why this matters for purple teams
Purple Teaming is essentially "Quality Assurance" for security controls. You cannot fix what you don't know is broken.

## 3. Core concepts explained clearly

### The 3 Failure Modes
1.  **Misconfiguration**: The tool has the capability, but it was turned off. (e.g., EDR installed but set to "Audit Only" instead of "Block").
2.  **Blind Spots**: The tool isn't everywhere. (e.g., Shadow IT servers that have no EDR agent).
3.  **Bypass**: The tool is working, but the attacker found a logic flaw to evade it. (e.g., Unhooking EDR APIs).

### Decay
Security controls decay over time.
*   Day 1: Firewall rules are perfect.
*   Day 90: Admin adds "Temporary Allow Any" rule for troubleshooting and forgets it.
*   Day 100: Hack.

## 4. Validation examples

### Validating EDR Coverage
*   **Scenario**: You have 5000 endpoints.
*   **Validation**: Compare Active Directory Computer objects vs EDR Management Console.
*   **Query**: `LDAP(All Computers)` - `EDR(All Agents)`.
*   **Result**: Found 50 computers with no EDR. (These are the entry points).

### Validating Email Filtering
*   **Scenario**: "We block all .exe attachments."
*   **Test**: Rename `malware.exe` to `malware.txt`. Email it.
*   **Result**: It arrives. User renames it back and runs it.
*   **Conclusion**: Control failed (Extension filtering is weak). Move to MIME-type filtering.

## 5. Common gaps and failures
*   **Default Settings**: Vendors ship tools in "Compatible" mode (Insecure). You must tune them to "Secure" mode.
*   **Silent Failures**: The logs stopped shipping 3 weeks ago because the disk was full. Nobody noticed because nobody checks the "Health" dashboard.

## 6. Key takeaways
*   **Trust but Verify**: Never assume a control works because the dashboard says "Green". Test it.
*   **Regression Testing**: Test your controls after every major network change.
