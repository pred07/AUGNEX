# Terraform: Provisioning Infrastructure

## 1. Orientation

### What this module covers
Terraform is the industry standard for **Provisioning** infrastructure (Hardware). It uses HCL (HashiCorp Configuration Language). We will learn how to define resources, manage state, and use providers.

### Learning Objectives
*   Write basic HCL syntax (`resource`, `provider`, `variable`).
*   Understand the **Terraform State File** (`.tfstate`) and its sensitivity.
*   Execute the Workflow: `init` -> `plan` -> `apply`.

---

## 2. Core Content

### The Workflow
1.  **Write:** Define infrastructure in `main.tf`.
2.  **Init:** `terraform init` downloads necessary plugins (e.g., AWS provider).
3.  **Plan:** `terraform plan` compares your code to the current state. It tells you *exactly* what it will create/destroy.
4.  **Apply:** `terraform apply` executes the changes.

### The State File (`terraform.tfstate`)
This JSON file maps your code to real-world resources. 
*   **CRITICAL SECURITY RISK:** The state file often contains PLAINTEXT SECRETS (DB passwords) even if you used variables. 
*   **Protection:** Store state remotely (S3 Backend) with Encryption (KMS) and Access Control.

### HCL Syntax Example
```hcl
provider "aws" {
  region = "us-east-1"
}

resource "aws_s3_bucket" "logs" {
  bucket = "my-secure-logs"
  acl    = "private"

  versioning {
    enabled = true
  }
}
```

---

## 3. Lab: Reading a Plan

### Task
You run `terraform plan` and see:
```diff
  # aws_security_group.allow_ssh will be updated in-place
  ~ ingress {
      cidr_blocks = [
        - "10.0.0.0/8",
        + "0.0.0.0/0",
      ]
    }
```
**Analysis:** usage of `~` means modification. The `+` indicates adding `0.0.0.0/0` (Anywhere) to SSH. 
**Action:** ABORT. Do not apply. Ideally, a Policy-as-Code tool should block this automatically.

---

## 4. Reflection
1.  Why should you never commit `.tfstate` to Git? (It exposes secrets and locks the state to your local machine).
2.  What is `terraform destroy`? (The nuclear option. It deletes everything defined in the configuration).
