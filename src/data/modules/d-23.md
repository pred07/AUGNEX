# Endpoint Telemetry and Signals

## 1. Orientation

### What this module covers
This module defines the specific signals we look for on an endpoint. **Process Parenting**, **Registry Changes**, and **Network Connections**.

### Fit in the Learning Path
You have an EDR. Now, what do you look for?

### Learning Objectives
By the end of this module, you should understand:
*   **Parent-Child Relationships**.
*   **LOLBins** (Living Off The Land Binaries).
*   **Persistence Mechanisms**.

---

## 2. Core Content

### Process Parenting
Processes spawn other processes.
*   **Normal**: `explorer.exe` -> `chrome.exe`.
*   **Evil**: `winword.exe` -> `cmd.exe`. (Macro virus).
*   **Evil**: `calc.exe` -> `powershell.exe`. (Injection).

### LOLBins
Using built-in Windows tools for evil.
*   `certutil.exe`: Normally for certificates. Hackers use it to download files (`-urlcache`).
*   `rundll32.exe`: To run malicious DLLs.

---

## 3. Guided Practice

### Hunting Queries
**Scenario**: Find the Macro Malware.

**Query**:
`ParentImage ends with "winword.exe" OR "excel.exe" OR "powerpnt.exe"`
AND
`Image ends with "cmd.exe" OR "powershell.exe"`

**Scenario**: Find the Download.
**Query**:
`CommandLine contains "certutil" AND "-urlcache"`

---

## 4. Reflection Check

1.  **False Positives**: When does Excel legitimately spawn CMD? (Very rarely. Maybe a developer macro. Usually 99% malicious).
2.  **Context**: Is `powershell.exe -enc <blob>` bad? (Usually. Admins write clear scripts. Hackers encode them).
3.  **Volume**: Can you watch every Process Creation? (Yes, EDRs handle this volume easily).

---

## 5. Completion Criteria

This module is complete when:
1.  You can spot a suspicious Parent-Child relationship.
2.  You know that `certutil` is an attacker's friend.
3.  You start reading **CommandLine** arguments, not just Process Names.
