# Endpoint Telemetry and Signals

## 1. Unit Brief: What to Watch
To catch a hacker on an endpoint, you need to record specific events.

## 2. Real-World Relevance
If you don't record "Command Line Arguments", you will see `powershell.exe` ran, but you won't know IF it ran `Write-Host "Hello"` (Safe) or `Invoke-Mimikatz` (Bad).

## 3. Core Concepts

### Top Telemetry Sources
1.  **Process Creation**: `Who` started `What`?
2.  **Network Connections**: `Process` talked to `IP`.
3.  **File Modifications**: `Process` created `File`.
4.  **Registry Modifications**: `Process` added `Run Key`.

### PowerShell Logging
PowerShell is the hacker's favorite tool.
*   **Script Block Logging**: Logs the full content of the script, even if it was obfuscated/encrypted.

## 4. Practical Examples

### Command Line Auditing
*   **Event**: `cmd.exe /c "net user hacker Password123 /add"`
*   **Signal**: Detailed Command Line captures the intent.

### Registry Signal
*   **Event**: Key added to `HKCU\...\Run`.
*   **Value**: `C:\Users\Public\update.exe`.
*   **Signal**: Persistance mechanism detected.

## 5. Common Mistakes Beginners Make
*   **Noise**: Monitoring ALL file reads. (Windows reads thousands of files per second). Only monitor interactions with sensitive files or specific file writes (like `.exe` creation).

## 6. Key Takeaways
*   **Context**: Process Name is not enough. You need Parent, User, and Command Line.
