# Cleanup and Client Safety

## 1. Unit Brief: Leave No Trace
The job isn't done until the environment is restored. Leaving artifacts (files, users, logs) exposes the client to risk. Cleanup is a professional requirement.

## 2. Real-World Relevance
Imagine you uploaded a `shell.php` to a financial server. You forgot to delete it. Two weeks later, a bot scanner finds it and installs ransomware. **You are liable**.

## 3. Core Concepts

### Artifacts to Remove
1.  **Executables**: `mimikatz.exe`, `nc.exe`, `linpeas.sh`.
2.  **Scripts**: Python or PowerShell scripts you dropped.
3.  **Users**: Any `hacker` accounts created.
4.  **Logs**: Don't wipe logs (that destroys evidence of your work for the client), but telling the client *what* you did helps them tag looking for it.

### Verification
*   Test that the system works normally. Did your exploit crash a service? Restart it.
*   Did you change a password? Change it back or notify the client to reset it.

## 4. Practical Examples

### The Cleanup script
Pentesters often keep a log of files uploaded.
`uploaded_files.txt`:
- `/tmp/linpeas.sh`
- `/var/www/html/shell.php`
- `/home/user/.ssh/authorized_keys` (Line 4)

Manual Cleanup:
`rm /tmp/linpeas.sh`
`rm /var/www/html/shell.php`
`sed -i '4d' /home/user/.ssh/authorized_keys`

## 5. Common Mistakes Beginners Make
*   **"I'll do it later"**: No. Do it as soon as you are done with that box.
*   **Wiping Event Logs**: `wevtutil cl System`. This looks incredibly suspicious and malicious. Don't do it unless you are simulating an APT covering tracks (Red Team).

## 6. Key Takeaways
*   **Professionalism**: Leaving a mess is amateur.
*   **Safety**: Your tools are weapons. Don't leave loaded weapons lying around.
