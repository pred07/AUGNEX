# Detecting Malicious Processes

## 1. Unit Brief: Spotting the Imposter
Malware tries to blend in. It uses names like `svchost`, `explorer`, `java`. Detection requires analyzing the *relationships* and *attributes* of the process.

## 2. Real-World Relevance
Cobalt Strike (a popular C2 framework) uses "Beacon" payloads that inject into legitimate processes. You won't see "CobaltStrike.exe". You will see "rundll32.exe" behaving badly.

## 3. Core Concepts

### Parent-Child Analysis
*   **Normal**: `explorer.exe` spawns `chrome.exe`.
*   **Abnormal**: `winword.exe` spawns `cmd.exe`. (Why does a document need a command prompt?).
*   **Abnormal**: `tomcat.exe` spawns `whoami.exe`. (Webshell).

### Least Frequency of Occurrence (LFO)
*   You have 1000 laptops.
*   999 have `chrome.exe` v88.
*   1 has `chrome.exe` v99 in a different folder.
*   **Investigate the outlier**.

## 4. Practical Examples

### The RDP Backdoor
*   **Process**: `sethc.exe` (Sticky Keys).
*   **Normal**: Runs when you press Shift 5 times.
*   **Hack**: Attacker replaced `sethc.exe` with `cmd.exe`.
*   **Detection**: Hash change of `sethc.exe`, or `sethc.exe` spawning child processes.

### Memory Scanning
*   Malware packed/encrypted on disk decrypts itself in memory.
*   **YARA**: Tool to scan memory for strings that indicate unpacked malware.

## 5. Common Mistakes Beginners Make
*   **Only looking at Actives**: Malware might inject, run one command, and die. You need historical EDR logs to see what *ran* 5 minutes ago.

## 6. Key Takeaways
*   **Ancestry**: Always asking "Who started you?".
*   **Standard Deviation**: Malware is unique. Find the unique thing.
