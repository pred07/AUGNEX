# Container Security (Docker/K8s)

## 1. Orientation

### What this module covers
This module covers **Docker** and **Kubernetes**. Ephemeral, immutable infrastructure.

### Fit in the Learning Path
Modern apps run in containers. If you treat them like VMs, you will be hacked.

### Learning Objectives
By the end of this module, you should understand:
*   **Image Security** (Supply chain).
*   **Runtime Security**.
*   **Orchestration Risks** (K8s API).

---

## 2. Core Content

### The Image
*   **Layering**: Built from base images (`FROM ubuntu`).
*   **Risk**: If the base image has malware, your container has malware.
*   **Fix**: Scan images in CI/CD pipeline.

### The Runtime
*   **Privileged Mode**: `docker run --privileged`. (Gives Root access to the host). **Do not do this**.
*   **Isolation**: Containers share the Kernel. VM isolation is stronger.

### Kubernetes (K8s)
*   The Captain of the ship.
*   **Risk**: If you expose the Kubelet API to the internet, anyone can run pods on your cluster.

---

## 3. Guided Practice

### The Escape
**Scenario**: You are root inside a container.
*   `uid=0(root)`.
**Reality**: You are (usually) faked root. You can't touch the Host OS.
**Breakout**: If `--privileged` is on, you can mount the host disk.
`mount /dev/sda1 /mnt` -> Now you own the host.

---

## 4. Reflection Check

1.  **Ephemeral**: Containers live for minutes. How do you do forensics? (You don't. You need logs shipped out instantly).
2.  **Secrets**: Where do you put database passwords? (Environment Variables or Secrets Manager. NEVER in the Dockerfile).
3.  **Surface**: Distroless images. (Remove shells/tools from the image. If ability to run `bash` is missing, the attacker has a harder time).

---

## 5. Completion Criteria

This module is complete when:
1.  You scan your Dockerfiles.
2.  You avoid `--privileged` like the plague.
3.  You understand that **Containers are not VMs**.
