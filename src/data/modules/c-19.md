# Rule-Based vs Behavioral Detection

## 1. What this module covers
Two different philosophic approaches to catching badness. "Known Bad" vs "Deviation from Good".

## 2. Why this matters for purple teams
Attacks bypass rules easily. Behaviors are harder to bypass. You need a mix of both.

## 3. Core concepts explained clearly

### Rule-Based (Signature)
*   **Logic**: "If A then Alert."
*   **Example**: "If IP is in Blacklist, Alert."
*   **Pros**: Low False Positives. Fast.
*   **Cons**: Misses new/unknown attacks (Zero Days).

### Behavioral (Anomaly/Heuristic)
*   **Logic**: "If X differs from Baseline by 2 Standard Deviations, Alert."
*   **Example**: "User uploads 5GB. User usually uploads 5MB."
*   **Pros**: Catches unknown attacks.
*   **Cons**: High False Positives (User might just be backing up photos).

## 4. Validation examples

### Evasion Test
*   **Rule**: Detects `nc.exe` (Netcat).
*   **Red**: Rename `nc.exe` to `spotify.exe`. -> Rule Bypassed.
*   **Behavior**: Detect "Process opening network connection to irregular port".
*   **Red**: Runs `spotify.exe` connecting to port 4444. -> Behavior method catches it (because Spotify uses 443, not 4444).

## 5. Common gaps and failures
*   **Over-reliance on ML**: "Our AI will catch it." AI needs training. If you don't train it on what "Bad" looks like, it finds nothing.
*   **Static Baselines**: "Normal is 50MB/day". A new project starts, everyone uploads 1GB. Alerts explode.

## 6. Key takeaways
*   **Layering**: Use Rules for the known (Commodity Malware). Use Behavior for the unknown (APT/Insider).
