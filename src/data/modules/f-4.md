# Installing Kali Linux Safely

## 1. Orientation

### What this module covers
This module guides you through the secure installation and configuration of Kali Linux as your primary attack platform. Beyond the mechanical steps of installation, you will understand security considerations for running an offensive security distribution, verification practices to ensure image integrity, and configuration decisions that affect your lab's security posture.

### Fit in the Learning Path
With your hypervisor ready, you now build your attack platform. Kali Linux is the industry-standard distribution for penetration testing and security research. Understanding its architecture and proper setup is essential—Kali configured incorrectly can expose you to risks or create bad habits that carry into professional work.

### Learning Objectives
By the end of this module, you will:
*   Securely download and cryptographically verify the Kali Linux image
*   Configure a VM with appropriate resources and security settings
*   Understand Kali's design philosophy and why it exists
*   Apply post-installation security hardening

---

## 2. Core Content

### Mental Model: Your Weapon, Your Responsibility

**How professionals think about this:**
Kali Linux is not a toy—it's a collection of tools that can cause real damage. It's pre-configured to make offensive security work efficient, which means some convenience features reduce security. You must understand these trade-offs and configure appropriately.

**The Kali philosophy:**
- Built for penetration testing, not daily use
- Tools included because they're useful for offense, not because they're safe
- Assumes you know what you're doing
- Default configuration prioritizes functionality over security

### What is Kali Linux?

**Technical foundation:**
- Debian-based Linux distribution
- Maintained by OffSec (creators of OSCP certification)
- Rolling release model (continuous updates)
- Over 600 pre-installed security tools

**What's included:**
| Category | Example Tools |
|----------|---------------|
| Information Gathering | Nmap, Maltego, Recon-ng |
| Vulnerability Analysis | Nessus, OpenVAS, Nikto |
| Web Application Testing | Burp Suite, OWASP ZAP, SQLmap |
| Password Attacks | John the Ripper, Hashcat, Hydra |
| Wireless Attacks | Aircrack-ng, Wifite, Kismet |
| Exploitation | Metasploit Framework, Exploit-DB |
| Post-Exploitation | Empire, Mimikatz, Bloodhound |
| Forensics | Autopsy, Volatility, Binwalk |

**Kernel modifications:**
- Wireless packet injection patches
- Additional drivers for security hardware
- Headers available for custom module compilation

### Secure Download and Verification

**Why verification matters:**
A compromised Kali image could:
- Include backdoors in security tools
- Log your credentials as you type them
- Phone home with information about your targets
- Make you complicit in attacking others

**If you download Kali from the wrong source, you become the victim.**

#### Step-by-Step Verification

**1. Download from official source ONLY:**
- Official URL: `https://www.kali.org/get-kali/`
- Verify the SSL certificate (green padlock, correct domain)
- Never download from mirrors you don't control

**2. Download the SHA256 checksum file:**
```
kali-linux-2024.1-installer-amd64.iso
kali-linux-2024.1-installer-amd64.iso.sha256sum
```

**3. Verify the checksum:**

*Windows (PowerShell):*
```powershell
Get-FileHash kali-linux-2024.1-installer-amd64.iso -Algorithm SHA256
# Compare output with contents of .sha256sum file
```

*Linux/macOS:*
```bash
sha256sum -c kali-linux-2024.1-installer-amd64.iso.sha256sum
# Should output: kali-linux-2024.1-installer-amd64.iso: OK
```

**4. (Advanced) Verify GPG signature:**
```bash
# Import Kali's public key
wget https://archive.kali.org/archive-key.asc
gpg --import archive-key.asc

# Verify the signed checksum file
gpg --verify SHA256SUMS.gpg SHA256SUMS
```

### VM Configuration: Security-Conscious Choices

#### Resource Allocation

| Resource | Minimum | Recommended | Notes |
|----------|---------|-------------|-------|
| RAM | 2GB | 4-8GB | Memory-intensive tools like Burp, Hashcat |
| CPU Cores | 1 | 2-4 | Parallelized attacks benefit from more cores |
| Storage | 20GB | 50-80GB | Tools, wordlists, captured data |
| GPU Passthrough | Optional | Optional | For GPU-accelerated password cracking |

**Tip:** Allocate half your total RAM and half your CPU cores maximum. You still need resources for the host.

#### Network Configuration Options

| Mode | Description | When to Use |
|------|-------------|-------------|
| **NAT** | VM shares host's IP, outbound only | Default safe choice |
| **Host-Only** | Isolated network with host | Lab networks, no internet |
| **Bridged** | VM gets own IP on physical network | When you need direct network access |
| **Internal** | VMs talk to each other only | Attack simulations between VMs |

**Security implications:**
- **NAT:** Safest. VM can reach internet, nothing can reach VM
- **Bridged:** ⚠️ VM is exposed to your network. Other devices can reach it
- **Host-Only:** Safe for labs, but VM has no internet access

**For learning, start with NAT. Use Host-Only/Internal for attack labs.**

#### Security Hardening the VM

**Before installation:**
- [ ] Disable shared folders (or limit to non-sensitive directories)
- [ ] Disable bidirectional clipboard (for malware work)
- [ ] Disable drag-and-drop
- [ ] Set network to NAT initially

**VirtualBox security settings:**
```
Settings → General → Advanced:
  Shared Clipboard: Disabled
  Drag'n'Drop: Disabled

Settings → Shared Folders:
  Remove any shared folders

Settings → Network:
  Attached to: NAT (or Host-only for isolated labs)
```

### Installation Walkthrough

**Step 1: Create the VM**
1. Open VirtualBox → New
2. Name: "Kali-2024" (or current version)
3. Type: Linux, Version: Debian (64-bit)
4. Memory: 4096 MB
5. Hard disk: Create new → VDI → Dynamically allocated → 50GB

**Step 2: Attach and boot ISO**
1. Settings → Storage → Empty CD → Choose disk file
2. Select your verified Kali ISO
3. Start the VM

**Step 3: Installation choices**

| Prompt | Recommendation | Why |
|--------|----------------|-----|
| Installation type | Graphical Install | Easier to follow |
| Language/Location | Your preference | — |
| Hostname | "kali" or custom | Avoid identifiable hostnames for anonymity |
| Domain name | Leave blank | — |
| User account | Create non-root user | Default behavior in modern Kali |
| Partitioning | Guided - use entire disk | Simple, safe (only affects virtual disk) |
| Software selection | Keep defaults | Add more later as needed |

**Step 4: Post-installation**
1. Log in with your created username/password
2. Install VirtualBox Guest Additions for better performance:
   ```bash
   sudo apt update
   sudo apt install -y virtualbox-guest-x11
   ```
3. Take a **snapshot** named "Clean Install"

### Kali User Model Change

**Historical context:**
- Pre-2020: Kali ran as root by default
- Post-2020: Kali runs as non-root user `kali`

**Why the change:**
1. Running browsers/applications as root is dangerous
2. Some tools break when run as root
3. Teaches better operational security habits
4. Aligns with principle of least privilege

**When you need root:**
```bash
sudo <command>        # Single command as root
sudo -i               # Interactive root shell
```

### First Steps After Installation

**1. Update the system:**
```bash
sudo apt update && sudo apt full-upgrade -y
```

**2. Create a snapshot:**
This is your "known good state." Before any experiment, you can revert.

**3. Verify tools work:**
```bash
nmap --version
msfconsole --version
burpsuite &
```

**4. Set your timezone:**
```bash
sudo timedatectl set-timezone Asia/Kolkata  # Or your timezone
```

**5. Configure SSH (if needed):**
```bash
sudo systemctl enable ssh
sudo systemctl start ssh
# Change default SSH keys first!
sudo rm /etc/ssh/ssh_host_*
sudo dpkg-reconfigure openssh-server
```

---

## 3. Guided Practice

### Exercise 1: Image Verification

Download the Kali ISO and verify its integrity:

1. Record the SHA256 hash from the official website: _______________
2. Calculate the hash of your downloaded file: _______________
3. Do they match? ___
4. What would you do if they didn't match? _______________

### Exercise 2: Security Configuration Audit

After installing Kali, audit your VM settings:

| Setting | Current Value | Secure? | Action Needed |
|---------|---------------|---------|---------------|
| Shared Clipboard | ___ | ___ | ___ |
| Shared Folders | ___ | ___ | ___ |
| Network Mode | ___ | ___ | ___ |
| Guest Additions | ___ | ___ | ___ |

### Exercise 3: Snapshot Strategy

Plan your snapshot strategy:

| Snapshot Name | Purpose | When to Create |
|---------------|---------|----------------|
| ___ | Clean install baseline | After initial setup |
| ___ | ___ | After installing additional tools |
| ___ | ___ | Before each engagement/experiment |

---

## 4. Reflection Check

### Security Thinking
1. You download Kali from a "fast mirror" that isn't on the official list. The checksum matches. Is it safe? Why or why not?

2. Why might someone want to run Kali as a "daily driver" (main OS), and why is this generally discouraged?

3. You're about to analyze malware in Kali. What VM settings would you change from your normal configuration?

### Operational Thinking
1. Your Kali VM's disk is full. What's the safest way to expand it?

2. You've been using Kali for months and have customized many tools. You need to update to a new version. What's your strategy?

3. You're doing a penetration test for a client. They ask what OS you're using. How much detail should you share?

---

## 5. Key Misconceptions

**MYTH: "Kali is a hacking OS that makes you a hacker"**
REALITY: Kali is a tool collection. The skills make you effective, not the OS.

**MYTH: "Running as root is fine in a VM"**
REALITY: Bad habits transfer. Learn to use sudo properly. Some tools also break as root.

**MYTH: "I can use Kali as my main OS"**
REALITY: Kali is designed for penetration testing, not daily use. Security updates focus on tools, not desktop applications.

**MYTH: "If the download works, the ISO is fine"**
REALITY: A corrupted or malicious ISO can "work" while containing backdoors. Always verify checksums.

**MYTH: "Bridged networking is fine for my lab"**
REALITY: Bridged exposes your Kali VM to your network. Use NAT or Host-Only unless you specifically need bridged.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Download and verify** a Kali Linux ISO using cryptographic checksums
2. **Configure** a VM with appropriate security settings
3. **Install** Kali Linux successfully
4. **Create** a post-installation snapshot for recovery
5. **Explain** why verification and secure configuration matter

---

## 7. Further Depth (Optional)

*   **Reading:** Kali Linux Documentation - https://www.kali.org/docs/
*   **Exploration:** Compare Kali's tool list with what's available in Parrot OS
*   **Advanced:** Build a custom Kali ISO with only the tools you need (live-build)
*   **Research:** Review Kali's package signing process and how APT verifies updates
