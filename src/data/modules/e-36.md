# Service Enumeration and Banner Grabbing

## 1. Unit Brief: Interrogating the Service
Once you find an open port (e.g., 22), you need to know what application is listening. Is it OpenSSH? Is it Dropbear? Is it an SSH tarpit? Enumeration is the process of extracting this metadata.

## 2. Real-World Relevance
*   **Exploit**: `OpenSSH 7.2` has a user enumeration bug. `OpenSSH 7.3` patched it.
*   **You**: If you don't know the version, you don't know if the exploit will work. Firing exploits blindly crashes services.

## 3. Core Concepts

### Banner Grabbing
Connecting and listening to the default welcome message.
*   **Protocol**: Many protocols (FTP, SSH, SMTP) send a text banner immediately upon connection.
*   **HTTP**: The `Server` header implies the version.

### NSE (Nmap Scripting Engine)
Lua scripts that automate enumeration.
*   `ssh-hostkey`: Grabs the RSA key.
*   `http-title`: Grabs the HTML `<title>`.
*   `smb-os-discovery`: Asks Windows for its exact OS version and Domain name.

## 4. Practical Examples

### Netcat Banner Grab
```bash
$ nc -vn 192.168.1.10 21
(UNKNOWN) [192.168.1.10] 21 (ftp) open
220 (vsFTPd 3.0.3)
```
*   **Intel**: `vsFTPd 3.0.3`. Check exploits for this version.

### Nmap Version Scan
```bash
$ nmap -sV -p 80 target.com
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
```
*   **Intel**: Apache 2.4.41 running on Ubuntu.

## 5. Common Mistakes Beginners Make
*   **Misinterpreting "filtered"**: It implies a firewall rule, not that the service is down. The service might be accessible from a specific IP (Whitelist).
*   **Obfuscated Banners**: Admins can change "Apache" to "Go Away". Don't trust text banners 100%.

## 6. Key Takeaways
*   **Precision**: Specific versions allow specific exploits.
*   **Scripts**: Use NSE (`-sC`) to automate the heavy lifting.
