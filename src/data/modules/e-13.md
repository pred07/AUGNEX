# How Web Applications Are Built

## 1. Orientation

### What this module covers
This module deconstructs modern web application architecture—from frontend presentation through backend logic to database storage. Understanding this architecture is essential for effective web application security testing; you must know where to inject, what processes data, and how trust flows.

### Fit in the Learning Path
Web applications are the most common attack surface. Before testing for SQL injection, XSS, or authentication bypass, you need a mental model of how applications actually work. This module provides that foundation.

### Learning Objectives
By the end of this module, you will:
*   Understand the three-tier web application architecture
*   Recognize where different vulnerability classes occur
*   Map data flow from user input to database and back
*   Identify trust boundaries between tiers

---

## 2. Core Content

### Mental Model: The Request-Response Cycle

**How professionals think about this:**
Every web interaction follows the same pattern: user input → client processing → network transit → server processing → database query → server response → client rendering. Security vulnerabilities exist at every transition point.

```
WEB APPLICATION DATA FLOW:

┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│   USER                                                              │
│     │                                                               │
│     │ Clicks button, enters data                                    │
│     ▼                                                               │
│   ┌─────────────────────────────────────────────────────────────┐   │
│   │  FRONTEND (Client-Side)                                     │   │
│   │  ─────────────────────                                      │   │
│   │  Browser: Chrome, Firefox                                   │   │
│   │  Languages: HTML, CSS, JavaScript                           │   │
│   │  Frameworks: React, Vue, Angular                            │   │
│   │                                                             │   │
│   │  Processing:                                                │   │
│   │  - Renders UI                                               │   │
│   │  - Validates input (CLIENT-SIDE)                            │   │
│   │  - Sends HTTP requests                                      │   │
│   │  - Executes JavaScript                                      │   │
│   │                                                             │   │
│   │  TRUST: NONE - User controls this completely                │   │
│   │  ATTACKS: XSS, DOM manipulation, client-side bypass         │   │
│   └────────────────────────────┬────────────────────────────────┘   │
│                                │                                    │
│                    HTTP Request (JSON/Form)                         │
│                                │                                    │
│   ┌────────────────────────────┼────────────────────────────────┐   │
│   │                            ▼                                │   │
│   │  BACKEND (Server-Side)                                      │   │
│   │  ─────────────────────                                      │   │
│   │  Server: Apache, Nginx, IIS                                 │   │
│   │  Languages: Python, PHP, Java, Node.js, C#                  │   │
│   │  Frameworks: Django, Laravel, Spring, Express               │   │
│   │                                                             │   │
│   │  Processing:                                                │   │
│   │  - Receives HTTP request                                    │   │
│   │  - Authenticates user                                       │   │
│   │  - Authorizes action                                        │   │
│   │  - Validates input (SERVER-SIDE)                            │   │
│   │  - Executes business logic                                  │   │
│   │  - Queries database                                         │   │
│   │                                                             │   │
│   │  TRUST: HIGH - Controlled by developer                      │   │
│   │  ATTACKS: RCE, auth bypass, SSRF, logic flaws               │   │
│   └────────────────────────────┬────────────────────────────────┘   │
│                                │                                    │
│                        SQL/NoSQL Query                              │
│                                │                                    │
│   ┌────────────────────────────┼────────────────────────────────┐   │
│   │                            ▼                                │   │
│   │  DATABASE (Data Tier)                                       │   │
│   │  ─────────────────                                          │   │
│   │  SQL: MySQL, PostgreSQL, MSSQL, Oracle                      │   │
│   │  NoSQL: MongoDB, Redis, Elasticsearch                       │   │
│   │                                                             │   │
│   │  Processing:                                                │   │
│   │  - Stores data persistently                                 │   │
│   │  - Executes queries                                         │   │
│   │  - Returns results                                          │   │
│   │                                                             │   │
│   │  TRUST: HIGHEST - Should never be directly exposed          │   │
│   │  ATTACKS: SQL injection, NoSQL injection                    │   │
│   └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### The Three-Tier Architecture

**Tier 1: Presentation (Frontend)**

```
FRONTEND TECHNOLOGIES:

Structure: HTML
├── Forms, inputs, buttons
├── Data display
└── Page layout

Styling: CSS
├── Visual appearance
├── Responsive design
└── Animations

Logic: JavaScript
├── User interaction
├── AJAX requests
├── DOM manipulation
└── Client-side validation

Frameworks:
├── React (Facebook)
├── Vue.js
├── Angular (Google)
└── jQuery (legacy)
```

**Security implications:**
- User controls the client completely
- Client-side validation is for UX, not security
- JavaScript can be modified, bypassed, read
- XSS allows attacker code to run in user's browser

**Tier 2: Application Logic (Backend)**

```
BACKEND TECHNOLOGIES:

Languages:
├── Python (Django, Flask)
├── PHP (Laravel, WordPress)
├── JavaScript (Node.js, Express)
├── Java (Spring Boot)
├── C# (.NET)
└── Ruby (Rails)

Responsibilities:
├── Authentication - Who are you?
├── Authorization - What can you do?
├── Input validation - Is this data safe?
├── Business logic - What happens when you buy?
├── Session management - Keeping you logged in
└── Database interaction - Storing and retrieving data
```

**Security implications:**
- This is where security enforcement MUST happen
- Input validation only counts if done server-side
- Authentication/authorization vulnerabilities are critical
- Business logic flaws (free items, role bypass)

**Tier 3: Data (Database)**

```
DATABASE TECHNOLOGIES:

SQL (Relational):
├── MySQL
├── PostgreSQL
├── Microsoft SQL Server
├── Oracle
└── SQLite

NoSQL (Document/Key-Value):
├── MongoDB
├── Redis
├── Elasticsearch
├── Cassandra
└── DynamoDB

Data Types:
├── User accounts
├── Application data
├── Session information
├── Logs and analytics
└── Configuration
```

**Security implications:**
- Never exposed to internet directly
- SQL injection = database compromise
- Sensitive data (passwords, PII) stored here
- Encryption at rest is essential

### APIs: The Modern Glue

**API architecture:**

```
TRADITIONAL VS MODERN:

TRADITIONAL (Server-rendered):
┌────────────┐      HTML page       ┌────────────┐
│   BROWSER  │◄─────────────────────│   SERVER   │
│            │─────────────────────►│            │
└────────────┘      Form POST       └────────────┘

Each page load returns complete HTML.


MODERN (SPA + API):
┌────────────┐      JSON data       ┌────────────┐
│   BROWSER  │◄─────────────────────│  API       │
│  (React)   │─────────────────────►│  SERVER    │
└────────────┘      JSON request    └────────────┘
      │
Initial HTML/JS load (once)
      │
Then: AJAX calls for data only
```

**API types:**

| Type | Format | Example |
|------|--------|---------|
| **REST** | JSON over HTTP | GET /api/users/123 |
| **GraphQL** | Query language | POST /graphql with query |
| **SOAP** | XML | POST /service with XML envelope |
| **gRPC** | Binary | High-performance internal |

### Trust Boundaries

**Where security must be enforced:**

```
TRUST BOUNDARY MAP:

UNTRUSTED ─────────────────────────────────────────────────► TRUSTED

  USER          FRONTEND         BACKEND         DATABASE
    │               │                │               │
    │   BOUNDARY 1  │   BOUNDARY 2   │   BOUNDARY 3  │
    │      ▼        │       ▼        │       ▼       │
    │   User can    │   Backend      │   DB trusts   │
    │   modify      │   MUST         │   queries     │
    │   anything    │   validate     │   completely  │
    │               │   everything   │               │
    │               │                │               │

ATTACK PATTERNS:
1. Modify frontend → Backend doesn't validate → Exploit
2. Inject via input → Backend concatenates → SQLi/RCE
3. Bypass client checks → Server has no checks → Logic flaw
```

### Common Vulnerability Locations

**By architectural tier:**

| Tier | Vulnerability | Example |
|------|---------------|---------|
| **Frontend** | XSS (Reflected/DOM) | Inject script via search |
| **Frontend** | Sensitive data in JS | API keys in source |
| **Frontend** | Client-side auth bypass | Modify JS to skip check |
| **Backend** | Authentication bypass | Token forgery |
| **Backend** | Authorization failure | IDOR, privilege escalation |
| **Backend** | Injection | SQLi, command injection |
| **Backend** | SSRF | Request internal resources |
| **Backend** | Business logic | Free items, double spending |
| **Database** | SQL Injection | Extract all data |
| **Database** | NoSQL Injection | Query manipulation |

### SPA Security Considerations

**Single Page Applications:**

```
SPA SECURITY ISSUES:

1. CLIENT-SIDE ROUTING
   ─────────────────────
   Routes handled in browser
   Backend may not validate access
   
   Attack: Access /admin in browser, backend serves data

2. OVERSHARING DATA
   ─────────────────────
   API returns all fields
   Frontend hides some with CSS
   
   Attack: View network tab, see hidden fields

3. TOKEN STORAGE
   ─────────────────────
   JWT stored in localStorage
   Accessible to any JavaScript
   
   Attack: XSS steals token

4. LOGIC IN CLIENT
   ─────────────────────
   Price calculation in JavaScript
   Discount logic in client
   
   Attack: Modify client-side logic
```

---

## 3. Guided Practice

### Exercise 1: Architecture Mapping

For an online shopping site, identify:

| Component | Technology (guess) | Data Handled |
|-----------|-------------------|--------------|
| Frontend | ___ | ___ |
| Backend | ___ | ___ |
| Database | ___ | ___ |
| API | ___ | ___ |

### Exercise 2: Attack Surface Mapping

For user registration flow:
1. User enters username, email, password
2. Frontend validates format
3. Backend checks uniqueness
4. Backend hashes password
5. Database stores user

Identify vulnerabilities at each step:

| Step | Potential Vulnerability |
|------|------------------------|
| 1 | ___ |
| 2 | ___ (hint: can be bypassed) |
| 3 | ___ |
| 4 | ___ |
| 5 | ___ |

### Exercise 3: Trust Boundaries

For this request, identify trust boundary violations:

```
POST /api/cart
{
    "item": "Laptop",
    "price": 0.01,
    "quantity": 100
}
```

What should the backend verify? ___

---

## 4. Reflection Check

### Architecture Understanding
1. The frontend validates that email format is correct. Why is this NOT security?

2. A SPA returns all user data to the client but uses CSS display:none to hide admin fields. What's wrong?

3. Why should the database never be directly accessible from the internet?

### Security Thinking
1. You're testing an API. The documentation says "requires authentication." Where do you test first?

2. A developer says "we sanitize input on the frontend." Why is this concerning?

3. Price is calculated client-side in JavaScript. What's your attack approach?

---

## 5. Key Misconceptions

**MYTH: "Frontend validation is security"**
REALITY: Frontend validation is UX. Security requires server-side validation.

**MYTH: "SPAs are more secure because they use APIs"**
REALITY: APIs have the same vulnerabilities as traditional web apps, sometimes worse due to oversharing.

**MYTH: "If users can't see it in the UI, they can't access it"**
REALITY: Users can call APIs directly, modify JavaScript, and access anything not server-protected.

**MYTH: "We use a framework, so we're secure"**
REALITY: Frameworks provide tools, not guarantees. Misuse still creates vulnerabilities.

**MYTH: "HTTPS means the application is secure"**
REALITY: HTTPS protects data in transit. It does nothing for application vulnerabilities.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Diagram** the three-tier web architecture
2. **Identify** which tier handles which security responsibility
3. **Map** common vulnerabilities to their architectural location
4. **Recognize** trust boundaries and where validation must occur
5. **Explain** why client-side security is insufficient

---

## 7. Further Depth (Optional)

*   **Practice:** Map the architecture of a real web application you use
*   **Tool:** Use browser DevTools to observe API traffic
*   **Research:** Study how popular frameworks handle security (Django, Rails)
*   **Reading:** OWASP Application Security Verification Standard (ASVS)
