# Understanding Kill Chains End-to-End

## 1. Orientation

### What this module covers
This module teaches you to view attacks as narratives—connected sequences of actions with a beginning, middle, and end. Understanding kill chains transforms isolated alerts into coherent attack stories and reveals intervention opportunities.

### Fit in the Learning Path
Individual alerts are meaningless without context. Kill chain thinking connects the dots, showing how attackers progress from initial access to objective completion. Breaking any link stops the attack.

### Learning Objectives
By the end of this module, you will:
*   Reconstruct attack narratives from log data
*   Identify choke points for defensive focus
*   Apply kill chain models (Cyber Kill Chain, ATT&CK)
*   Correlate events across attack stages

---

## 2. Core Content

### Mental Model: The Attack as a Story

**How professionals think about this:**
Every successful attack is a story with chapters. The attacker writes the plot; defenders must read between the lines. Missing one chapter doesn't mean the story stops—it means you lose the plot.

```
KILL CHAIN NARRATIVE:

┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  CHAPTER 1: ENTRY                                                  │
│  "The attacker finds a way in"                                     │
│  ─────────────────────────────                                     │
│  Phishing email → User clicks → Macro executes                     │
│                                                                     │
│  CHAPTER 2: ESTABLISHMENT                                          │
│  "The attacker sets up camp"                                       │
│  ─────────────────────────────                                     │
│  Payload downloads → C2 beacon → Persistence installed             │
│                                                                     │
│  CHAPTER 3: ESCALATION                                             │
│  "The attacker gains power"                                        │
│  ─────────────────────────────                                     │
│  Credential theft → Privilege escalation → Admin access            │
│                                                                     │
│  CHAPTER 4: EXPANSION                                              │
│  "The attacker spreads through the network"                        │
│  ─────────────────────────────                                     │
│  Recon → Lateral movement → Multiple systems compromised           │
│                                                                     │
│  CHAPTER 5: OBJECTIVE                                              │
│  "The attacker achieves their goal"                                │
│  ─────────────────────────────                                     │
│  Data identified → Data collected → Data exfiltrated               │
│                                                                     │
│  EPILOGUE: (If caught)                                             │
│  Investigation → Attribution → Improvement                         │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### Kill Chain Models

**Frameworks for understanding attack stages:**

```
LOCKHEED MARTIN CYBER KILL CHAIN:

1. RECONNAISSANCE
   └── Research target, gather intelligence

2. WEAPONIZATION
   └── Create malicious payload

3. DELIVERY
   └── Send weapon to target (email, web, USB)

4. EXPLOITATION
   └── Trigger vulnerability/weakness

5. INSTALLATION
   └── Install persistent access

6. COMMAND & CONTROL
   └── Establish communication channel

7. ACTIONS ON OBJECTIVES
   └── Achieve attacker's goal

──────────────────────────────────────────────────

MITRE ATT&CK TACTICS (More granular):

1.  Reconnaissance       →  Research target
2.  Resource Development →  Build attack infrastructure
3.  Initial Access       →  Get into network
4.  Execution           →  Run malicious code
5.  Persistence         →  Maintain access
6.  Privilege Escalation →  Gain higher access
7.  Defense Evasion     →  Avoid detection
8.  Credential Access   →  Steal credentials
9.  Discovery           →  Learn the environment
10. Lateral Movement    →  Spread through network
11. Collection          →  Gather target data
12. Command & Control   →  Maintain communication
13. Exfiltration        →  Steal data
14. Impact              →  Damage/destroy
```

### Choke Points

**Where attacks must pass through:**

```
CHOKE POINT CONCEPT:

                     Attacker's Path
                          │
                          ▼
         ┌────────────────────────────────┐
         │          NETWORK EDGE          │ ◄── Choke Point 1
         │ (All external traffic enters)  │
         └───────────────┬────────────────┘
                         │
                         ▼
         ┌────────────────────────────────┐
         │        ENDPOINT/USER           │
         │ (Where humans interact)        │
         └───────────────┬────────────────┘
                         │
                         ▼
         ┌────────────────────────────────┐
         │    PRIVILEGE BOUNDARY          │ ◄── Choke Point 2
         │ (User → Admin transition)      │
         └───────────────┬────────────────┘
                         │
                         ▼
         ┌────────────────────────────────┐
         │    LATERAL MOVEMENT PATH       │ ◄── Choke Point 3
         │ (Between network segments)     │
         └───────────────┬────────────────┘
                         │
                         ▼
         ┌────────────────────────────────┐
         │    DATA EGRESS POINT           │ ◄── Choke Point 4
         │ (All data leaving network)     │
         └────────────────────────────────┘

CHOKE POINTS = High-value monitoring locations
Most attacks MUST pass through these points
Focus detection resources here
```

### Key Choke Points to Monitor

| Choke Point | Why Critical | What to Monitor |
|-------------|--------------|-----------------|
| **Email gateway** | #1 entry vector | Attachments, links, sender reputation |
| **Endpoint execution** | Where payloads run | Process creation, script execution |
| **Authentication** | Credential use | Login attempts, unusual access |
| **Admin boundaries** | Privilege escalation | Elevation events, admin tool use |
| **Network segments** | Lateral movement | Cross-segment traffic, RDP/SMB |
| **Data stores** | Objective targets | Database access, file operations |
| **Egress points** | Exfiltration path | Unusual outbound, large transfers |

### Attack Reconstruction

**Building the narrative from logs:**

```
RECONSTRUCTION METHODOLOGY:

1. ANCHOR EVENT
   ─────────────────────────────
   Start with what you know
   Example: "EDR alert on credential dumping at 14:30"
   
2. WORK BACKWARDS
   ─────────────────────────────
   How did they get to this point?
   
   14:30: Credential dump on WORKSTATION-42
   ↑
   14:15: PowerShell download from suspicious URL
   ↑
   14:10: Outlook spawned PowerShell (unusual!)
   ↑
   14:05: Phishing email received
   ↑
   Campaign targeting industry started last week

3. WORK FORWARDS
   ─────────────────────────────
   Where did they go next?
   
   14:30: Credential dump
   ↓
   14:45: Credentials used to access SERVER-01
   ↓
   15:00: Large file access on FILE-SERVER
   ↓
   15:30: Unusual DNS queries (data exfil?)
   
4. MAP TO KILL CHAIN
   ─────────────────────────────
   Phishing         → Initial Access
   PowerShell       → Execution
   Credential dump  → Credential Access
   Server access    → Lateral Movement
   File access      → Collection
   DNS queries      → Exfiltration

5. IDENTIFY BREAKS
   ─────────────────────────────
   Where could we have stopped it?
   Every stage is an intervention opportunity
```

### Breaking the Chain

**Every link is an opportunity:**

```
INTERVENTION OPPORTUNITIES:

STAGE                          DEFENSIVE OPPORTUNITY
─────────────────────────────  ─────────────────────────────

Phishing email                 Email filtering, user awareness
       │
       ▼ ─── BREAK HERE ───    Block malicious attachment
       
Macro execution                Office macro controls
       │
       ▼ ─── BREAK HERE ───    Disable macros for internet files
       
C2 communication               Network monitoring, DNS filtering
       │
       ▼ ─── BREAK HERE ───    Block known-bad domains
       
Credential theft               Credential Guard, EDR
       │
       ▼ ─── BREAK HERE ───    Protect LSASS, detect dumping
       
Lateral movement               Network segmentation, MFA
       │
       ▼ ─── BREAK HERE ───    Require MFA for sensitive systems
       
Data exfiltration              DLP, egress monitoring
       │
       ▼ ─── BREAK HERE ───    Detect large outbound transfers

ANY BREAK STOPS THE ATTACK
Earlier breaks = Less damage
Later breaks = More cleanup required
```

### Dwell Time Analysis

**Time is the critical variable:**

```
DWELL TIME CONCEPT:

                    TIME →
   │                                            │
   │ Attacker      ▲                            │ Objective
   │ Enters        │                            │ Achieved
   │               │                            │
   ▼───────────────┴────────────────────────────▼
         DWELL TIME (days to months)
   
   │←───────────── Opportunity Window ──────────→│
   
   The longer dwell time, the more:
   - Persistence mechanisms
   - Credentials stolen
   - Systems compromised
   - Data accessed
   - Damage potential

INDUSTRY STATISTICS:
Average dwell time: 197 days (improving)
Ideal dwell time: <24 hours (detection + response)

REDUCING DWELL TIME:
1. Better detection (catch earlier)
2. Faster triage (investigate faster)
3. Automated response (contain immediately)
4. Active hunting (don't wait for alerts)
```

---

## 3. Guided Practice

### Exercise 1: Attack Reconstruction

Given these logs, reconstruct the kill chain:

```
09:15 - alice@corp.com received email from "hr-updates@cornp.com"
09:17 - alice opened "salary_review.docm"
09:17 - WINWORD.EXE spawned POWERSHELL.EXE
09:18 - PowerShell connected to 185.123.xxx.xxx:443
09:20 - PowerShell executed "Get-ADGroupMember 'Domain Admins'"
09:25 - New scheduled task created: "WindowsUpdate"
```

Map to kill chain stages:
1. ___
2. ___
3. ___
4. ___
5. ___

### Exercise 2: Choke Point Identification

For your network, identify the critical choke points:

| Choke Point | Systems/Locations | Current Monitoring |
|-------------|-------------------|-------------------|
| Email entry | ___ | ___ |
| Privileged access | ___ | ___ |
| Data egress | ___ | ___ |

### Exercise 3: Break Point Analysis

For the attack in Exercise 1, list where you could have broken the chain:

| Stage | Break Point | Control |
|-------|-------------|---------|
| 1. | ___ | ___ |
| 2. | ___ | ___ |
| 3. | ___ | ___ |

---

## 4. Reflection Check

### Chain Understanding
1. Detected credential dumping but nothing else. Investigation over?

2. Blocked malware download. Why still investigate the phishing email?

3. Attack stopped at lateral movement. Damage assessment?

### Strategic Thinking
1. Can only improve monitoring at one stage. Which one?

2. Mean dwell time is 30 days. What does this indicate?

3. All individual alerts make sense. Attack narrative doesn't. Problem?

---

## 5. Key Misconceptions

**MYTH: "Stopping the payload means the attack is over"**
REALITY: They may have alternative payloads, or already moved on.

**MYTH: "Early detection is always better"**
REALITY: Any detection before objective is valuable. Late detection still prevents data loss.

**MYTH: "Kill chain is linear"**
REALITY: Attackers loop back, try alternatives, skip stages. It's a model, not a script.

**MYTH: "We need to monitor every stage equally"**
REALITY: Focus on choke points. Not all stages are equally monitorable.

**MYTH: "Fast attackers can't be stopped"**
REALITY: Automation can respond faster than humans. Detection + automation beats speed.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Reconstruct** attack narratives from logs
2. **Identify** critical choke points
3. **Map** activities to kill chain stages
4. **Find** intervention opportunities
5. **Calculate** dwell time implications

---

## 7. Further Depth (Optional)

*   **Framework:** Study MITRE ATT&CK tactics in depth
*   **Practice:** Reconstruct attacks from CTF or lab scenarios
*   **Tool:** Use timeline analysis tools (Plaso, Log2Timeline)
*   **Reading:** Mandiant M-Trends for real-world attack patterns
