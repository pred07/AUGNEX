# Network Protocol Weaknesses

## 1. Unit Brief: Broken by Design
Some protocols were designed in the 1980s when the internet was trusted. They have no security built-in. Attacking them relies on abusing their inherent trust nature, not code exploits.

## 2. Real-World Relevance
*   **LLMNR/NBT-NS**: Why type `printer.company.local` when you can just type `printer`? Windows creates a broadcast asking "Who is printer?". The attacker shouts "I AM PRINTER!" and the victim sends their password hash to authenticate.

## 3. Core Concepts

### ARP Spoofing (Man in the Middle)
*   Protocol: "Who has IP 192.168.1.1 (Gateway)?"
*   Attack: "I allow!" (Attacker flooding network with fake answers).
*   Result: All traffic flows through the attacker.

### DHCP Starvation
*   Attack: Requesting every available IP address from the DHCP server using fake MAC addresses.
*   Result: New users cannot connect to the network. (DoS).

### SNM (Simple Network Management Protocol)
*   **Community Strings**: Like a password. Default is `public`.
*   **Info Leak**: Querying SNMP with `public` can reveal the entire routing table, user list, and process list of a router/server.

## 4. Practical Examples

### Responder (LLMNR Polling)
1.  Run `sudo responder -I eth0`.
2.  Wait perfectly still.
3.  Victim types `\\filserver` (typo) instead of `\\fileserver`.
4.  Responder answers: "I am filserver".
5.  Victim sends NT user hash.
6.  You capture the hash.

### Wireshark Sniffing
If you are on the same Wifi or Hub:
1.  Open Wireshark.
2.  Filter `http.request.method == POST`.
3.  Wait for someone to login to a non-HTTPS site.
4.  Read the password in plain text.

## 5. Common Mistakes Beginners Make
*   **Noise**: ARP Spoofing is incredibly loud. It crashes networks. Don't do it unless authorized and careful.
*   **HTTPS**: Wireshark doesn't work on HTTPS (without the key). Most traffic today is HTTPS.

## 6. Key Takeaways
*   **Broadcasts are bad**: Any protocol that "Simulates" a local LAN (LLMNR, mDNS) is exploitable.
*   **Plain Text is dead**: Use SSH, SFTP, HTTPS.
