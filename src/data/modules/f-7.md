# Snapshots, Rollbacks, and Lab Hygiene

## 1. Orientation

### What this module covers
This module covers the "Save Game" feature of virtualization: Snapshots. It also establishes the rules for keeping your lab clean and functional.

### Fit in the Learning Path
You are about to start breaking things. You *will* destroy your VM environment. Snapshots are your safety net to undo catastrophic mistakes instantly.

### Learning Objectives
By the end of this module, you should understand:
*   How to create and restore a Snapshot.
*   The difference between a Snapshot and a Backup.
*   The golden rule of "Clean Base State".

---

## 2. Core Content

### The Power of Snapshots
A snapshot freezes the state of the VM (Disk + RAM) at a specific moment.
*   **Time Travel**: Restoration takes seconds, regardless of how messed up the current state is.
*   **Tree Structure**: You can have branches. (e.g., "Branch A: Installed Docker", "Branch B: Installed Python").

### The Golden Rule: "Clean Base"
Always keep a snapshot of your VM immediately after installation and updates, but *before* you install any project-specific junk.
*   **Name it**: "Fresh Install - Updated [Date]".
*   **Why**: When a tool breaks your python dependencies, you don't debug it. You revert to "Fresh Install".

### Lab Hygiene
1.  **Don't Hoard**: Delete testing VMs when done.
2.  **Isolate**: Don't login to your personal Gmail inside your malware analysis VM.
3.  **Update**: Run `apt update` on your Base State once a month.

---

## 3. Guided Practice

### Creating Your Safety Net
We will intentionally break your VM and fix it.

**Step 1: Take a Snapshot**
1.  In VirtualBox/VMware, select your running Kali/Parrot VM.
2.  Click **Machine** -> **Take Snapshot**.
3.  **Name**: "Pre-Destruction".
4.  **Description**: "System is working fine."

**Step 2: Destructive Action**
1.  Open a terminal in the VM.
2.  Run this command to delete a critical system directory (Don't worry, it's virtual):
    ```bash
    sudo rm -rf /var/log
    ```
3.  Reboot the VM. Notice if it complains or fails to boot properly.

**Step 3: Rollback**
1.  Power off the VM.
2.  Click the **Snapshots** tab (List icon).
3.  Select "Pre-Destruction".
4.  Click **Restore**.
5.  Boot the VM.
6.  Check `/var/log`. It is back. Magic.

---

## 4. Reflection Check

1.  **Storage Cost**: Does a snapshot double the disk space usage immediately? (Hint: No, it uses "Copy-on-Write").
2.  ** forensics**: If you revert a snapshot, does the "evidence" of your activity disappear?
3.  **Production**: Why do we rarely use snapshots for long-term backups in production servers? (Performance penalty).

---

## 5. Completion Criteria

This module is complete when:
1.  You have created a "Clean Base" snapshot for your Attack VM.
2.  You have successfully restored a snapshot.
3.  You commit to using snapshots before running any simplified "install script" from GitHub.
