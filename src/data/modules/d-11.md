# Authentication and Authorization Logs

## 1. Unit Brief: The Gatekeeper's Diary
Identity is the new perimeter. Analyzing who is logging in provided the highest signal-to-noise ratio for detecting attacks.

## 2. Real-World Relevance
Credential Stuffing, Brute Force, and Golden Ticket attacks all appear in Auth logs.

## 3. Core Concepts

### AuthN vs AuthZ
*   **Authentication (AuthN)**: "I am Admin". (Log: Success/Fail).
*   **Authorization (AuthZ)**: "I want to read Secret.txt". (Log: Allowed/Denied).

### Lateral Movement Signs
*   **Normal**: User logs into their own laptop.
*   **Abnormal**: User logs into the Domain Controller (Interactive Login).
*   **Abnormal**: Service Account logs into a workstation.

## 4. Practical Examples

### Password Spray Detection
You see single failed logins for 500 different users from the SAME IP address in 1 minute.
*   **Event**: Brute force would be 500 fails on 1 user. Spray is 1 fail on 500 users.

### Pass-the-Hash Detection
*   Windows Event 4624 (Logon).
*   **Logon Type 3** (Network).
*   **Key Logic**: NTLM Authentication used instead of Kerberos for a domain admin connection usually indicates PtH tools like Mimikatz/CrackMapExec.

## 5. Common Mistakes Beginners Make
*   **Ignoring Service Accounts**: They are noisy, so people filter them out. But attackers love compromising service accounts to stay hidden.
*   **Logon Types**: Confusing Type 2 (Interactive/Keyboard) with Type 3 (Network). If you see Type 2 for a remote hacker, they are literally sitting at the keyboard (or using VNC/RDP).

## 6. Key Takeaways
*   **Baseline is Vital**: You must know what "Normal" looks like to spot "Abnormal".
*   **Volume**: Auth logs are high volume. You need aggregation.
