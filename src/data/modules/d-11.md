# Authentication and Authorization Logs

## 1. Orientation

### What this module covers
This module focuses on the most critical log type: **Identity**. Who is logging in? Who is becoming Root?

### Fit in the Learning Path
90% of attacks involve compromised credentials. Monitoring `auth.log` or Windows Event `4624` is your best chance to catch them.

### Learning Objectives
By the end of this module, you should understand:
*   **Logon vs Logoff**.
*   **Privilege Escalation** logs (`sudo`, `UAC`).
*   **Golden Ticket** indicators (Kerberos).

---

## 2. Core Content

### The Golden Signal
If an attacker steals a password, they look exactly like a normal user.
*   **Difference**: Behavior. (Logging in at 3am? Logging in from a new country? accessing 50 servers in 1 minute?).

### Critical Events
1.  **Successful Logon**: "The door opened."
2.  **Failed Logon**: "Someone rattled the handle." (Brute Force).
3.  **Privilege Use**: "They used the Master Key." (Sudo).

### Context
A single event means nothing.
*   `User=Bob`, `LogonType=Network`, `Source=Workstation`. (Normal).
*   `User=Bob`, `LogonType=Network`, `Source=China`. (Malicious).

---

## 3. Guided Practice

### Investigating a Brute Force
**Scenario**: You see 50 failed logins for 'root' followed by 1 successful login.

**Analysis**:
1.  **Phase 1**: The attacker guessed 50 times.
2.  **Phase 2**: They found the password.
3.  **Conclusion**: Full compromise.

**Action**:
1.  Force password reset.
2.  Check what commands were run *after* the success.

---

## 4. Reflection Check

1.  **Noise**: Why not alert on *every* failed login? (Fat finger errors. Users type wrong passwords daily. Alert on > 10 failures).
2.  **Blind Spots**: If a user logs in via Console (Physical keyboard), do you see it? (Yes, usually `Logon Type 2`. But you often ignore it because you assume physical access is trusted).
3.  **Kerberos**: What is a TGT request? (The initial handshake in Active Directory. Heavy TGT activity might indicate Kerberoasting).

---

## 5. Completion Criteria

This module is complete when:
1.  You can distinguish between a "Failed Login" and a "Brute Force Attack".
2.  You treat `sudo` logs as high-criticality events.
3.  You understand that Identity is the new Perimeter.
