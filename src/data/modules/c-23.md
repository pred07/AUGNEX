# Network Telemetry for Attack Validation

## 1. What this module covers
Using network data (PCAP, NetFlow, Zeek) to validate attacks that bypass endpoints.

## 2. Why this matters for purple teams
You can wipe a hard drive, but you can't wipe the packets that already crossed the wire.

## 3. Core concepts explained clearly

### Zeek (Bro) Logs
*   Structured text logs for network traffic.
*   `conn.log`: All connections.
*   `http.log`: All HTTP requests (User-Agent, URI).
*   `dns.log`: All Queries.
*   `ssl.log`: Certificate details.

### Encrypted Traffic Analysis (ETA)
*   Even without decryption, you can measure:
    *   Entropy (Randomness).
    *   Byte Frequency.
    *   JA3 Hash (Client Fingerprint).

## 4. Validation examples

### Validating C2 over SSL
1.  **Red**: Start a C2 Beacon over HTTPS.
2.  **Blue**: Check Zeek `ssl.log`.
    *   Look at the Cert Issuer. "Let's Encrypt"? Self-Signed?
    *   Look at the JA3 hash. Is it `powershell` or `chrome`?
3.  **Alert**: Trigger on "Unknown JA3 hash to Rare Domain".

## 5. Common gaps and failures
*   **Internal Visibility**: We log Internet traffic, but switch-to-switch traffic is dark.
*   **Short retention**: PCAP fills disk fast. Usually only kept for 24 hours.

## 6. Key takeaways
*   **Metadata is lightweight**: Store Zeek logs (Metadata) for a year. Store PCAP for a day.
*   **Backup**: Network logs confirm the breach when the endpoint logs are deleted.
