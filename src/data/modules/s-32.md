# OpenCTI: Knowledge Graph Intelligence

## 1. Orientation

### What this module covers
While MISP is great for lists of IoCs, **OpenCTI** is designed for high-level strategic analysis using a **Knowledge Graph**. It maps relationships (hypergraphs) between actors, campaigns, and TTPs.

### Learning Objectives
*   Contrast **Relational** (SQL) vs **Graph** (Neo4j) data models.
*   Navigate the OpenCTI visualizer.
*   Import data from STIX II connectors.

---

## 2. Core Content

### The Graph Model
*   **Node:** An entity (Malware, Region, Actor).
*   **Edge:** The relationship (`targets`, `uses`, `located_in`).
*   *Query:* "Show me all Actors who `target` the Energy Sector AND `use` Mimikatz."

### Connectors
OpenCTI relies on an ecosystem of connectors:
*   **Import:** Pull from MISP, AlienVault, CrowdStrike.
*   **Enrichment:** Send IP to VirusTotal and update the Node.
*   **Stream:** Push data to Splunk/Elastic.

### Visualization
The "Investigate" view allows analysts to drag and drop entities to see second and third-order links. 
*   *Example:* Actor A -> targets -> Company B. Company B -> partner of -> Company C. (Risk to Company C?).

---

## 3. Lab: Graphing the Attack

### Scenario
Map the following in OpenCTI (Mental Exercise):

1.  **Entity:** APT28 (Intrusion Set).
2.  **Entity:** XAgent (Malware).
3.  **Entity:** Ukraine (Location).
4.  **Relationships:**
    *   APT28 `uses` XAgent.
    *   APT28 `targets` Ukraine.

**Inference:**
If you see XAgent in Germany, you might infer APT28 is expanding targets.

---

## 4. Reflection
1.  Why is OpenCTI heavier to run than MISP? (It uses ElasticSearch, Redis, MinIO, and RabbitMQ. It is a full Enterprise Data Platform).
2.  How does passing data from MISP to OpenCTI work? (MISP handles the raw IoCs; OpenCTI handles the strategic "Story" and links).
