# IAM: The Perimeter of the Cloud

## 1. Orientation

### What this module covers
In the Cloud, the network perimeter (Firewall) is secondary. Examples: S3 buckets and Lambda functions don't sit behind firewalls; they are protected by **Identity**. IAM (Identity and Access Management) is the primary defense.

### Learning Objectives
*   Understand the Structure of an IAM Policy (Principal, Action, Resource, Condition).
*   Implement **Least Privilege** with Role-Based Access Control (RBAC).
*   Master the concept of **AssumeRole** (Temporary Credentials).

---

## 2. Core Content

### Principals: Users vs. Roles
*   **IAM User:** A person. Has long-term keys (Access Key / Secret Key). *Avoid using these if possible.*
*   **IAM Role:** A hat. Anyone (User, EC2 Instance, Lambda) can put on the hat to get permissions. Has *temporary* keys (Session Token).

### Anatomy of a Policy (JSON)
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::my-secret-bucket/*"
    }
  ]
}
```
*   **Effect:** Allow or Deny (Deny always wins).
*   **Action:** What can they do? (`s3:*` is dangerous).
*   **Resource:** Where can they do it?

### The Danger of `*`
`Action: "*"` and `Resource: "*"` is Administrative Access. Giving this to a Developer means they can delete the entire company.

---

## 3. Lab: Privilege Escalation

### Scenario
You find a Policy with this permission:
```json
{
  "Effect": "Allow",
  "Action": "iam:CreatePolicyVersion",
  "Resource": "*"
}
```
**The Attack:**
1.  The attacker has limited rights.
2.  They define a *new version* of their own policy that grants `*` (AdministratorAccess).
3.  They become Admin. 

**Lesson:** Never grant write access to IAM policies unless the user is a trusted Admin.

---

## 4. Reflection
1.  Why should EC2 instances use Roles instead of hardcoded keys? (Roles rotate credentials automatically. Hardcoded keys in code lead to GitHub leaks).
2.  What is MFA Delete? (A requirement that a human must enter a 2FA code to delete an object. Protects against rogue automation).
