# Detecting Suspicious Network Activity

## 1. Orientation

### What this module covers
This module covers specific indicators of compromise on the wire. **Beaconing**, **Long Connections**, and **DGA** (Domain Generation Algorithms).

### Fit in the Learning Path
This is Hunter territory. Looking for the faint signals of a stealthy C2 channel.

### Learning Objectives
By the end of this module, you should understand:
*   **Beaconing** (Heartbeats).
*   **Data Exfiltration** via DNS/ICMP.
*   **Tor / VPN** detection.

---

## 2. Core Content

### Beaconing
Malware calls home to check for commands.
*   *Pattern*: A small packet to the same IP every 60 seconds (with Jitter).
*   *Detection*: Frequency Analysis. "Who is talking like a clock?"

### DGA (Domain Generation Algorithms)
Botnets generate random domains to evade blacklists.
*   `asd78f6asdf.com`, `987234lkjba.net`.
*   *Detection*: High entropy (randomness) in domain names.

### Long Connections
Most HTTP connections last milliseconds.
A connection lasting 4 hours is likely a **Tunnel** or **Reverse Shell**.

---

## 3. Guided Practice

### RITA (Real Intelligence Threat Analytics)
A tool (conceptual) that visualizes beacons.

**Visualizing Strobe Light**:
*   Normal Web Browsing: Random dots.
*   Beaconing: A perfect solid line of dots at regular intervals.

**Analysis**:
If you see a PC connecting to `api.google.com` every 10 seconds exactly?
*   Likely legitimate (Google Updater).
If you see a PC connecting to `bad-site.org` every 10 seconds?
*   Malware.

---

## 4. Reflection Check

1.  **Jitter**: Attackers add "Jitter" (Sleep 60s +/- 20%). Why? (To break the precise time signature and look more random).
2.  **DNS Tunneling**: If a user queries TXT records for `subdomain.evil.com` 1000 times, what is that? (Encoded C2 traffic inside DNS packets).
3.  **Exfil**: Why limit outbound ICMP (Ping)? (Because you can hide data inside the padding of a Ping packet).

---

## 5. Completion Criteria

This module is complete when:
1.  You can explain "Beaconing".
2.  You treat High Entropy domains (`xlkjsdf.com`) as malicious.
3.  You understand that consistency in traffic timing is a machine trait, not a human one.
