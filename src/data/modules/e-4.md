# Penetration Testing Methodologies (PTES, OWASP, NIST)

## 1. Orientation

### What this module covers
This module introduces the standard methodologies that transform random hacking into professional security assessment. Methodologies ensure consistency, completeness, and defensible results. Without them, you'll miss vulnerabilities, repeat work, and struggle to communicate findings.

### Fit in the Learning Path
Methodology separates amateurs from professionals. It ensures you cover all attack vectors systematically, don't miss obvious issues, and can explain your process to clients and auditors.

### Learning Objectives
By the end of this module, you will:
*   Understand and apply the PTES (Penetration Testing Execution Standard) phases
*   Navigate OWASP resources for web application testing
*   Reference NIST frameworks for organizational context
*   Adapt methodology to specific engagement needs

---

## 2. Core Content

### Mental Model: The Scientific Method for Hacking

**How professionals think about this:**
Penetration testing is applied security science. Like the scientific method, it follows repeatable steps that produce consistent, verifiable results. Methodology ensures you can explain exactly what you did, why, and what it means.

```
THE METHODICAL APPROACH:

Random Hacking:                    Professional Testing:
┌────────────────────┐            ┌────────────────────┐
│ "Let me try SQLi"  │            │ 1. Pre-engagement  │
│ "Ooh, a login page"│            │ 2. Intelligence    │
│ "Nmap everything"  │            │ 3. Threat Modeling │
│ "Did I miss stuff?"│            │ 4. Vulnerability   │
│ "Where was I?"     │            │ 5. Exploitation    │
│                    │            │ 6. Post-Exploit    │
│ Result: Incomplete │            │ 7. Reporting       │
│ and unrepeatable   │            │                    │
└────────────────────┘            │ Result: Complete,  │
                                  │ consistent, and    │
                                  │ defensible         │
                                  └────────────────────┘
```

### PTES: The Penetration Testing Execution Standard

**The seven phases:**

```
┌────────────────────────────────────────────────────────────────────┐
│                                                                    │
│  1. PRE-ENGAGEMENT         Before you touch anything              │
│     ─────────────────────────────────────────────────────────────  │
│     • Scope definition      • Legal authorization                 │
│     • Rules of engagement   • Emergency contacts                  │
│     • NDA signing           • Timeline agreement                  │
│                                                                    │
├────────────────────────────────────────────────────────────────────┤
│                                                                    │
│  2. INTELLIGENCE GATHERING  Know your target                      │
│     ─────────────────────────────────────────────────────────────  │
│     • OSINT                 • DNS enumeration                     │
│     • Technology identification  • Employee research              │
│     • Previous breaches          • Network mapping                │
│                                                                    │
├────────────────────────────────────────────────────────────────────┤
│                                                                    │
│  3. THREAT MODELING         Think before acting                   │
│     ─────────────────────────────────────────────────────────────  │
│     • Asset identification  • Attack surface mapping              │
│     • Entry point analysis  • Prioritization                      │
│     • "What would I target first?"                                │
│                                                                    │
├────────────────────────────────────────────────────────────────────┤
│                                                                    │
│  4. VULNERABILITY ANALYSIS  Find the holes                        │
│     ─────────────────────────────────────────────────────────────  │
│     • Automated scanning    • Manual testing                      │
│     • Verification          • False positive elimination          │
│     • CVE research          • Configuration review                │
│                                                                    │
├────────────────────────────────────────────────────────────────────┤
│                                                                    │
│  5. EXPLOITATION            Prove the impact                      │
│     ─────────────────────────────────────────────────────────────  │
│     • Exploit development/selection  • Initial access             │
│     • Payload customization          • Bypass techniques          │
│     • Documentation of success                                    │
│                                                                    │
├────────────────────────────────────────────────────────────────────┤
│                                                                    │
│  6. POST-EXPLOITATION       What can you do from here?            │
│     ─────────────────────────────────────────────────────────────  │
│     • Privilege escalation  • Lateral movement                    │
│     • Credential harvesting • Data access demonstration           │
│     • Persistence (if authorized)  • Network pivoting             │
│                                                                    │
├────────────────────────────────────────────────────────────────────┤
│                                                                    │
│  7. REPORTING               The actual deliverable                │
│     ─────────────────────────────────────────────────────────────  │
│     • Executive summary     • Technical details                   │
│     • Risk ratings          • Remediation guidance                │
│     • Evidence              • Retesting recommendations           │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘
```

**Time allocation (typical engagement):**

| Phase | Typical Effort |
|-------|---------------|
| Pre-engagement | 5% |
| Intelligence Gathering | 20% |
| Threat Modeling | 10% |
| Vulnerability Analysis | 25% |
| Exploitation | 15% |
| Post-Exploitation | 10% |
| Reporting | 15% |

### OWASP: Web Application Security Resources

**OWASP is not just the Top 10:**

| Resource | Purpose | When to Use |
|----------|---------|-------------|
| **OWASP Top 10** | Most critical web risks | Understanding priorities |
| **WSTG** | Web Security Testing Guide | Step-by-step testing checklist |
| **ASVS** | Application Security Verification Standard | Verification requirements |
| **Cheat Sheets** | Quick security references | Implementation guidance |
| **SAMM** | Software Assurance Maturity Model | Program assessment |

**The OWASP Testing Guide structure:**

```
WSTG CATEGORIES:

1. Information Gathering
   └── Fingerprinting, mapping, configuration discovery

2. Configuration and Deployment Testing
   └── HTTP methods, file extensions, admin interfaces

3. Identity Management Testing
   └── Roles, registration, provisioning

4. Authentication Testing
   └── Credentials, lockout, bypass mechanisms

5. Authorization Testing
   └── Path traversal, privilege escalation, IDOR

6. Session Management Testing
   └── Cookies, tokens, timeout, fixation

7. Input Validation Testing
   └── XSS, SQLi, command injection, all inputs

8. Error Handling
   └── Error codes, stack traces, information leakage

9. Cryptography
   └── Weak algorithms, key management, transport layer

10. Business Logic Testing
    └── Workflow bypass, race conditions, integrity checks

11. Client-Side Testing
    └── DOM-based vulnerabilities, storage, WebSockets
```

### NIST Frameworks

**NIST provides organizational context:**

**NIST CSF (Cybersecurity Framework):**
- Identify, Protect, Detect, Respond, Recover
- Risk-based approach
- How organizations should structure security programs

**NIST SP 800-115 (Technical Guide to Testing):**
- Information security testing and assessment
- Phases: Planning, Discovery, Attack, Reporting
- Complements PTES for federal/regulated environments

**NIST SP 800-53 (Security Controls):**
- Control catalog organizations implement
- Testers verify these controls work

### Other Relevant Standards

| Standard | Focus | When Referenced |
|----------|-------|-----------------|
| **MITRE ATT&CK** | Adversary tactics and techniques | Red team operations, threat mapping |
| **OSSTMM** | Security testing methodology | Comprehensive testing metrics |
| **ISSAF** | Information Systems Security Assessment | Detailed technical procedures |
| **CIS Controls** | Prioritized security actions | Control verification |
| **ISO 27001** | Security management system | Compliance-focused testing |

### Adapting Methodology to Context

**Not every engagement uses every phase equally:**

| Engagement Type | Emphasis |
|-----------------|----------|
| **Web App Pentest** | Heavy OWASP WSTG use, less network focus |
| **Network Pentest** | PTES full cycle, infrastructure focus |
| **Red Team** | Intelligence gathering heavy, stealth critical |
| **Compliance Assessment** | Control verification against NIST/ISO |
| **Vulnerability Assessment** | Discovery phase emphasized, limited exploitation |

---

## 3. Guided Practice

### Exercise 1: PTES Phase Mapping

Classify each action into the correct PTES phase:

| Action | Phase |
|--------|-------|
| Searching LinkedIn for employee names | ___ |
| Running Nessus against web servers | ___ |
| Extracting password hashes post-compromise | ___ |
| Negotiating testing hours with client | ___ |
| Exploiting SQL injection to get shell | ___ |
| Writing the executive summary | ___ |
| Determining which server is most critical | ___ |

### Exercise 2: OWASP WSTG Application

For a login page, list the WSTG tests you would perform:

1. (Info Gathering): ___
2. (Authentication): ___
3. (Session): ___
4. (Input Validation): ___
5. (Error Handling): ___

### Exercise 3: Framework Selection

Which methodology/standard would you primarily reference for:

| Scenario | Primary Framework |
|----------|-------------------|
| Testing a new e-commerce website | ___ |
| Red team against financial institution | ___ |
| Verifying SOC 2 compliance | ___ |
| Testing industrial control systems | ___ |

---

## 4. Reflection Check

### Methodology Understanding
1. Why do senior pentesters still use checklists even though they know the tests by heart?

2. A client says "just hack us, we don't care about methodology." Why is this problematic?

3. What's the difference between PTES and OWASP WSTG? When would you use each?

### Practical Application
1. You're 80% through an engagement and realize you skipped thorough intelligence gathering. What's the consequence?

2. The client only cares about the exploitation phase—they want to see hacks. What phase actually generates the deliverable they're paying for?

3. How does MITRE ATT&CK complement PTES for red team operations?

---

## 5. Key Misconceptions

**MYTH: "Methodology slows you down"**
REALITY: Methodology prevents wasted time. Skipping steps means missing vulnerabilities and repeating work.

**MYTH: "OWASP Top 10 is a testing methodology"**
REALITY: OWASP Top 10 is a risk awareness list. WSTG/ASVS are the testing methodologies.

**MYTH: "Reporting is just documentation overhead"**
REALITY: Reporting is the actual product. The client pays for the report, not for your shell access.

**MYTH: "Follow methodology exactly as written"**
REALITY: Methodology guides judgment; it doesn't replace it. Adapt to engagement context.

**MYTH: "One framework covers everything"**
REALITY: Professionals use multiple frameworks: PTES for structure, OWASP for web, ATT&CK for tactics.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Recite** and explain all seven PTES phases
2. **Navigate** OWASP resources and identify appropriate testing guides
3. **Match** frameworks to engagement types
4. **Apply** methodology to structure an assessment approach
5. **Explain** why reporting is as important as exploitation

---

## 7. Further Depth (Optional)

*   **Reading:** PTES Technical Guidelines (pentest-standard.org)
*   **Resource:** OWASP Web Security Testing Guide, full version
*   **Framework:** Study MITRE ATT&CK matrix and its structure
*   **Practice:** Create a testing checklist for a specific application type
