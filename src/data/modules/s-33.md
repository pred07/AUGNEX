# STIX 2.1 & TAXII

## 1. Orientation

### What this module covers
For different tools (Firewall, SIEM, TIP) to talk, they need a common language. **STIX** (Structured Threat Information Expression) is the JSON schema. **TAXII** (Trusted Automated Exchange of Intelligence Information) is the transport protocol (HTTPS API).

### Learning Objectives
*   Read a **STIX JSON** object.
*   Understand the **SDO** (Stix Domain Objects) architecture.
*   Connect a TAXII client to a server.

---

## 2. Core Content

### STIX Objects (SDOs)
1.  **Indicator:** The pattern to look for. (`[ipv4-addr:value = '1.2.3.4']`).
2.  **Observed Data:** The fact that it was seen.
3.  **Threat Actor:** The adversary.
4.  **Campaign:** The grouping of activity.
5.  **Relationship:** The link (`source_ref`, `target_ref`, `relationship_type`).

### JSON Example
```json
{
  "type": "indicator",
  "id": "indicator--8e2e2d2b...",
  "created": "2024-01-01T00:00:00Z",
  "pattern": "[file:hashes.'SHA-256' = 'a1b2...']",
  "pattern_type": "stix",
  "valid_from": "2024-01-01T00:00:00Z"
}
```

### TAXII Channels
*   **Collection:** A logical grouping of objects (e.g., "Phishing Feed").
*   **Discovery:** Finding which collections a server has.
*   **Poll:** Downloading data from a collection.

---

## 3. Lab: Parsing STIX

### Task
You receive a STIX bundle. Find the C2 IP.

1.  Look for `type: "infrastructure"`.
2.  Find the `relationship` where `relationship_type: "communicates-with"`.
3.  Follow the `target_ref` to the `ipv4-addr` object.

*Why is this better than CSV?* CSV just lists IPs. STIX tells you *why* the IP is there and *who* uses it.

---

## 4. Reflection
1.  Is STIX 2.1 backwards compatible with STIX 1.x? (No. STIX 1 was XML and very complex. STIX 2 is JSON and graph-based).
2.  Why do some vendors implement "Custom Objects"? (Sometimes the standard schema doesn't describe a unique threat feature, but it breaks interoperability).
