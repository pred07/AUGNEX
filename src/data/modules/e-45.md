# Common Active Directory Misconfigurations

## 1. Unit Brief: The Weak Links
AD is complex. Admins make mistakes. These mistakes (ACLs, GPOs, Trusts) are the primary vector for privilege escalation.

## 2. Real-World Relevance
*   **ACL**: "Bob" was given "Full Control" over the "IT Support" group so he could manage it.
*   **Attack**: "IT Support" group has "Local Admin" on the DC.
*   **Chain**: Bob -> Add Self to IT Support -> RDP to DC -> Dump Hashes.

## 3. Core Concepts

### Kerberoasting
Service Accounts (SQL, etc.) have passwords.
*   Any user can request a TGS for any service.
*   The TGS is encrypted with the Service Account's password hash.
*   **Attack**: Request ticket -> Crack offline -> You have the Service Account password.

### AS-REP Roasting
If a user has "Do not require Kerberos preauthentication" set.
*   **Attack**: You can ask the DC for a chunk of encrypted data (AS-REP) for that user without knowing their password.
*   Crack it offline.

### Unconstrained Delegation
A server setting. "I trust this server to impersonate anyone to any other server."
*   **Attack**: Trick a Domain Admin to connect to this server. The server captures the DA's TGT. You export it and become DA.

## 4. Practical Examples

### Checking for Pre-Auth (AS-REP)
Tool: `Rubeus`
`Rubeus.exe asreproast`
*   Output: `Hash for user: jdoe...`
*   Action: Crack with Hashcat mode 18200.

### GPO Abuse
You have write access to a GPO.
1.  Edit GPO: "Create Scheduled Task that runs `net A localgroup administrators hacker /add`".
2.  Wait for GPO update (90 mins).
3.  Every computer in the domain executes your command.

## 5. Common Mistakes Beginners Make
*   **Focusing on patching**: You can't "patch" a misconfigured ACL. You have to change the configuration.
*   **Ignoring Description fields**: Admins often write passwords in the Description field of computer objects.

## 6. Key Takeaways
*   **ACLs are critical**: Who has permission to do what?
*   **Roasting is standard**: Always check for Kerberoastable users.
