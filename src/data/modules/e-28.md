# Insecure Deserialization (Conceptual)

## 1. Orientation

### What this module covers
This module covers the "Dark Arts" of exploitation: **Deserialization**. Turning data back into objects, and hijacking the process to execute code.

### Fit in the Learning Path
This is distinctively complex but leads to RCE (Remote Code Execution) in Java, PHP, Python, and .NET. It's often the root cause of massive breaches (e.g., Equifax).

### Learning Objectives
By the end of this module, you should understand:
*   **Serialization**: Object -> Stream.
*   **Deserialization**: Stream -> Object.
*   **Gadget Chains**: The Rube Goldberg machine of exploitation.

---

## 2. Core Content

### The Concept
*   **Serialization**: Saving the state of a "User" object to a file/cookie.
*   **Deserialization**: Loading it back.

**The Flaw**:
If the code blindly deserializes user-supplied data, it instantiates the object *before* checking if it's safe.
If there is a "Destructor" method (`__destruct`, `readObject`) that deletes files or runs commands, the attacker can trigger it.

### Gadget Chains
Libraries (like Apache Commons) often contain classes that can be chained together to run `cmd.exe`.
Tool: `ysoserial`.

---

## 3. Guided Practice

### Identifying Serialized Data
**Java**:
*   Hex starts with `AC ED 00 05`.
*   Base64 starts with `rO0`...

**PHP**:
*   Format: `O:4:"User":2:{s:4:"name";s:3:"bob";}`
*   Attack: Change `s:3:"bob"` to an evil object.

**Python (Pickle)**:
*   Never unpickle untrusted data. It's trivial RCE.

---

## 4. Reflection Check

1.  **Difficulty**: Why is this harder than SQLi? (Because you need to understand the source code and available libraries to build a Gadget Chain).
2.  **Mitigation**: Does "Signing" the object fix it? (Yes. Like JWT. If the signature is invalid, don't deserialize).
3.  **Context**: Why is `eval()` in JS similar? (It treats text as executable code).

---

## 5. Completion Criteria

This module is complete when:
1.  You can spot a Java serialized object in the wild (`AC ED`).
2.  You understand that `ysoserial` is the weapon of choice.
3.  You respect the complexity of gadget chains.
