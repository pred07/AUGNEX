# Credential Harvesting Concepts

## 1. Unit Brief: Collecting the Keys
Once you have Administrator access on a machine, you want to steal the credentials of everyone else who logged into it. If a Domain Admin logged in last week, their hash might still be in memory.

## 2. Real-World Relevance
*   **Mimikatz**: The tool that changed the world. It pulls plaintext passwords/hashes from memory (`lsass.exe`).

## 3. Core Concepts

### LSASS (Local Security Authority Subsystem Service)
The process that holds the keys.
*   **Stored Artifacts**: NTLM Hashes, Kerberos Tickets, sometimes Plaintext passwords (WDigest).

### SAM (Security Account Manager)
The database of *local* users.
*   Accessible only as SYSTEM.
*   Contains the local Administrator hash (often shared across all PCs if LAPS is not used).

### DCSync
If you are Domain Admin (or have Replicating Directory Changes permission), you don't need to touch `lsass`. You politely ask the DC to replicate its passwords to you.
*   **Result**: You get the NTLM hash of every user in the domain (including `krbtgt`).

## 4. Practical Examples

### Running Mimikatz
```mimikatz
privilege::debug
sekurlsa::logonpasswords
```
*   **Output**:
    ```
    User: Administrator
    Domain: CONTOSO
    NTLM: 31d6cfe0d16ae931b73c59d7e0c089c0
    ```

### Dumping SAM
```bash
reg save HKLM\SAM sam.save
reg save HKLM\SYSTEM system.save
# Download files and run:
samdump2 system.save sam.save
```

## 5. Common Mistakes Beginners Make
*   **Tripping Antivirus**: Mimikatz is flagged by everything. You usually need to dump the memory of `lsass` to a file (`procdump64.exe`) and run Mimikatz on that file *offline* on your own machine.
*   **Crashing the box**: Touching `lsass` is risky.

## 6. Key Takeaways
*   **Don't need plaintext**: In Windows, the Hash *is* the password (Pass-the-Hash).
*   **Clean memory**: Rebooting a server clears the credentials in memory (but annoys the users).
