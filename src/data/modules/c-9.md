# Coverage Gaps and Blind Spots

## 1. Orientation

### What this module covers
This module teaches systematic identification and remediation of detection blind spots—the areas where your security visibility fails. Knowing what you can't see is as important as knowing what you can.

### Fit in the Learning Path
Attackers operate in your blind spots. Every gap in coverage is an attacker advantage. Honest assessment of visibility limitations is essential for prioritizing security investments and understanding residual risk.

### Learning Objectives
By the end of this module, you will:
*   Identify different types of coverage gaps
*   Assess visibility across your environment
*   Prioritize gap remediation
*   Build continuous gap discovery processes

---

## 2. Core Content

### Mental Model: The Dark Corners

**How professionals think about this:**
Your security posture isn't defined by what you monitor—it's defined by what you don't. Attackers actively seek blind spots. Honest gap assessment is the first step to closing them.

```
COVERAGE GAP CONCEPT:

Your perceived visibility:
┌─────────────────────────────────────────────────────────────────────┐
│ ████████████████████████████████████████████████████████████████   │
│ "We have full visibility into our environment"                     │
└─────────────────────────────────────────────────────────────────────┘

Actual visibility:
┌─────────────────────────────────────────────────────────────────────┐
│ ████████░░░░████░░░░░░░████████░░░░████████░░░░░░░░████░░░██████   │
│                                                                     │
│ ░░░░ = Blind spots where attackers operate undetected              │
│                                                                     │
│ Common gaps:                                                       │
│ - Legacy systems without agents                                    │
│ - Encrypted traffic                                                │
│ - Cloud environments                                               │
│ - OT/IoT devices                                                   │
│ - Container workloads                                              │
│ - Partner/vendor access                                            │
└─────────────────────────────────────────────────────────────────────┘
```

### Types of Coverage Gaps

**Gap taxonomy:**

```
COVERAGE GAP CATEGORIES:

1. ASSET GAPS
   ─────────────────────────────
   Systems without security controls
   
   Examples:
   - Servers without EDR
   - Workstations off-domain
   - BYOD devices
   - Shadow IT
   - Contractor laptops
   - IoT/OT devices
   - Legacy systems

2. LOG GAPS
   ─────────────────────────────
   Systems exist but don't send logs
   
   Examples:
   - Logs not forwarded to SIEM
   - Log retention too short
   - Log format not parsed
   - Logging disabled
   - Logs at wrong verbosity

3. VISIBILITY GAPS
   ─────────────────────────────
   Logs exist but content obscured
   
   Examples:
   - Encrypted traffic (HTTPS)
   - Encrypted payloads
   - Living off the land (legit tools)
   - Obfuscated commands
   - Memory-only malware

4. DETECTION GAPS
   ─────────────────────────────
   Logs exist but no rules to alert
   
   Examples:
   - No rule for technique
   - Rule too specific
   - Rule disabled (too noisy)
   - New technique not covered

5. SKILL GAPS
   ─────────────────────────────
   Alert exists but not understood
   
   Examples:
   - Alert not recognized as serious
   - Analyst lacks context
   - Runbook doesn't exist
   - Training gap
```

### Asset Coverage Assessment

**What percentage is actually monitored?**

```
ASSET COVERAGE AUDIT:

1. INVENTORY ALL ASSETS
   ─────────────────────────────
   Source: CMDB, network scans, cloud inventory
   
   Total endpoints: 2,500
   Total servers: 300
   Total network devices: 150
   Total cloud instances: 500
   Total IoT/OT: 200

2. VERIFY CONTROL DEPLOYMENT
   ─────────────────────────────
   Check each control's coverage:
   
   EDR deployed:
   - Endpoints: 2,350 / 2,500 (94%)
   - Servers: 280 / 300 (93%)
   - Cloud: 400 / 500 (80%)
   
   Logs forwarded to SIEM:
   - Endpoints: 2,200 / 2,500 (88%)
   - Servers: 290 / 300 (97%)
   - Network: 100 / 150 (67%)

3. IDENTIFY GAPS
   ─────────────────────────────
   Missing EDR (150 endpoints):
   - 50 legacy Windows XP (unsupported)
   - 30 macOS (policy gap)
   - 40 Linux (deployment gap)
   - 30 contractor devices (no access)
   
   Missing logs (300 endpoints):
   - 200 log forwarding not configured
   - 100 no agent to forward

4. QUANTIFY RISK
   ─────────────────────────────
   Unmonitored assets with access to:
   - Crown jewel data: 15 systems
   - Domain credentials: 85 systems
   - Public internet: ALL
   
   These are priority gaps
```

### Log Coverage Assessment

**What data do you actually have?**

```
LOG COVERAGE MATRIX:

DATA SOURCE           COLLECTED  PARSED  ALERTS
──────────────────────────────────────────────────
Windows Security      ✓          ✓       ✓
Windows Sysmon        Partial    ✓       ✓
Windows PowerShell    ✓          ✓       Partial
Active Directory      ✓          ✓       ✓
EDR Telemetry         ✓          ✓       ✓
Firewall              ✓          Partial Partial
DNS                   No         -       -
DHCP                  No         -       -
Web Proxy             ✓          ✓       Partial
Email Gateway         ✓          ✓       ✓
Cloud (AWS)           Partial    Partial No
Cloud (Azure)         ✓          ✓       Partial
SaaS Applications     No         -       -
VPN                   ✓          ✓       ✓
Badge Access          No         -       -

GAPS IDENTIFIED:
- DNS logs critical for threat detection (not collected)
- AWS CloudTrail partial coverage
- SaaS application logs completely missing
- Firewall parsing incomplete (can't alert)
```

### Visibility Challenges

**What you can't see even with logs:**

```
VISIBILITY CHALLENGES:

1. ENCRYPTED TRAFFIC
   ─────────────────────────────
   Problem: 90%+ traffic is HTTPS
   Impact: Network IDS blind to content
   
   Solutions:
   - TLS inspection (privacy concerns)
   - Endpoint visibility (see before encryption)
   - Metadata analysis (time, size, destination)

2. LEGITIMATE TOOL ABUSE
   ─────────────────────────────
   Problem: PowerShell, WMI, RDP are normal
   Impact: Can't block, hard to detect
   
   Solutions:
   - Behavioral analysis
   - Context (who, when, what)
   - Command line logging

3. MEMORY-ONLY ATTACKS
   ─────────────────────────────
   Problem: No file to scan
   Impact: Traditional AV useless
   
   Solutions:
   - Memory scanning
   - Behavioral EDR
   - Script block logging

4. OBFUSCATION
   ─────────────────────────────
   Problem: Commands intentionally obscured
   Impact: Pattern matching fails
   
   Solutions:
   - De-obfuscation engines
   - Behavioral detection
   - Supervised execution

5. TIME GAPS
   ─────────────────────────────
   Problem: Not all hours equal
   Impact: Night/weekend coverage
   
   Solutions:
   - 24/7 SOC
   - Automation
   - On-call rotation
```

### Detection Rule Gaps

**Rules that should exist but don't:**

```
DETECTION GAP ASSESSMENT:

METHOD 1: ATT&CK MAPPING
─────────────────────────────
For each technique:
□ Do we have a detection rule?
□ Has it been tested?
□ What variations are covered?

Technique: T1003.001 (LSASS Memory)
Rule exists: Yes
Tested: 1 year ago
Variations covered:
  ✓ procdump.exe
  ✓ mimikatz
  ✗ comsvcs.dll (GAP!)
  ✗ nanodump (GAP!)

METHOD 2: ATTACK SIMULATION
─────────────────────────────
Run techniques, observe results

Atomic Red Team test:
T1003.001 - LSASS Dump
  Method 1: Detected ✓
  Method 2: Detected ✓
  Method 3: NOT DETECTED ✗

METHOD 3: THREAT INTEL CROSSWALK
─────────────────────────────
New threat report: APT29 using X technique
Question: Do we detect X?
Answer: NO → GAP IDENTIFIED

METHOD 4: LOG ANALYSIS
─────────────────────────────
What events have NO associated rules?
EventID 10 (Sysmon): 50 rules
EventID 11 (Sysmon): 12 rules
EventID 17 (Sysmon): 0 rules ← GAP

Events being collected but not analyzed
```

### Gap Prioritization

**Not all gaps are equal:**

```
GAP PRIORITIZATION MATRIX:

                         IMPACT
                 Low ─────────────── High
                  │                    │
         ┌────────┼────────────────────┼────────┐
         │        │                    │        │
    Low  │  P4    │       P3           │   P2   │
         │        │                    │        │
         │        │                    │        │
LIKELI-  ├────────┼────────────────────┼────────┤
HOOD     │        │                    │        │
         │        │                    │        │
    High │  P3    │       P2           │   P1   │
         │        │                    │        │
         └────────┴────────────────────┴────────┘

PRIORITIZATION FACTORS:

1. THREAT RELEVANCE
   Is this technique used by threats targeting us?
   Yes = Higher priority

2. ASSET CRITICALITY
   Does gap expose crown jewels?
   Yes = Higher priority

3. EXPLOITATION EASE
   How easy to exploit this gap?
   Easy = Higher priority

4. REMEDIATION COST
   How hard to fix?
   Easy fix = Do first (quick win)

5. RESIDUAL CONTROLS
   Other controls in place?
   No = Higher priority
```

### Building a Gap Discovery Program

**Continuous improvement:**

```
CONTINUOUS GAP DISCOVERY:

WEEKLY:
─────────────────────────────
□ Review new threat intelligence
□ Check for new ATT&CK techniques
□ Audit agent deployment status
□ Review rule effectiveness metrics

MONTHLY:
─────────────────────────────
□ Run automated attack simulations
□ Review asset inventory changes
□ Check log forwarding status
□ Validate critical detections

QUARTERLY:
─────────────────────────────
□ Full purple team exercise
□ ATT&CK coverage reassessment
□ Prioritized gap remediation
□ Management reporting

ANNUALLY:
─────────────────────────────
□ Comprehensive architecture review
□ Third-party assessment
□ Red team engagement
□ Strategy alignment
```

---

## 3. Guided Practice

### Exercise 1: Asset Gap Assessment

For your environment (or hypothetical):

| Asset Category | Total | Covered | Gap | Risk |
|----------------|-------|---------|-----|------|
| Workstations | ___ | ___ | ___ | ___ |
| Servers | ___ | ___ | ___ | ___ |
| Cloud instances | ___ | ___ | ___ | ___ |
| IoT/OT | ___ | ___ | ___ | ___ |

### Exercise 2: Log Source Audit

List 5 critical log sources and their status:

| Log Source | Collected | Parsed | Alerted | Gap? |
|------------|-----------|--------|---------|------|
| ___ | ___ | ___ | ___ | ___ |
| ___ | ___ | ___ | ___ | ___ |
| ___ | ___ | ___ | ___ | ___ |
| ___ | ___ | ___ | ___ | ___ |
| ___ | ___ | ___ | ___ | ___ |

### Exercise 3: Gap Prioritization

You identified these gaps. Prioritize 1-5:

| Gap | Priority | Justification |
|-----|----------|---------------|
| DNS logs not collected | ___ | ___ |
| 50 legacy systems no EDR | ___ | ___ |
| Cloud trail not monitored | ___ | ___ |
| No rule for DCSync | ___ | ___ |
| Badge access not collected | ___ | ___ |

---

## 4. Reflection Check

### Gap Understanding
1. 100% EDR coverage reported. You trust it?

2. Log source collected but never generated alert. Good or bad?

3. Encrypted traffic is 90%. Major concern?

### Strategic Thinking
1. Can't fix all gaps. How many is acceptable?

2. Zero gaps found in assessment. Celebrate or worry?

3. Gap exists in crown jewel access. Other controls exist. Safe?

---

## 5. Key Misconceptions

**MYTH: "We collect logs, so we have visibility"**
REALITY: Collecting ≠ parsing ≠ alerting ≠ investigating.

**MYTH: "Gaps will be found during incidents"**
REALITY: Finding gaps through breaches is expensive. Proactive discovery is cheaper.

**MYTH: "100% coverage is achievable"**
REALITY: Some gaps will always exist. Know them, manage them.

**MYTH: "Vendor dashboards show real coverage"**
REALITY: Vendors show THEIR coverage. Environment coverage requires validation.

**MYTH: "New tools close gaps automatically"**
REALITY: Tools require deployment, configuration, tuning, and ongoing maintenance.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Identify** different types of coverage gaps
2. **Audit** asset and log source coverage
3. **Prioritize** gaps based on risk
4. **Build** continuous gap discovery process
5. **Accept** that some gaps will persist (managed risk)

---

## 7. Further Depth (Optional)

*   **Tool:** Use DeTT&CT for gap analysis
*   **Practice:** Conduct formal coverage audit
*   **Framework:** MITRE ATT&CK Data Sources
*   **Resource:** Threat intelligence for prioritization
