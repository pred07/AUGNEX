# Detection Logic Basics

## 1. Orientation

### What this module covers
This module covers the **Boolean Logic** of detection. AND, OR, NOT, FOLLOWED BY.

### Fit in the Learning Path
Complex attacks require complex logic. Single-event matching is rarely enough.

### Learning Objectives
By the end of this module, you should understand:
*   **Stateful Detections** (Sequences).
*   **Thresholds**.
*   **Windowing** (Time).

---

## 2. Core Content

### The Operators
1.  **Simple**: `Process == 'cmd.exe'`.
2.  **Compound**: `Process == 'cmd.exe' AND Parent == 'winword.exe'`.
3.  **Sequence**: `Event A` followed by `Event B` within `5 minutes`.
    *   *Example*: "User Created" followed by "Added to Domain Admins".

### Time Windows
*   `COUNT(Failed Login) > 5` ... In what timeframe?
*   Forever? No.
*   Per minute? Yes.

---

## 3. Guided Practice

### Building a Brute Force Logic
**Goal**: Detect SSH Brute Force.

**Iteration 1**: `Event=Fail`.
*   *Result*: Too noisy.

**Iteration 2**: `Event=Fail AND Count > 10`.
*   *Result*: Better. But "Low and Slow" attacks (1 guess per hour) bypass it.

**Iteration 3**: `Event=Fail AND Count > 100` OR `Event=Success AND SourceIP matches ThreatIntel`.

---

## 4. Reflection Check

1.  **Complexity**: Complex logic is hard to query. (Performance hit).
2.  **Evasion**: Attacker knows your logic. "They check for 10 failures? I'll do 9."
3.  **Fuzzy Logic**: Machine Learning models use probabilities, not hard thresholds. (The future).

---

## 5. Completion Criteria

This module is complete when:
1.  You can construct a **Compound Query**.
2.  You understand the importance of **Time Windows**.
3.  You know that logic is a game of cat and mouse.
