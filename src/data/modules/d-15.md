# Network Defense Fundamentals

## 1. Orientation

### What this module covers
This module introduces network defense principles—the transition from passive monitoring to active protection. We examine foundational concepts: Defense in Depth, Least Privilege, Segmentation, and Zero Trust.

### Fit in the Learning Path
You've learned how to see (logs and visibility). Now you learn how to stop (defense controls). These fundamental principles guide all network security architecture decisions.

### Learning Objectives
By the end of this module, you will:
*   Apply Defense in Depth principles
*   Design network segmentation
*   Understand Zero Trust architecture
*   Implement Least Privilege at the network layer

---

## 2. Core Content

### Mental Model: The Castle vs The Airport

**How professionals think about this:**
Traditional security was like a castle—strong walls (firewall), assume everything inside is trusted. Modern security is like airport security—verify everyone at every checkpoint, trust no one automatically.

```
SECURITY MODEL EVOLUTION:

CASTLE MODEL (Traditional):
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  INTERNET ──► [FIREWALL] ──► INTERNAL NETWORK                      │
│              (The Wall)      (Trusted Zone)                        │
│                                                                     │
│  ASSUMPTIONS:                                                       │
│  ├── Outside = Untrusted, Inside = Trusted                         │
│  ├── Firewall stops attacks                                        │
│  └── Internal devices can talk freely                              │
│                                                                     │
│  PROBLEM:                                                           │
│  Once attacker gets inside (phishing, VPN compromise),             │
│  they have full access to everything                               │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘

ZERO TRUST MODEL (Modern):
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│           ┌──[Verify]──┐                                           │
│           ▼            │                                           │
│  USER ──► [Identity] ──► [Device Health] ──► [Policy] ──► RESOURCE│
│           │            │                      │                    │
│           └──[Verify]──┴──────[Verify]────────┘                    │
│                                                                     │
│  ASSUMPTIONS:                                                       │
│  ├── Assume breach (network already compromised)                   │
│  ├── Verify explicitly (every access request)                      │
│  ├── Least privilege (minimal access needed)                       │
│  └── Never trust, always verify                                    │
│                                                                     │
│  RESULT:                                                            │
│  Even if attacker is "inside," they can't access resources         │
│  without proper identity, device, and authorization                │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### Defense in Depth

**Layered security controls:**

```
DEFENSE IN DEPTH LAYERS:

┌─────────────────────────────────────────────────────────────────────┐
│  LAYER 1: PERIMETER                                                │
│  ─────────────────                                                 │
│  DDoS protection, Edge firewall, WAF                               │
│  → Stops: Volume attacks, known malicious IPs, obvious attacks    │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  LAYER 2: NETWORK                                                  │
│  ────────────────                                                  │
│  Segmentation, Internal firewalls, IDS/IPS                        │
│  → Stops: Lateral movement, east-west attacks                     │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  LAYER 3: ENDPOINT                                                 │
│  ─────────────────                                                 │
│  Host firewall, EDR, Antivirus, Patching                          │
│  → Stops: Malware, exploits, local attacks                        │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  LAYER 4: APPLICATION                                              │
│  ─────────────────────                                             │
│  Input validation, Authentication, Authorization                   │
│  → Stops: Injection, access control bypass                        │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  LAYER 5: DATA                                                     │
│  ─────────────                                                     │
│  Encryption, Access controls, DLP                                  │
│  → Stops: Data theft, unauthorized access                         │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘

KEY PRINCIPLE:
If one layer fails, the next layer catches the attack
No single point of failure
```

**Real-world application:**

| Attack Scenario | Layer 1 Fails | Layer 2 Catches |
|-----------------|---------------|-----------------|
| Phishing email | Perimeter allows legitimate email | EDR blocks malware execution |
| Stolen VPN creds | User authenticates successfully | Segmentation limits access |
| Zero-day exploit | WAF doesn't recognize attack | Endpoint isolation contains it |
| Insider threat | Trusted user bypasses perimeter | DLP prevents data exfiltration |

### Network Segmentation

**Dividing the network:**

```
SEGMENTATION CONCEPT:

FLAT NETWORK (BAD):
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  [HR] ←→ [Finance] ←→ [Engineering] ←→ [Servers] ←→ [IoT]         │
│                                                                     │
│  ALL DEVICES CAN TALK TO ALL OTHER DEVICES                         │
│  Attacker compromises one → accesses everything                    │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘

SEGMENTED NETWORK (GOOD):
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  [HR Zone]              [Finance Zone]          [Server Zone]      │
│  ┌──────────┐           ┌──────────┐           ┌──────────┐        │
│  │ HR PCs   │           │Finance PC│           │ Web      │        │
│  │ HR Apps  │           │Fin Apps  │           │ DB       │        │
│  └────┬─────┘           └────┬─────┘           └────┬─────┘        │
│       │                      │                      │              │
│       └──────────[FW]────────┴──────────[FW]───────┘              │
│                                                                     │
│  ONLY NECESSARY TRAFFIC ALLOWED BETWEEN ZONES                      │
│  Attacker in HR zone cannot reach database                         │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

**Segmentation strategies:**

| Strategy | Implementation | Use Case |
|----------|---------------|----------|
| **VLAN** | Layer 2 separation | Basic segmentation |
| **Subnet** | Layer 3 separation | IP-based control |
| **Firewall zones** | ACL between segments | Traffic filtering |
| **Micro-segmentation** | Per-workload policies | Cloud/datacenter |
| **Air gap** | Physical separation | Critical systems |

### Least Privilege (Network)

**Minimal access principle:**

```
LEAST PRIVILEGE AT NETWORK LAYER:

DEFAULT DENY:
─────────────────────────────
Rule 0: DENY ALL
(Then add specific allows)

vs

DEFAULT ALLOW (BAD):
Rule 0: ALLOW ALL
(Then add specific denies)

PRACTICAL APPLICATION:

Web Server needs:
- Inbound 80, 443 from internet → ALLOW
- Outbound 3306 to database → ALLOW
- Everything else → DENY

Database Server needs:
- Inbound 3306 from web servers only → ALLOW
- Outbound NTP (time sync) → ALLOW
- Everything else → DENY

PRINCIPLE:
Open only what's necessary
Document every exception
Review regularly
```

### Zero Trust Architecture

**Core principles:**

```
ZERO TRUST PILLARS:

1. VERIFY EXPLICITLY
   ─────────────────────────────
   Every access request is authenticated and authorized
   Based on all available data points:
   - User identity
   - Device health
   - Location
   - Resource sensitivity
   - Anomalies

2. USE LEAST PRIVILEGE ACCESS
   ─────────────────────────────
   Just-in-time (JIT) access
   Just-enough-access (JEA)
   Risk-based adaptive policies
   
3. ASSUME BREACH
   ─────────────────────────────
   Minimize blast radius
   Segment access
   Verify end-to-end encryption
   Use analytics for threat detection

ZERO TRUST IMPLEMENTATION:
─────────────────────────────

Traditional: User → VPN → Full network access

Zero Trust: User → Identity verification
                → Device posture check
                → Application-specific access
                → Continuous verification
                → Logging and analytics
```

### Control Categories

**Types of security controls:**

```
CONTROL CATEGORIES:

PREVENTIVE:
─────────────────────────────
Stop attacks before they happen
- Firewall blocks malicious traffic
- Access controls prevent unauthorized entry
- Patching removes vulnerabilities

DETECTIVE:
─────────────────────────────
Identify attacks in progress or after
- IDS/IPS detects suspicious traffic
- SIEM correlates events
- Log analysis reveals anomalies

CORRECTIVE:
─────────────────────────────
Respond to and fix after detection
- Incident response
- System restoration
- Patching exploited vulnerabilities

DETERRENT:
─────────────────────────────
Discourage attackers from trying
- Warning banners
- Visible security measures
- Legal consequences

COMPENSATING:
─────────────────────────────
Alternative when primary control isn't feasible
- Network monitoring when can't patch legacy system
- Enhanced logging when can't implement MFA
```

---

## 3. Guided Practice

### Exercise 1: Defense in Depth Design

Design layered defenses for a database server:

| Layer | Control | What it Stops |
|-------|---------|--------------|
| Perimeter | ___ | ___ |
| Network | ___ | ___ |
| Endpoint | ___ | ___ |
| Application | ___ | ___ |
| Data | ___ | ___ |

### Exercise 2: Segmentation Planning

Your network has:
- User workstations (500)
- Servers (50)
- IoT devices (100)
- Guest Wi-Fi users

Design zones and what traffic flows between them:

| Zone | Devices | Can Access | Cannot Access |
|------|---------|------------|---------------|
| ___ | ___ | ___ | ___ |
| ___ | ___ | ___ | ___ |
| ___ | ___ | ___ | ___ |
| ___ | ___ | ___ | ___ |

### Exercise 3: Zero Trust Evaluation

Current state: VPN gives full internal network access

Design Zero Trust alternative:

1. How would user authenticate? ___
2. How would device be verified? ___
3. How would application access work? ___
4. What's logged? ___

---

## 4. Reflection Check

### Philosophy Understanding
1. Why isn't a strong perimeter firewall enough?

2. An attacker got through your firewall. Which layer catches them next?

3. Zero Trust says "assume breach." How does this change your architecture?

### Practical Application
1. A legacy system can't be patched. What compensating controls apply?

2. Users complain Zero Trust is "too many passwords." How do you respond?

3. You have budget for one control. Preventive or detective? Why?

---

## 5. Key Misconceptions

**MYTH: "Firewalls are the main defense"**
REALITY: Firewalls are one layer. Defense in Depth requires multiple independent controls.

**MYTH: "Internal network is trusted"**
REALITY: Insiders, compromised devices, and phishing mean internal networks are hostile. Trust nothing.

**MYTH: "More security = less usability"**
REALITY: Well-designed Zero Trust can improve usability (SSO, passwordless) while increasing security.

**MYTH: "We're too small to be targeted"**
REALITY: Automated attacks hit everyone. Attackers use small organizations to reach larger targets.

**MYTH: "Security is IT's job"**
REALITY: Security is everyone's responsibility. Technical controls can't stop human-layer attacks.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Explain** Defense in Depth with concrete examples
2. **Design** network segmentation for a given scenario
3. **Compare** castle model vs Zero Trust
4. **Apply** Least Privilege to network access
5. **Categorize** controls as preventive, detective, or corrective

---

## 7. Further Depth (Optional)

*   **Framework:** NIST Zero Trust Architecture (SP 800-207)
*   **Practice:** Segment a home lab network
*   **Research:** Google BeyondCorp case study
*   **Tool:** Explore micro-segmentation platforms
