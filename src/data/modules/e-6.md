# Information Gathering Principles

## 1. Orientation

### What this module covers
This module introduces reconnaissance—the systematic collection of information about targets before actual testing begins. We distinguish between passive reconnaissance (invisible to the target) and active reconnaissance (potentially detectable), and establish the philosophy that thorough recon is the foundation of successful testing.

### Fit in the Learning Path
You cannot hit what you cannot see. Information gathering often determines 90% of an engagement's success. If you do reconnaissance well, exploitation becomes straightforward; if you skip it, you miss obvious entry points and waste time.

### Learning Objectives
By the end of this module, you will:
*   Distinguish between passive and active reconnaissance
*   Understand the risk profile of different information gathering techniques
*   Apply the doctrine of "exhaust passive before going active"
*   Recognize what constitutes useful intelligence

---

## 2. Core Content

### Mental Model: The Reconnaissance Pyramid

**How professionals think about this:**
Information gathering is layered. Start with the widest, lowest-risk sources and progressively narrow toward higher-risk, more targeted collection. The goal: maximum intelligence with minimum detection.

```
THE RECON PYRAMID:

                         ▲
                        /│\
                       / │ \   ACTIVE SCANNING
                      /  │  \  High risk, high detail
                     /   │   \ Port scans, vulnerability scans
                    /    │    \
                   /─────┼─────\
                  /      │      \
                 /  SEMI-ACTIVE   \
                /   Visiting site  \
               /    Connecting to   \
              /     public services  \
             /───────────┼───────────\
            /            │            \
           /    PASSIVE COLLECTION     \
          /   OSINT, public records,    \
         /    search engines, social     \
        /     media, DNS lookups          \
       /──────────────┼──────────────────\
      /               │                   \
     /                │                    \
    ────────────────────────────────────────
    
    RISK    LOW ◄─────────────────────► HIGH
    DETAIL  LOW ◄─────────────────────► HIGH
```

### Passive Reconnaissance

**Definition:**
Collecting information WITHOUT sending packets to the target's infrastructure. The target cannot detect that you're researching them.

**Data sources:**

| Source | Information Available | Tool Examples |
|--------|----------------------|---------------|
| **Search Engines** | Cached pages, indexed files, site structure | Google dorks, Bing, Yandex |
| **DNS Records** | Subdomains, mail servers, hosting info | dig, nslookup, DNSDumpster |
| **WHOIS** | Registration info, contacts, nameservers | whois command, online tools |
| **Social Media** | Employees, org structure, technologies used | LinkedIn, Twitter, Facebook |
| **Job Postings** | Technology stack, internal processes | Indeed, LinkedIn, company careers |
| **SEC Filings** | Financial info, acquisitions, risks | SEC EDGAR |
| **Code Repositories** | Source code, credentials, API keys | GitHub, GitLab, Bitbucket |
| **Historical Data** | Past versions of sites, removed content | Wayback Machine |
| **Certificate Transparency** | Subdomains from SSL certificates | crt.sh, Censys |
| **Internet-wide Scans** | Service banners, open ports | Shodan, Censys, BinaryEdge |

**Why passive first:**
```
PASSIVE RECON ADVANTAGES:

┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  1. ZERO FOOTPRINT                                                  │
│     Your source IP never touches target infrastructure              │
│     No logs, no alerts, no detection                                │
│                                                                     │
│  2. LEGAL SAFETY                                                    │
│     Using search engines and public records is not illegal          │
│     Can be done before formal authorization in many cases           │
│                                                                     │
│  3. PERSISTENT DATA                                                 │
│     Historical data reveals what targets tried to hide              │
│     Cached pages may show removed sensitive content                 │
│                                                                     │
│  4. BROAD COVERAGE                                                  │
│     Mass data from internet-wide scans                              │
│     Information target might not know is public                     │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### Active Reconnaissance

**Definition:**
Directly interacting with target systems. Your IP address is logged; intrusion detection systems may fire; defenders may notice.

**Types of active recon:**

| Activity | Detection Risk | Information Gained |
|----------|---------------|-------------------|
| **Port Scanning** | Medium-High | Open services |
| **Service Fingerprinting** | Medium | Service versions |
| **Web Crawling** | Low-Medium | Site structure |
| **Banner Grabbing** | Medium | Service details |
| **Vulnerability Scanning** | High | Specific weaknesses |
| **Directory Bruteforcing** | High | Hidden paths |

**The "Touching the Glass" Metaphor:**
```
MUSEUM HEIST ANALOGY:

┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  PASSIVE RECON                          ACTIVE RECON                │
│  ─────────────────────                  ─────────────────────       │
│                                                                     │
│  • Reading museum brochure              • Shaking the window        │
│  • Google Maps for exits                • Testing door locks        │
│  • Employee LinkedIn profiles           • Walking inside            │
│  • Public architectural plans           • Talking to guards         │
│                                                                     │
│  Detection risk: ZERO                   Detection risk: HIGH        │
│  "Just a curious tourist"               "Why are you here?"         │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### The Gray Area: Semi-Active

**Some activities are between passive and active:**

| Activity | Classification | Why |
|----------|---------------|-----|
| **Visiting website normally** | Semi-active | Your IP is logged, but looks like normal traffic |
| **DNS resolution of target domain** | Borderline passive | Query goes to their nameserver, but looks normal |
| **Viewing SSL certificate** | Semi-active | Connecting to port 443, but standard behavior |
| **Public API usage** | Semi-active | Intended use, but can be rate-limited/logged |

### What Makes Good Intelligence

**The intelligence value hierarchy:**

```
INTELLIGENCE VALUE:

HIGH VALUE:
├── Credentials (passwords, API keys, tokens)
├── Network architecture diagrams
├── Internal hostnames/IP ranges
├── Technology versions with known CVEs
├── Employee names + email format
└── Security tool deployment info

MEDIUM VALUE:
├── Technology stack (web server, CMS, frameworks)
├── Email addresses
├── Organizational structure
├── Business processes
└── Third-party relationships

LOW VALUE (but aggregates matter):
├── General company information
├── Public press releases
├── Generic marketing content
└── Publicly known partnerships
```

### The Recon Workflow

**Systematic approach:**

```
RECON WORKFLOW:

1. DEFINE OBJECTIVES
   └── What do I need to know to proceed?
       • External IPs/domains in scope
       • Technologies in use
       • Employee targets for social engineering
       • Historical vulnerabilities

2. PASSIVE COLLECTION (Days/Weeks for red team)
   ├── Domain enumeration
   │   └── DNS records, subdomains, certificates
   ├── Company research
   │   └── LinkedIn, job postings, press releases
   ├── Technology identification
   │   └── Wappalyzer, Shodan, BuiltWith
   └── Data leaks
       └── Breach databases, paste sites, code repos

3. ORGANIZE AND ANALYZE
   ├── Deduplicate findings
   ├── Verify accuracy
   ├── Identify high-value targets
   └── Build target list for active phase

4. ACTIVE RECONNAISSANCE (When authorized)
   ├── Validate passive findings
   ├── Port scanning (controlled)
   ├── Service enumeration
   └── Web application mapping

5. DOCUMENT AND ITERATE
   ├── Record all findings systematically
   ├── New information leads to new questions
   └── Refine targeting based on discoveries
```

### OPSEC: Protecting Yourself

**Even during recon, protect your identity:**

| Risk | Mitigation |
|------|------------|
| IP exposure | VPN, proxies, Tor (for passive) |
| Browser fingerprinting | Dedicated browser profile, VM |
| Account association | Burner accounts, no personal links |
| Pattern detection | Vary timing, sources, queries |
| Log correlation | Assume everything is logged |

---

## 3. Guided Practice

### Exercise 1: Passive vs Active Classification

Classify each action:

| Action | Passive/Active/Semi-Active |
|--------|---------------------------|
| Google search: site:target.com | ___ |
| nmap -sS target.com | ___ |
| Reading target's blog | ___ |
| Using Shodan to find target's services | ___ |
| Running nikto against web server | ___ |
| Checking Wayback Machine for old pages | ___ |
| Brute-forcing directories with gobuster | ___ |
| Looking up target on LinkedIn | ___ |
| Connecting to target's SSH to grab banner | ___ |

### Exercise 2: Intelligence Assessment

For a web application pentest, rate these findings:

| Finding | Value (H/M/L) | Why |
|---------|--------------|-----|
| Company uses WordPress 5.4.1 | ___ | ___ |
| Admin email found: admin@target.com | ___ | ___ |
| AWS access key in public GitHub repo | ___ | ___ |
| CEO's name and birthday | ___ | ___ |
| Internal domain naming convention | ___ | ___ |

### Exercise 3: Recon Planning

You're authorized to test company.com. Plan your recon:

**Passive phase (list 5 activities):**
1. ___
2. ___
3. ___
4. ___
5. ___

**Active phase (list 5 activities):**
1. ___
2. ___
3. ___
4. ___
5. ___

---

## 4. Reflection Check

### Philosophical Understanding
1. Why do red teams spend weeks on passive recon before a single active packet?

2. You found the target's website at www.company.com. Is visiting it "active reconnaissance"?

3. A client says, "Just start scanning, we don't have time for recon." Why is this problematic?

### Practical Application
1. You're doing passive recon and find an AWS S3 bucket with company data. Can you access it?

2. During recon, you discover the target is also using a cloud service you use for personal projects. What's the concern?

3. You find credentials in a public GitHub repo. What do you do with this information?

---

## 5. Key Misconceptions

**MYTH: "Passive recon doesn't provide useful information"**
REALITY: Passive recon often reveals credentials, architecture, and vulnerabilities before you send a single packet.

**MYTH: "Looking at their website is passive"**
REALITY: Your IP is logged on their web server. It's "semi-active"—low risk but not invisible.

**MYTH: "Shodan is active scanning"**
REALITY: Shodan's scans are from their IP, not yours. Querying Shodan is passive collection of data they already have.

**MYTH: "More recon is always better"**
REALITY: Recon has diminishing returns. At some point, you have enough to proceed. Paralysis is a risk.

**MYTH: "VPN makes you anonymous"**
REALITY: VPN hides your IP but not your behavior patterns. DNS leaks, browser fingerprints, and correlation attacks still apply.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Classify** reconnaissance activities as passive, active, or semi-active
2. **Explain** the risk/reward tradeoffs of each type
3. **Apply** the "exhaust passive before active" doctrine
4. **Identify** high-value intelligence targets
5. **Plan** a systematic reconnaissance workflow

---

## 7. Further Depth (Optional)

*   **Practice:** Do complete passive recon on a bug bounty target (within scope)
*   **Tools:** Learn specialized OSINT tools (theHarvester, Maltego, Recon-ng)
*   **Technique:** Study Google dorking in depth
*   **Research:** Investigate how breach databases are used in reconnaissance
