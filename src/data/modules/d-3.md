# Prevention vs Detection vs Response

## 1. Orientation

### What this module covers
This module examines the three pillars of defensive security: Prevention (stop attacks), Detection (see attacks), and Response (handle attacks). Understanding the relationship between these pillars is essential—organizations that over-invest in any one pillar while neglecting others create exploitable gaps.

### Fit in the Learning Path
The security industry spent decades believing prevention was sufficient. Modern threats prove this false. This module establishes the balanced defensive model that underlies all subsequent security operations content.

### Learning Objectives
By the end of this module, you will:
*   Understand the role and limitations of each defensive pillar
*   Balance investment across prevention, detection, and response
*   Recognize the "assume breach" mindset and its implications
*   Apply key metrics (MTTD, MTTR) for measuring defensive effectiveness

---

## 2. Core Content

### Mental Model: The Castle Defense

**How professionals think about this:**
A castle with only walls (prevention) falls when any single wall is breached. A castle with walls, sentries (detection), and a response force provides resilient defense. Modern security requires all three.

```
DEFENSIVE PILLARS:

┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│                          THE ATTACK                                 │
│                              │                                      │
│                              ▼                                      │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │              PREVENTION (The Wall)                          │   │
│  │                                                             │   │
│  │  Purpose: Stop attacks before execution                     │   │
│  │  Tools: Firewalls, AV, MFA, Patching                       │   │
│  │  Limit: Cannot stop everything (zero-days, valid creds)    │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                              │                                      │
│                          (Breach)                                   │
│                              ▼                                      │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │              DETECTION (The Camera)                         │   │
│  │                                                             │   │
│  │  Purpose: See attacks that bypass prevention                │   │
│  │  Tools: SIEM, EDR, NDR, Behavior analytics                 │   │
│  │  Metric: MTTD (Mean Time to Detect)                        │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                              │                                      │
│                          (Alert)                                    │
│                              ▼                                      │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │              RESPONSE (The Guard)                           │   │
│  │                                                             │   │
│  │  Purpose: Contain and eradicate threats                     │   │
│  │  Tools: IR playbooks, Containment, Forensics               │   │
│  │  Metric: MTTR (Mean Time to Respond)                       │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### Prevention: The First Line

**Purpose:**
Stop attacks before they execute. Reduce the attack surface and block known threats.

**Prevention technologies:**

| Category | Tools | Blocks |
|----------|-------|--------|
| **Network** | Firewall, WAF, IPS | Network attacks, known malicious traffic |
| **Endpoint** | Antivirus, EDR (prevention mode) | Known malware, some behaviors |
| **Identity** | MFA, Password policies | Credential-based attacks |
| **Application** | Input validation, CSP | Injection, XSS |
| **Configuration** | Hardening, Least privilege | Misuse, privilege escalation |
| **Patching** | Vulnerability management | Known exploits |

**Why prevention fails:**

```
PREVENTION FAILURE MODES:

1. ZERO-DAY VULNERABILITIES
   └── No signature exists for unknown attacks

2. VALID CREDENTIALS
   └── Attacker with stolen password looks like user

3. SOPHISTICATED EVASION
   └── Attackers modify malware to bypass detection

4. CONFIGURATION ERRORS
   └── Misconfigured firewall rules allow traffic

5. INSIDER THREATS
   └── Authorized user acts maliciously

6. SOCIAL ENGINEERING
   └── Human bypasses technical controls
```

### Detection: The Safety Net

**Purpose:**
See attacks that bypass prevention. Reduce time attackers operate undetected (dwell time).

**Detection approaches:**

| Type | Mechanism | Strengths | Weaknesses |
|------|-----------|-----------|------------|
| **Signature** | Match known patterns | Fast, precise | Misses unknowns |
| **Behavioral** | Detect anomalous actions | Catches novelty | False positives |
| **Anomaly** | Deviation from baseline | Detects insiders | Needs training period |

**Detection technologies:**

| Tool | Visibility |
|------|-----------|
| **SIEM** | Aggregate logs, correlate across sources |
| **EDR** | Endpoint behaviors, process trees |
| **NDR** | Network traffic patterns |
| **UEBA** | User behavior deviations |
| **CASB** | Cloud application activity |

**The MTTD metric:**
```
MTTD = Mean Time to Detect

Industry average: 197 days (Mandiant 2023)
Best performers: < 24 hours

Lower MTTD = Less damage
Every minute undetected = More attacker actions
```

### Response: Handling the Inevitable

**Purpose:**
Contain, eradicate, and recover from confirmed incidents. Minimize impact.

**Response phases:**

```
INCIDENT RESPONSE LIFECYCLE (NIST):

1. PREPARATION
   └── Plans, playbooks, tools ready before incident

2. IDENTIFICATION
   └── Confirm alert is true positive
   └── Determine scope and severity

3. CONTAINMENT
   ├── Short-term: Isolate affected hosts
   └── Long-term: Segment network, reset credentials

4. ERADICATION
   └── Remove attacker access
   └── Eliminate malware, backdoors

5. RECOVERY
   └── Restore systems to operation
   └── Verify clean state

6. LESSONS LEARNED
   └── Post-incident review
   └── Detection/prevention improvements
```

**The MTTR metric:**
```
MTTR = Mean Time to Respond

Time from detection to containment
Faster containment = Less damage

Components:
- Time to triage alert
- Time to confirm incident
- Time to execute containment
- Time to eradicate threat
```

### The Balance Problem

**Over-investment patterns:**

| Imbalance | Symptom | Result |
|-----------|---------|--------|
| **All prevention** | "Eggshell security" | Hard shell, soft inside. Once breached, attacker moves freely |
| **All detection** | Alert flood | Drowning in alerts, can't respond to any |
| **Weak response** | Detection without action | Know you're compromised, can't do anything |

**The assume breach mindset:**
```
OLD MODEL:
  "With enough prevention, we won't be breached"
  Reality: False confidence, devastating when breached

NEW MODEL:
  "We will be breached. How fast do we detect and respond?"
  Reality: Realistic, resilient, measurable improvement
```

### Investment Framework

**Balanced allocation:**

```
SECURITY INVESTMENT BY PILLAR:

Immature organization (just starting):
├── Prevention: 70%
├── Detection: 20%
└── Response: 10%

Maturing organization:
├── Prevention: 50%
├── Detection: 35%
└── Response: 15%

Mature organization:
├── Prevention: 40%
├── Detection: 40%
└── Response: 20%

The trend: Shift from prevention to detection/response
as you realize prevention cannot stop everything.
```

### Measuring Effectiveness

**Key metrics:**

| Metric | Definition | Target |
|--------|-----------|--------|
| **MTTD** | Mean Time to Detect | < 24 hours |
| **MTTR** | Mean Time to Respond | < 4 hours |
| **Dwell Time** | Total time attacker on network | < 24 hours |
| **Alert-to-Ticket** | Time to create incident from alert | < 15 minutes |
| **False Positive Rate** | Alerts that aren't real | < 30% |

**The relationship:**
```
DWELL TIME = MTTD + MTTR

If MTTD = 100 days and MTTR = 7 days
Dwell Time = 107 days of attacker activity

If MTTD = 2 hours and MTTR = 2 hours
Dwell Time = 4 hours

Reducing either metric reduces damage.
```

### Prevention vs Detection Trade-offs

| Prevention | Detection |
|------------|-----------|
| Stops attack before damage | Sees attack during/after |
| May block legitimate activity | Allows activity, monitors it |
| Requires knowing attack signature | Can find unknown behaviors |
| Inline (blocks traffic) | Passive (observes traffic) |
| User-impacting if wrong | Alert-generating if wrong |
| Cannot catch valid credentials | Can catch anomalous credential use |

---

## 3. Guided Practice

### Exercise 1: Tool Classification

Categorize each tool:

| Tool | Prevention/Detection/Response |
|------|------------------------------|
| Firewall rule blocking port | ___ |
| SIEM correlation alert | ___ |
| Isolating infected host | ___ |
| Patch for CVE-2021-44228 | ___ |
| EDR behavioral alert | ___ |
| Password complexity requirement | ___ |
| Memory forensics toolkit | ___ |
| WAF blocking SQL injection | ___ |

### Exercise 2: Scenario Analysis

An attacker phishes credentials, logs in with MFA bypass, and exfiltrates data over 60 days.

Answer:
1. Which prevention controls failed? ___
2. Which detection could have caught this? ___
3. What response actions would minimize damage? ___

### Exercise 3: Metric Calculation

Your organization detected a breach on Day 180. Containment was achieved on Day 187.

Calculate:
- MTTD: ___
- MTTR: ___
- Dwell Time: ___

If detection improved to Day 7, what would the new Dwell Time be (assuming same MTTR)? ___

---

## 4. Reflection Check

### Understanding the Pillars
1. Why can't organizations just focus on "stopping everything before it happens"?

2. An organization has excellent EDR with behavioral detection. Why do they still need firewalls?

3. What happens if you have great detection but poor response capability?

### Operational Thinking
1. You reduce MTTD from 200 days to 20 days. What business impact does this have?

2. Alert fatigue causes analysts to ignore low-severity alerts. One of them is real. Which pillar failed?

3. Your MTTR is 24 hours because containment requires change management approval. What needs to change?

---

## 5. Key Misconceptions

**MYTH: "If we have enough firewalls and AV, we don't need detection"**
REALITY: Prevention fails against zero-days, phishing, and credential theft. Detection catches what prevention misses.

**MYTH: "Detection = having logs"**
REALITY: Logs without analysis are useless. Detection requires correlation, rules, and human review.

**MYTH: "Response is just an afterthought"**
REALITY: Fast response dramatically reduces impact. A compromised host isolated in 1 hour vs 100 days is vastly different.

**MYTH: "More alerts = better detection"**
REALITY: Alert fatigue degrades security. Quality detection means high-fidelity alerts that matter.

**MYTH: "Assume breach means giving up on prevention"**
REALITY: Assume breach means balancing prevention with detection/response. Prevention still reduces attack volume.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Categorize** security tools into prevention, detection, or response
2. **Explain** why each pillar is necessary and insufficient alone
3. **Apply** the assume breach mindset to security planning
4. **Calculate** and interpret MTTD and MTTR metrics
5. **Recommend** balanced investment across all three pillars

---

## 7. Further Depth (Optional)

*   **Reading:** NIST Cybersecurity Framework for balanced approach
*   **Research:** Mandiant M-Trends report for industry dwell time data
*   **Practice:** Audit an organization's tooling by pillar
*   **Framework:** Study the Lockheed Martin Cyber Kill Chain for detection points
