# Tracking C2 Infrastructure

## 1. Orientation

### What this module covers
Command & Control (C2) servers are the lifeline of an ongoing attack. Tracking them *before* they are used is the holy grail. This module covers **JARM Fingerprinting**, **Censys Scanning**, and **Pivot Hunting**.

### Learning Objectives
*   Understand **C2 Frameworks** (Cobalt Strike, Sliver, Mythic).
*   Use **JARM** and **JA3** hashes to identify servers.
*   Hunt for C2s using **Censys** and **Shodan**.

---

## 2. Core Content

### The C2 Landscape
Attackers buy servers (VPS). They install a C2 Framework (e.g., Cobalt Strike).
*   **Default Configs:** Lazy attackers leave default SSL certs or default ports (50050).
*   **Fingerprinting:** We can scan the *entire internet* for port 50050 or specific SSL parameters.

### Fingerprinting Methods
1.  **JARM (Server-Side TLS):** Active scan. "Hello, server. How do you do crypto?" The server's response creates a unique hash.
    *   *Cobalt Strike Default:* `07d14d...` (Known bad).
2.  **JA3 (Client-Side TLS):** Passive. "Hello, server. I am a client." The *client's* Hello packet creates a hash. Good for identifying malware *beacons* leaving your network.

### Tracking with Censys/Shodan
*   **Query:** search for JARM hashes of known C2s.
*   **Result:** A list of 500 IPs that are *likely* Cobalt Strike Team Servers.
*   **Action:** Feed into your blocklist (Risk: False Positives).

---

## 3. Lab: Hunting Team Servers
1.  **Intel:** "Cobalt Strike 4.5 Default JARM is X".
2.  **Shodan:** `ssl.jarm:X org:"DigitalOcean"`.
3.  **Result:** 50 IPs.
4.  **Validation:** Check if they serve the default "Not Found" 404 page with specific byte size.

---

## 4. Completion Criteria
1.  **Define** "JARM" (Server TLS fingerprint).
2.  **Differentiate** JARM vs JA3.
