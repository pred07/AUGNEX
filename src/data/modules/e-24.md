# Authentication Attacks and Logic Flaws

## 1. Unit Brief: Breaking the Front Door
If you can't bypass authentication, maybe you can break it. This involves brute-forcing, logic flaws in password resets, and bypassing MFA.

## 2. Real-World Relevance
*   **Logic Flaw**: The "Verify OTP" step checks if `otp_correct == true`, but the "Send OTP" step sets `otp_correct = true` by default. Skipping the verify step logs you in.

## 3. Core Concepts

### Account Lockout
Does the site block you after 5 failed attempts?
*   Yes: Brute force is impossible.
*   No: Fire up Hydra.

### Username Enumeration
*   `Login failed` vs `User not found`.
*   If only the message changes, I can harvest a list of valid usernames.

### Logic Flaws
*   **Response Manipulation**: Intercepting a `{"status": "fail"}` response from the server and changing it to `{"status": "success"}` in Burp Suite before the browser sees it.

## 4. Practical Examples

### Password Reset Poisoning
1.  Request reset for `victim@target.com`.
2.  Intercept request.
3.  Change `Host` header to `attacker.com`.
4.  Server generates email: "Click here to reset: http://attacker.com/token=123"
5.  Victim clicks link. Attacker gets the token.

### 2FA Bypass (Force Browsing)
1.  Login with user/pass.
2.  Redirected to `/2fa`.
3.  Manually change URL to `/dashboard`.
4.  If the server only checked auth on the login page and not the dashboard, you are in.

## 5. Common Mistakes Beginners Make
*   **Loud Brute Force**: Triggering alarms instantly. Use "Password Spraying" (One password, many users) instead of Brute Force (Many passwords, one user).
*   **Ignoring HTTP Status**: Sometimes a 302 Redirect means "Login Success" even if it redirects to "Login Failed".

## 6. Key Takeaways
*   **Logic > Tools**: Tools can't find logic flaws. You have to think.
*   **Process**: Map every step of the login. Where is the check performed?
