# Baseline Network Behavior

## 1. Unit Brief: Knowing "Normal"
To spot the anomaly, you must know the baseline. What amount of traffic is normal? Which countries do we talk to? When do backups run?

## 2. Real-World Relevance
*   **Alert**: "High Bandwidth Usage (2AM)".
*   **Analyst w/o Baseline**: "Panic! Data Exfiltration!"
*   **Analyst w/ Baseline**: "Oh, that's the nightly backup to AWS. It happens every Tuesday."

## 3. Core Concepts

### Traffic patterns
*   **North-South**: Internet <-> Internal.
*   **East-West**: Server <-> Server.

### Volume Analysis
*   "Average HTTP requests per second: 50".
*   "Current Peak: 5000". -> DDoS.

### Protocol Analysis
*   "We only use TCP/443 and TCP/53".
*   "Why is there UDP/12300?" -> Malware C2.

## 4. Practical Examples

### RITA (Real Intelligence Threat Analytics)
Tool for analyzing Bro/Zeek logs to find beacons.
*   It calculates the "variance" of connection times.
*   **Score 0**: Highly random (Human browsing).
*   **Score 1**: Highly periodic (Automated Beacon).

### Visualizing with Kibana
Plotting "Bytes Transferred by Destination IP".
*   You see a huge bar for an IP in China.
*   You check the Baseline: "We have no customers in China."
*   **Action**: Investigate.

## 5. Common Mistakes Beginners Make
*   **Ignoring Seasonality**: "Traffic is low on Saturday." (Because it's the weekend). Compare Saturday to last Saturday, not to Friday.
*   **Assuming Static Baselines**: Networks change. New apps deploy. Baselines must be updated.

## 6. Key Takeaways
*   **Deviations**: Security is the art of spotting deviations from the norm.
*   **Context**: Data without context is noise.
