# Purple Teaming Explained

## 1. Orientation

### What this module covers
This module defines **purple teaming** as a fundamental shift in how offensive and defensive security collaborate. You will understand why the traditional adversarial model between red and blue teams fails to maximize security improvement, and how purple teaming creates a continuous feedback loop that systematically eliminates detection gaps.

### Fit in the Learning Path
This is the **first module** of the CONVERGENCE path. Purple teaming represents the integration of offensive and defensive knowledge—you are no longer purely attacker or defender, but someone who understands both perspectives and uses that understanding to engineer better security outcomes.

### Learning Objectives
By the end of this module, you will:
*   Distinguish purple teaming from traditional red/blue team exercises
*   Understand the feedback loop that drives detection improvement
*   Recognize the cultural challenges that prevent effective purple teaming
*   Apply purple team methodology to validate and improve security controls

---

## 2. Core Content

### Mental Model: From Adversaries to Partners

**Traditional model (broken):**
```
Red Team ──→ "We pwned you" ──→ Report ──→ Blue Team feels bad ──→ Patch one thing
                                                                    ↓
                                                              (Nothing learned)
```

**Purple team model (effective):**
```
Red Team ←══════════════════════════════════════════════════════→ Blue Team
               │                                           │
               │     "I'm running technique X"             │
               │     "I don't see it"                      │
               │     "Let me adjust and rerun"             │
               │     "Now I detect it!"                    │
               │                                           │
               ↓                                           ↓
         New TTP documented                    New detection deployed
```

**How professionals think about this:**
Red teams exist to improve security, not to prove superiority. Blue teams exist to detect threats, not to defend their ego. Purple teaming removes the adversarial dynamic and replaces it with collaborative engineering.

### Why Traditional Red/Blue Fails

**The incentive problem:**
- Red teams are incentivized to "win" (achieve objectives, write impressive reports)
- Blue teams are incentivized to "not lose" (minimize embarrassing findings)
- Neither is incentivized to maximize organizational learning

**The information asymmetry problem:**
- Red teams complete their engagement, deliver a report, and leave
- Blue teams receive findings weeks later with minimal context
- No real-time feedback means no real-time learning

**The ego problem:**
- Red teams want to look skilled (finding vulnerabilities)
- Blue teams want to look competent (not having vulnerabilities)
- This creates an adversarial relationship that impedes collaboration

### Purple Team Principles

#### 1. Transparency Over Secrecy
In traditional red teaming, stealth is valued. In purple teaming, transparency is valued.

**Purple team approach:**
- "I'm about to execute technique T1003 (LSASS dumping) on WORKSTATION-42"
- "Let me know when you're ready, then I'll execute"
- "What did you see? What did you miss?"

**Why this works:** The goal isn't to test whether blue team is awake—it's to systematically validate detection capabilities.

#### 2. Iteration Over Reports
Purple teaming is a continuous process, not a point-in-time assessment.

**Traditional:** Annual pentest → Report → Remediation → Wait for next year
**Purple:** Weekly/daily exercises → Immediate feedback → Detection improvement → Repeat

#### 3. Detection Coverage as the Metric
Success isn't measured in vulnerabilities found or objectives achieved. Success is measured in detection coverage across the ATT&CK matrix.

```
Before Purple Exercise: 23% technique coverage
After Purple Exercise:  47% technique coverage
After 10 Exercises:     78% technique coverage
```

#### 4. Engineering Follow-Through
Purple teaming isn't just about identifying gaps—it's about closing them:

```
Gap Identified → Detection Rule Written → Rule Validated → Rule Deployed → Gap Closed
```

### The Purple Team Exercise Workflow

**Phase 1: Planning**
- Select MITRE ATT&CK techniques to test
- Identify target systems and network segments
- Coordinate timing with SOC and relevant teams
- Prepare rollback procedures

**Phase 2: Execution**
- Red team announces technique before execution
- Red team executes the technique
- Blue team observes telemetry in real-time
- Both teams document what was detected/missed

**Phase 3: Analysis**
- If detected: Document the detection chain (what telemetry, what rule, what alert)
- If missed: Analyze why (missing logs? Missing rule? Rule too specific?)
- Identify the minimum viable detection improvement

**Phase 4: Engineering**
- Develop new detection rules or tune existing ones
- Validate detection with re-execution
- Deploy to production after testing
- Update documentation and runbooks

**Phase 5: Regression Testing**
- Re-test periodically to ensure detection persists
- Update as techniques evolve

### Example: LSASS Credential Dumping

**Objective:** Validate detection of credential dumping from LSASS

**Technique variations to test:**
1. `procdump.exe lsass.exe` (most common)
2. `comsvcs.dll MiniDump` (Living off the Land)
3. `mimikatz sekurlsa::logonpasswords` (direct memory access)
4. `nanodump` (EDR evasion technique)
5. Task Manager → Create Dump File (GUI method)

**Expected telemetry:**
- Process creation events (parent/child relationships)
- Handle requests to LSASS
- Memory access patterns
- File write operations to dump location

**Sample detection rule (Sigma format):**
```yaml
title: LSASS Memory Dump via Comsvcs.dll
status: experimental
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        CommandLine|contains:
            - 'comsvcs.dll'
            - '#24'
            - 'MiniDump'
    condition: selection
```

**Purple session outcome:**
- Technique 1: Detected by EDR ✓
- Technique 2: **NOT DETECTED** → Created Sigma rule
- Technique 3: Blocked by credential guard ✓
- Technique 4: **NOT DETECTED** → Research needed
- Technique 5: **NOT DETECTED** → Added monitoring for taskmgr.exe

### Overcoming Cultural Barriers

**Barrier: "Red team wants to keep techniques secret"**
→ Solution: Remind them they're measured on organizational improvement, not personal achievement

**Barrier: "Blue team gets defensive about gaps"**
→ Solution: Frame gaps as normal and expected—the goal is continuous improvement

**Barrier: "Leadership wants a pass/fail grade"**
→ Solution: Educate on detection coverage metrics as the meaningful measurement

**Barrier: "We don't have time for collaboration"**
→ Solution: Start small (30-minute exercises), demonstrate value, expand

### Tooling for Purple Teams

**Attack simulation:**
- Atomic Red Team (free, open-source)
- MITRE Caldera (free, automated)
- Cobalt Strike (commercial, advanced)
- AttackIQ, SafeBreach (commercial BAS platforms)

**Detection validation:**
- Sigma (cross-platform detection rules)
- YARA (file-based detection)
- Custom SIEM queries

**Documentation:**
- MITRE ATT&CK Navigator (coverage visualization)
- Detection engineering wikis
- Purple team exercise logs

---

## 3. Guided Practice

### Exercise 1: Planning a Purple Exercise

Select a MITRE ATT&CK technique and plan a purple team exercise:

**Selected technique:** T1053.005 (Scheduled Task/Job: Scheduled Task)

- **Execution method:** ____________
- **Required telemetry:** ____________
- **Expected detection (if any):** ____________
- **What would indicate failure?** ____________
- **Engineering outcome if missed:** ____________

### Exercise 2: Gap Analysis

Your purple exercise revealed these results:

| Technique | Detected | Notes |
|-----------|----------|-------|
| T1003.001 (LSASS Dump) | Yes | EDR alert |
| T1053.005 (Scheduled Task) | No | No logging |
| T1059.001 (PowerShell) | Partial | Only if -enc used |
| T1021.001 (Remote Desktop) | Yes | SIEM alert |

Prioritize the gaps and explain your reasoning:
1. ____________
2. ____________
3. ____________

### Exercise 3: Rule Development

Write a detection hypothesis for discovering scheduled tasks created for persistence:

- **What to detect:** ____________
- **Data source required:** ____________
- **Key fields to filter on:** ____________
- **Expected false positive rate:** ____________

---

## 4. Reflection Check

### Mindset
1. Why might a skilled red teamer struggle in a purple team role? What mindset shift is required?

2. A SOC manager says "We already do red team exercises." How would you explain the difference and value of purple teaming?

3. After a purple exercise reveals 15 detection gaps, team morale drops. How would you reframe this as a positive outcome?

### Strategic
1. Should purple team exercises be scheduled or surprise? What are the trade-offs?

2. How often should purple team exercises occur? What factors influence this?

3. What metrics would you present to leadership to demonstrate purple team value?

---

## 5. Key Misconceptions

**MYTH: "Purple team = red team + blue team in the same room"**
REALITY: Presence isn't enough. Purple team requires a methodology, feedback loop, and engineering follow-through.

**MYTH: "Purple team replaces red team"**
REALITY: They serve different purposes. True red team exercises (adversary simulation) still test holistic security. Purple team validates specific detections.

**MYTH: "Purple team is only for mature organizations"**
REALITY: Any organization with a SIEM and detection capability can benefit from purple teaming—start small.

**MYTH: "Finding gaps means the blue team failed"**
REALITY: Finding gaps is the goal. You cannot improve what you don't measure.

**MYTH: "One purple exercise is enough"**
REALITY: Purple teaming is continuous. Attackers evolve; your detections must evolve too.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Explain** the difference between traditional red/blue exercises and purple teaming
2. **Articulate** the feedback loop that makes purple teaming effective
3. **Plan** a basic purple team exercise for a given ATT&CK technique
4. **Recognize** the cultural barriers that impede purple team adoption
5. **Define** success metrics for a purple team program

---

## 7. Further Depth (Optional)

*   **Resource:** Atomic Red Team project (https://atomicredteam.io/)
*   **Framework:** MITRE ATT&CK Navigator for coverage tracking
*   **Reading:** "Purple Team Strategies" by David Routin
*   **Practice:** Run a purple team exercise in a home lab using Atomic Red Team
