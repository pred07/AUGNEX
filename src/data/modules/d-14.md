# Log Retention and Integrity

## 1. Orientation

### What this module covers
This module covers the *lifecycle* of a log. How long do we keep it? How do we ensure it wasn't faked?

### Fit in the Learning Path
Attacks are often discovered 200 days later. If you only keep 30 days of logs, you are blind.

### Learning Objectives
By the end of this module, you should understand:
*   **Hot vs Cold Storage**.
*   **Chain of Custody** (Integrity).
*   **Write Once Read Many (WORM)**.

---

## 2. Core Content

### Retention Policies
*   **Operational**: 30 Days. (Hot). Fast search for active incidents.
*   **Compliance**: 1 Year to 7 Years. (Cold). Slow reliable storage (Tape/Glacier). PCI/HIPAA require this.

### Integrity and WORM
A hacker with Root access can edit `/var/log/auth.log`.
*   **Solution**: Ship logs immediately to a WORM drive (Write Once, Read Many). Once written, it cannot be modified or deleted until retention expires.

### Hashing
Every log block is hashed. If a byte changes, the hash breaks. Proof of tampering.

---

## 3. Guided Practice

### The "Missing Days" Indicators
**Scenario**: You are auditing a server.
*   Log timestamps:
    *   Jan 1 - Jan 10: Normal.
    *   Jan 11 - Jan 14: **MISSING**.
    *   Jan 15: Normal.

**Conclusion**:
The specific gap suggests intentional deletion (The "Nixon Tape" gap). The attacker likely operated during those 3 days and cleaned up.

---

## 4. Reflection Check

1.  **Cost**: Why not keep everything on SSD forever? (Cost. SSD is $100/TB. Cold Tape is $1/TB).
2.  **GDPR**: Does "Right to be Forgotten" conflict with "Log Retention"? (Yes. If a user asks to be deleted, but their name is in your immutable logs, you have a legal compliance headache).
3.  **Backups**: Are backups the same as archives? (No. Backups are for restore. Archives are for search/evidence).

---

## 5. Completion Criteria

This module is complete when:
1.  You understand that Logs are Legal Documents.
2.  You verify that you cannot edit a log once it hits the SIEM.
3.  You know the difference between Hot (Fast/Expensive) and Cold (Slow/Cheap) storage.
