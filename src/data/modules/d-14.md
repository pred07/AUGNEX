# Log Retention and Integrity

## 1. Unit Brief: Trusting History
How long do you keep logs? Do you trust they haven't been changed? Retention is costly, but deleting evidence is worse.

## 2. Real-World Relevance
*   **The APT**: They hacked you 200 days ago.
*   **Retention**: You only keep logs for 30 days.
*   **Result**: You have zero visibility into what they did for the first 5 months. You cannot assess the damage.

## 3. Core Concepts

### Retention Policy
*   **Hot Storage (SSD)**: 30-90 days. fast search. Expensive.
*   **Cold Storage (S3 Glacier/Tape)**: 1-7 years. Slow search. Cheap.
*   **Compliance**: PCI-DSS requires 1 year. Banks often require 7 years.

### Integrity (FIM)
File Integrity Monitoring.
*   Hashing log files creating a "Chain of Custody".
*   If a hacker edits a log line, the hash breaks.

### Secure Logging Servers
The Logging Server should be the most hardened box in the network. If it falls, truth is lost.

## 4. Practical Examples

### Rotate and Compress
Logrotate config:
*   `daily`
*   `rotate 365` (Keep a year).
*   `compress` (Gzip).
*   `postrotate`: Restart syslog.

### Signed Logs
Using `syslog-ng` with TSL and signing.
*   The sender signs the log entry.
*   The receiver verifies the signature.
*   Prevents Man-in-the-Middle log spoofing.

## 5. Common Mistakes Beginners Make
*   **Disk Full**: Logging server fills up -> Stops logging -> Blindness. Always monitor disk space on the logger!
*   **Keep Everything Hot**: Trying to keep 1 year of logs on SSDs. cost prohibitive. Tier your storage.

## 6. Key Takeaways
*   **Standard**: 90 Days Hot, 1 Year Cold is a good baseline.
*   **Integrity**: Logs are legal documents in court. Treat them as such.
