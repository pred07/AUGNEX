# Using SIEMs for Validation (Conceptual)

## 1. What this module covers
How to use the SIEM (Security Information and Event Management) not just for viewing alerts, but for *hunting* and *validation*.

## 2. Why this matters for purple teams
The SIEM is the scorecard. If it's not in the SIEM, it didn't happen (for the SOC).

## 3. Core concepts explained clearly

### The Aggregation Power
*   SIEM ingests logs from Endpoint, Network, Cloud, and Identity.
*   It allows **Correlation**: "Endpoint Process A" + "Network Connection B".

### Query Languages
*   **Splunk**: SPL (Search Processing Language). `index=main | stats count by host`.
*   **Elastic**: KQL (Kibana Query Language) or EQL (Event Query Language). `process where process.name == "cmd.exe"`.
*   **Microsoft Sentinel**: KQL (Kusto Query Language).

## 4. Validation examples

### Searching for the "Needle"
*   **Scenario**: Red Team executed `whoami /priv`.
*   **Validation Steps**:
    1.  Wait 5 minutes (Log latency).
    2.  Query: `CommandLine="*whoami*"` within the last 15 mins.
    3.  **Result**: 
        *   Found? Good. Logs are flowing.
        *   Not Found? Is the agent broken? Is the indexer lagging?

## 5. Common gaps and failures
*   **Latency**: Logs taking 4 hours to arrive. (Useless for incident response).
*   **Field Parsing**: The raw log has the data, but the SIEM didn't extract the "User" field. You can't search `User="Bob"`.

## 6. Key takeaways
*   **Know your schema**: Know what fields you have (`dest_ip` vs `DestinationAddress`).
*   **Test ingestion**: Regular checks to ensure data is actually arriving.
