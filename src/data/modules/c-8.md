# MITRE ATT&CK for Purple Teams

## 1. Orientation

### What this module covers
This module teaches practical application of MITRE ATT&CK framework for purple team operations—using the matrix to measure detection coverage, prioritize techniques, and communicate security posture to stakeholders.

### Fit in the Learning Path
"How secure are we?" requires a measurable answer. MITRE ATT&CK provides a common language and framework for quantifying detection coverage. This is essential for purple team exercises and security maturity measurement.

### Learning Objectives
By the end of this module, you will:
*   Navigate the ATT&CK matrix effectively
*   Use ATT&CK Navigator for coverage mapping
*   Prioritize techniques based on threat relevance
*   Communicate coverage using ATT&CK heatmaps

---

## 2. Core Content

### Mental Model: The Periodic Table of Attacks

**How professionals think about this:**
ATT&CK is the periodic table of adversary behavior. Just as chemists know the elements, security professionals must know the techniques. The matrix organizes all known attack behaviors into a structured, measurable framework.

```
MITRE ATT&CK STRUCTURE:

┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  TACTICS (Columns) = The "WHY"                                     │
│  What is the attacker trying to achieve?                           │
│  ─────────────────────────────────────                             │
│  Initial Access | Execution | Persistence | Priv Esc | ...          │
│                                                                     │
│  TECHNIQUES (Rows) = The "HOW"                                     │
│  How is the attacker achieving their goal?                         │
│  ─────────────────────────────────────                             │
│  T1566 Phishing     │ T1059 Command Line │ T1053 Scheduled Task    │
│  T1190 Exploit Pub  │ T1204 User Exec    │ T1547 Boot/Logon        │
│  ...                │ ...                 │ ...                     │
│                                                                     │
│  SUB-TECHNIQUES = The specifics                                    │
│  ─────────────────────────────────────                             │
│  T1566.001 Spearphishing Attachment                                │
│  T1566.002 Spearphishing Link                                      │
│  T1566.003 Spearphishing via Service                               │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### The ATT&CK Matrix

**Enterprise matrix overview:**

| Tactic | Goal | Example Techniques |
|--------|------|-------------------|
| **Reconnaissance** | Research target | Active scanning, phishing for info |
| **Resource Development** | Build infrastructure | Acquire infrastructure, develop capab. |
| **Initial Access** | Get into network | Phishing, exploit public apps |
| **Execution** | Run malicious code | PowerShell, scripting |
| **Persistence** | Maintain access | Scheduled tasks, registry keys |
| **Privilege Escalation** | Gain higher access | Exploitation, access token manip. |
| **Defense Evasion** | Avoid detection | Obfuscation, disable security |
| **Credential Access** | Steal credentials | Dumping, keylogging |
| **Discovery** | Learn environment | Network, account, file discovery |
| **Lateral Movement** | Spread through network | RDP, SMB, WinRM |
| **Collection** | Gather target data | Data from local system, shares |
| **Command & Control** | Maintain communication | Web protocols, DNS tunneling |
| **Exfiltration** | Steal data | Over C2, web, alternative media |
| **Impact** | Damage/destroy | Encryption, wiper, defacement |

### ATT&CK Navigator

**Visual coverage mapping tool:**

```
NAVIGATOR USAGE:

1. CREATE LAYER
   ─────────────────────────────
   Base layer = All techniques blank
   Start mapping your coverage

2. COLOR CODING
   ─────────────────────────────
   
   ████████  RED: No detection, high risk
   ████████  ORANGE: Partial detection
   ████████  YELLOW: Detection exists, not tested
   ████████  GREEN: Detection validated
   ████████  BLUE: Not applicable/out of scope
   
3. SCORING
   ─────────────────────────────
   0 = No coverage
   1 = Minimal (single rule, untested)
   2 = Partial (rules exist, some gaps)
   3 = Good (validated detections)
   4 = Excellent (multiple layers, tested)

4. OVERLAYS
   ─────────────────────────────
   Layer 1: Your detection coverage
   Layer 2: Threat actor techniques
   Overlay: Where they intersect = protected
             Where they don't = GAPS
```

### Threat-Based Prioritization

**Focus on relevant techniques:**

```
PRIORITIZATION METHODOLOGY:

1. IDENTIFY RELEVANT THREATS
   ─────────────────────────────
   - Industry-specific threat actors
   - Geography-specific actors
   - Capability-specific threats
   
   Example (Financial sector):
   - FIN7, FIN8 (financially motivated)
   - APT38 (North Korea, banking)
   - Carbanak/Cobalt (banking malware)

2. MAP THEIR TECHNIQUES
   ─────────────────────────────
   Use ATT&CK Groups:
   https://attack.mitre.org/groups/
   
   FIN7 commonly uses:
   - T1566 Phishing
   - T1059 Command Line
   - T1003 Credential Dumping
   - T1071 Application Layer Protocol
   
3. COMPARE TO YOUR COVERAGE
   ─────────────────────────────
   Create overlay in Navigator
   Red = Technique used by threat + No detection
   
   THESE ARE YOUR PRIORITY GAPS

4. PRIORITIZE REMEDIATION
   ─────────────────────────────
   Threat uses + No detection = Critical
   Threat uses + Partial detection = High
   Common technique + No detection = Medium
   Rare technique + No detection = Low
```

### Coverage Scoring

**Quantifying detection capability:**

```
COVERAGE CALCULATION:

SIMPLE PERCENTAGE:
─────────────────────────────
Techniques with detection    
────────────────────────────  × 100 = Coverage %
Total applicable techniques  

Example: 150 / 300 = 50% coverage

WEIGHTED SCORING:
─────────────────────────────
Weight by:
- Threat relevance (×2 if used by priority threats)
- Prevalence (×2 if commonly used)
- Impact (×2 if leads directly to objective)

MORE NUANCED:
─────────────────────────────
For each technique, score 0-4:

0 = No coverage
1 = Basic (single rule, auto-generated)
2 = Moderate (custom rule, some coverage)
3 = Good (validated detection, good coverage)
4 = Excellent (multiple validated detections)

Total score / (Total techniques × 4) = Maturity %

EXAMPLE SCORECARD:

Tactic           Techniques  Coverage  Score
─────────────────────────────────────────────
Initial Access        9         67%     2.3
Execution            14         43%     1.8
Persistence          19         32%     1.2
Credential Access    17         59%     2.1
...
Overall              201        48%     1.9
```

### Purple Team Application

**Using ATT&CK for exercises:**

```
PURPLE TEAM ATT&CK WORKFLOW:

1. SELECT TECHNIQUES
   ─────────────────────────────
   From threat-based prioritization
   Or from known coverage gaps
   
   Today: T1003.001 (LSASS Memory)

2. PREPARE EXECUTION
   ─────────────────────────────
   Red team: "I will execute procdump on lsass"
   Blue team: "Ready on WORKSTATION-42"
   
3. EXECUTE AND OBSERVE
   ─────────────────────────────
   Red: Runs technique
   Blue: Monitors in real-time
   
   Detected? Yes/No
   Alert generated? Yes/No
   What telemetry available?

4. DOCUMENT RESULTS
   ─────────────────────────────
   Technique: T1003.001
   Variant: procdump.exe lsass.exe
   Detected: No
   Telemetry: Sysmon Event 10 present
   Gap: No detection rule for this pattern
   
5. ENGINEER DETECTION
   ─────────────────────────────
   Write Sigma rule
   Test against attack
   Deploy to production
   
6. VALIDATE
   ─────────────────────────────
   Re-run technique
   Confirm detection
   Update Navigator (Green!)
   
7. ITERATE
   ─────────────────────────────
   Try variations:
   - comsvcs.dll MiniDump
   - mimikatz sekurlsa
   - nanodump
   
   Some may evade. Repeat process.
```

### Communicating with ATT&CK

**Stakeholder reporting:**

```
EXECUTIVE COMMUNICATION:

BEFORE ATT&CK:
─────────────────────────────
"We think we have pretty good detection"
"We have EDR and SIEM"
"We're working on improving"

AFTER ATT&CK:
─────────────────────────────
"We detect 48% of known attack techniques"
"For threats targeting our industry:
 - We detect 72% of their techniques
 - Critical gaps exist in these 3 areas"
"After this quarter's improvements:
 - We'll reach 65% overall
 - Industry-relevant coverage: 85%"

VISUAL:
─────────────────────────────
[Navigator Heatmap Image]

"Red areas = Where priority threats attack
             AND we have gaps"

This is measurable. Trackable. Actionable.
```

### Sub-Technique Granularity

**Techniques aren't equal:**

```
SUB-TECHNIQUE IMPORTANCE:

T1003 (Credential Dumping) has sub-techniques:

T1003.001 - LSASS Memory
T1003.002 - Security Account Manager
T1003.003 - NTDS
T1003.004 - LSA Secrets
T1003.005 - Cached Domain Credentials
T1003.006 - DCSync
T1003.007 - Proc Filesystem
T1003.008 - /etc/passwd and /etc/shadow

Detecting ONE sub-technique ≠ Detecting T1003

Each requires:
- Different data sources
- Different detection logic
- Different prevention controls

SCORING SHOULD BE AT SUB-TECHNIQUE LEVEL
```

---

## 3. Guided Practice

### Exercise 1: Navigator Mapping

Create a coverage layer for these techniques:

| Technique | Your Coverage (0-4) | Color |
|-----------|---------------------|-------|
| T1566.001 Phishing Attachment | ___ | ___ |
| T1059.001 PowerShell | ___ | ___ |
| T1003.001 LSASS Memory | ___ | ___ |
| T1021.001 Remote Desktop | ___ | ___ |
| T1048 Exfiltration Over C2 | ___ | ___ |

### Exercise 2: Threat Prioritization

Your organization is in healthcare. Identify:

1. Relevant threat groups: ___
2. Their top 5 techniques: ___
3. Your coverage for each: ___

### Exercise 3: Purple Team Planning

Plan a purple team exercise for T1053.005 (Scheduled Task):

1. Execution method: ___
2. Expected detection: ___
3. Data sources needed: ___
4. Success criteria: ___

---

## 4. Reflection Check

### ATT&CK Understanding
1. Technique shows "Green" but was tested 2 years ago. Confidence?

2. 90% coverage. 10% includes T1003 and T1059. Problem?

3. Coverage improved 10%. Business impact?

### Practical Thinking
1. Can't test all 500+ techniques. Prioritization approach?

2. Detection exists but produces 50 FPs/day. Coverage score?

3. New threat actor announced. Immediate action?

---

## 5. Key Misconceptions

**MYTH: "Green on Navigator means we're protected"**
REALITY: Green means "rule exists." Rules can be wrong, outdated, or evaded.

**MYTH: "We need 100% coverage"**
REALITY: Prioritize by threat relevance. 100% is impractical and unnecessary.

**MYTH: "ATT&CK is only for advanced threats"**
REALITY: Even commodity malware uses ATT&CK techniques. It's universal.

**MYTH: "One detection per technique is enough"**
REALITY: Techniques have variations. Multiple detections provide defense in depth.

**MYTH: "ATT&CK is a checklist"**
REALITY: It's a framework for understanding, not a compliance checkbox.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Navigate** the ATT&CK matrix effectively
2. **Use** Navigator for coverage mapping
3. **Prioritize** techniques based on threats
4. **Score** detection coverage accurately
5. **Communicate** coverage to stakeholders

---

## 7. Further Depth (Optional)

*   **Tool:** MITRE ATT&CK Navigator (https://mitre-attack.github.io/attack-navigator/)
*   **Practice:** Create heatmap for your environment
*   **Resource:** ATT&CK Groups database for threat mapping
*   **Reading:** Center for Threat-Informed Defense
