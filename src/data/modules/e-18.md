# Technology Stack Fingerprinting

## 1. Orientation

### What this module covers
This module teaches identification of the technologies powering a web application—web servers, frameworks, languages, CMSs, and databases. Knowing the technology stack focuses your attack approach on relevant vulnerabilities and eliminates wasted effort.

### Fit in the Learning Path
A PHP exploit won't work on a Java server. Technology fingerprinting narrows your attack surface to relevant vectors and helps you find technology-specific vulnerabilities (CVEs) for the exact versions in use.

### Learning Objectives
By the end of this module, you will:
*   Identify technologies from multiple indicators
*   Use fingerprinting tools effectively
*   Recognize technology-specific vulnerabilities
*   Apply fingerprinting in attack workflows

---

## 2. Core Content

### Mental Model: The Technology Stack

**How professionals think about this:**
Every web application is built on a stack of technologies, each with its own vulnerabilities. Identifying the stack lets you search for known CVEs, default credentials, and common misconfigurations specific to those technologies.

```
TECHNOLOGY STACK LAYERS:

┌─────────────────────────────────────────────────────────────────────┐
│ FRONTEND                                                            │
│ ─────────                                                           │
│ React, Vue, Angular, jQuery, Bootstrap                              │
│ Vulnerability: XSS, Client-side logic flaws                         │
├─────────────────────────────────────────────────────────────────────┤
│ WEB SERVER                                                          │
│ ──────────                                                          │
│ Apache, Nginx, IIS, Tomcat, Gunicorn                                │
│ Vulnerability: Misconfigurations, CVEs                              │
├─────────────────────────────────────────────────────────────────────┤
│ APPLICATION FRAMEWORK                                               │
│ ─────────────────────                                               │
│ Django, Laravel, Spring, Express, Rails, ASP.NET                    │
│ Vulnerability: Framework-specific CVEs, default routes              │
├─────────────────────────────────────────────────────────────────────┤
│ LANGUAGE RUNTIME                                                    │
│ ────────────────                                                    │
│ PHP, Python, Java, Node.js, Ruby, .NET                              │
│ Vulnerability: Language-specific attacks                            │
├─────────────────────────────────────────────────────────────────────┤
│ DATABASE                                                            │
│ ────────                                                            │
│ MySQL, PostgreSQL, MongoDB, Redis, MSSQL                            │
│ Vulnerability: SQLi syntax, DB-specific exploits                    │
├─────────────────────────────────────────────────────────────────────┤
│ OPERATING SYSTEM                                                    │
│ ────────────────                                                    │
│ Linux, Windows Server                                               │
│ Vulnerability: Privilege escalation, local exploits                 │
└─────────────────────────────────────────────────────────────────────┘
```

### Fingerprinting Indicators

**HTTP Response Headers:**

```http
HTTP/1.1 200 OK
Server: nginx/1.18.0                    ← Web server + version
X-Powered-By: PHP/7.4.3                 ← Language + version
X-AspNet-Version: 4.0.30319             ← ASP.NET version
X-Generator: WordPress 5.8              ← CMS + version
X-Drupal-Cache: HIT                     ← Drupal CMS
Set-Cookie: JSESSIONID=...              ← Java (Tomcat)
Set-Cookie: PHPSESSID=...               ← PHP
Set-Cookie: connect.sid=...             ← Node.js/Express
Set-Cookie: rack.session=...            ← Ruby
Set-Cookie: csrftoken=...               ← Django

SECURITY NOTE: Headers should be removed/obscured in production
Many servers still expose them = Easy fingerprinting
```

**File Extensions:**

| Extension | Technology |
|-----------|------------|
| .php | PHP |
| .asp, .aspx | ASP.NET (Microsoft) |
| .jsp | Java Server Pages |
| .do, .action | Java Struts |
| .cgi | Perl/Python CGI |
| .pl | Perl |
| .py | Python (rare in URLs) |
| .rb | Ruby (rare in URLs) |
| (none) | Modern frameworks (routing) |

**URL Patterns:**

```
URL PATTERN → TECHNOLOGY MAPPING:

/wp-content/, /wp-admin/       → WordPress
/administrator/, /components/  → Joomla
/sites/default/, /node/        → Drupal
/index.php?option=             → Joomla, many PHP apps

/api/v1/                       → REST API
/graphql                       → GraphQL API
/actuator/                     → Spring Boot
/rails/info/routes             → Ruby on Rails

/?XDEBUG_SESSION_START         → PHP with Xdebug
/elmah.axd                     → ASP.NET error logging
/trace.axd                     → ASP.NET tracing
```

### Cookie-Based Fingerprinting

**Session cookie names:**

| Cookie Name | Technology |
|-------------|------------|
| PHPSESSID | PHP |
| JSESSIONID | Java (Tomcat, etc.) |
| ASP.NET_SessionId | ASP.NET |
| connect.sid | Node.js/Express |
| _session_id | Ruby on Rails |
| sessionid | Django |
| laravel_session | Laravel (PHP) |
| CFID/CFTOKEN | ColdFusion |

### HTML/JavaScript Fingerprints

**Source code indicators:**

```html
<!-- WordPress -->
<link rel="stylesheet" href="/wp-content/themes/theme/style.css">
<meta name="generator" content="WordPress 5.8">

<!-- Drupal -->
<link rel="stylesheet" href="/sites/all/themes/theme/style.css">
Drupal.settings = {...}

<!-- React -->
<div id="root"></div>
<script src="/static/js/main.chunk.js">

<!-- Angular -->
<app-root></app-root>
ng-version="12.0.0"

<!-- Vue.js -->
<div id="app">
data-v-xxxxxx attributes

<!-- jQuery -->
<script src="/jquery-3.6.0.min.js">
$(document).ready()

<!-- Bootstrap -->
class="container" class="row" class="col-md-6"
```

### Fingerprinting Tools

**Automated tools:**

```
BROWSER EXTENSIONS:
─────────────────────
Wappalyzer        - Most comprehensive, 1000+ technologies
BuiltWith         - Detailed breakdown
Whatruns          - Simpler, quick results

COMMAND LINE:
─────────────────────
whatweb           - Ruby-based scanner
  whatweb -v target.com

Wappalyzer CLI    - Same as extension
  npx wappalyzer https://target.com

httpx             - Modern, fast
  echo target.com | httpx -tech-detect

WEB SERVICES:
─────────────────────
BuiltWith.com     - Historical data too
Netcraft          - Infrastructure details
Shodan            - Internet-wide scanning
```

### Version-Specific Vulnerabilities

**Why versions matter:**

```
VULNERABILITY EXAMPLE:

Technology: Apache Struts

Struts 2.5.0:  CVE-2017-5638 - Critical RCE (Equifax breach)
Struts 2.5.16: Patched

If you fingerprint Struts 2.5.0:
1. Search: "Struts 2.5.0 CVE"
2. Find: CVE-2017-5638 (CVSS 10.0)
3. Exploit: Content-Type header injection → RCE

If you fingerprint Struts 2.5.16:
1. This specific vulnerability is patched
2. Look for other CVEs or configuration issues
```

**Common vulnerable technologies:**

| Technology | Famous CVE | Impact |
|------------|------------|--------|
| Apache Struts 2 | CVE-2017-5638 | RCE |
| Log4j | CVE-2021-44228 | RCE |
| Drupalgeddon | CVE-2018-7600 | RCE |
| WordPress plugins | Various | Various |
| Spring4Shell | CVE-2022-22965 | RCE |
| Exchange ProxyLogon | CVE-2021-26855 | RCE |

### Fingerprinting Evasion

**Servers can lie:**

```
OBFUSCATION TECHNIQUES:

1. Header Removal/Modification
   Server: (removed entirely)
   Server: Microsoft-IIS/10.0 (actually nginx)

2. Custom Error Pages
   Standard 404 leaks technology
   Custom 404 hides it

3. Extension Rewriting
   .php → /page  (URL rewriting)
   
4. Cookie Name Changes
   PHPSESSID → session

FINGERPRINTING AROUND OBFUSCATION:
- Multiple indicators (don't rely on one)
- Behavior-based detection
- Error handling differences
- Timing analysis
```

### Technology-Specific Attack Paths

**Fingerprint → Attack mapping:**

```
ATTACK PATH BY TECHNOLOGY:

WordPress:
├── /wp-admin/ → Brute force
├── /wp-content/plugins/ → Plugin vulns
├── /xmlrpc.php → Amplification, brute force
└── Theme/plugin CVEs

Drupal:
├── /user/login → Auth attacks
├── /admin → Admin panel
└── Drupalgeddon checks

Java/Tomcat:
├── /manager/html → Default creds
├── File upload RCE
└── Deserialization attacks

Node.js:
├── Prototype pollution
├── ReDoS
└── SSRF via request libraries

PHP:
├── Type juggling
├── LFI/RFI
└── Deserialization (phar://)
```

---

## 3. Guided Practice

### Exercise 1: Header Analysis

Analyze these headers and identify the stack:

```http
HTTP/1.1 200 OK
Server: Apache/2.4.41 (Ubuntu)
X-Powered-By: PHP/7.4.3
Set-Cookie: PHPSESSID=abc123
X-Generator: WordPress 5.7.2
```

| Component | Identified Technology |
|-----------|----------------------|
| OS | ___ |
| Web Server | ___ |
| Language | ___ |
| CMS | ___ |

### Exercise 2: URL Pattern Recognition

Identify the technology from these URLs:

| URL | Technology |
|-----|------------|
| /wp-content/uploads/2024/image.jpg | ___ |
| /api/v1/users?format=json | ___ |
| /index.php?option=com_content&view=article | ___ |
| /actuator/health | ___ |
| /node/1 | ___ |

### Exercise 3: CVE Research

For WordPress 5.7.2:
1. Search for known CVEs: ___
2. Find any critical vulnerabilities: ___
3. Identify relevant exploit tools: ___

---

## 4. Reflection Check

### Fingerprinting Understanding
1. A server returns `Server: Apache` with no version. What's your next step?

2. You identified PHP 5.6. Why is this immediately concerning?

3. The site uses WordPress. What specific paths would you check first?

### Practical Thinking
1. Wappalyzer shows React frontend. Does this tell you about backend security?

2. You found JSESSIONID cookie. What attack types become more relevant?

3. Error pages show stack traces with Java classes. What have you learned?

---

## 5. Key Misconceptions

**MYTH: "Hidden headers mean secure"**
REALITY: Lack of headers doesn't mean security. Other fingerprints exist. Obscurity is not security.

**MYTH: "Wappalyzer is always accurate"**
REALITY: Automated tools can be fooled or miss things. Verify with multiple indicators.

**MYTH: "Latest version means secure"**
REALITY: Misconfigurations exist at any version. Latest version just means known CVEs are patched.

**MYTH: "Frontend tech tells you about backend security"**
REALITY: React frontend says nothing about backend. PHP backend with React frontend is common.

**MYTH: "One fingerprint is enough"**
REALITY: Always corroborate with multiple indicators. Servers can obfuscate individual signals.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Identify** technologies from headers, cookies, and URLs
2. **Use** Wappalyzer or similar tools effectively
3. **Research** CVEs for identified versions
4. **Explain** technology-specific attack paths
5. **Recognize** fingerprinting evasion techniques

---

## 7. Further Depth (Optional)

*   **Tool:** Install and practice with Wappalyzer
*   **Database:** Explore CVE databases (NVD, Exploit-DB)
*   **Practice:** Fingerprint 10 different websites
*   **Research:** Study major CVEs for common technologies
