# Cyber Kill Chain Analysis

## 1. Orientation

### What this module covers
Developed by Lockheed Martin, the **Cyber Kill Chain** is the classic model of the intrusion lifecycle. While older, it remains the standard for **defensive interruption**. You will learn not just the 7 steps, but how to map specific **defensive controls** to "break" the chain at the earliest possible stage (Left of Boom).

### Fit in the Learning Path
S-22 (Diamond Model) gave you the *relationships* of the attack. S-25 (Kill Chain) gives you the *sequence* and the *opportunity* to stop it.

### Learning Objectives
*   Memorize the **7 Phases** of the Kill Chain.
*   Identify at least 2 defensive controls for each phase.
*   Understand the concept of **"Left of Boom"**.
*   Critique the Kill Chain (Perimeter focus vs Insider Threat).

---

## 2. Core Content

### The 7 Phases (Linear Progression)

The adversary must succeed at **all** steps. The defender only needs to break **one**.

#### 1. Reconnaissance (Targeting)
*   **Action:** Identifying targets (LinkedIn, Shodan, DNS queries).
*   **Defense:** Difficult to detect. Threat Intel (Dark Web monitoring), reducing attack surface (removing info from casual web).

#### 2. Weaponization (Building)
*   **Action:** Coupling an exploit (CVE-202X-XXXX) with a payload (RAT). Example: Creating a malicious PDF.
*   **Defense:** NONE. (Happens on the attacker's infrastructure). N/A.

#### 3. Delivery (Transmission)
*   **Action:** Sending the weapon. Email, USB, Drive-by Download.
*   **Defense:** Email Security Gateways (Proofpoint), User Awareness Training, Web Proxies.

#### 4. Exploitation (Trigger)
*   **Action:** The code executes. Buffer overflow, Macro enabled.
*   **Defense:** Patching, DEP/ASLR (OS protections), Blocking Macros, Browser Isolation.

#### 5. Installation (Persistence)
*   **Action:** Installing the backdoor/implant so access survives reboot. Registry keys, Scheduled Tasks.
*   **Defense:** EDR (Endpoint Detection & Response), File Integrity Monitoring (FIM).

#### 6. Command & Control (C2)
*   **Action:** Calling home. Interactive control.
*   **Defense:** Firewall Egress Filtering, DNS Sinkholing (Cisco Umbrella), Proxy Analysis.

#### 7. Actions on Objectives (Impact)
*   **Action:** Ransomware encryption, Data Exfiltration, Destruction.
*   **Defense:** DLP (Data Loss Prevention), Network Segmentation (limiting blast radius), Offline Backups.

### "Left of Boom" Strategy
*   **Boom** = Exploitation/Installation.
*   **Right of Boom:** Incident Response (Reactive). Cleaning up the mess.
*   **Left of Boom:** Prevention (Proactive). Stopping Delivery or Exploitation.
*   *Goal:* Move your detection as far Left as possible. Detecting C2 is good; Detecting Delivery is better.

---

## 3. Lab: Mapping Defense to Offense

### Scenario: Ransomware Attack
1.  **Recon:** Attacker finds Employee list on Corporate/About.
2.  **Weaponization:** Creates `Bonus_Sheet.xlsm` with Dridex.
3.  **Delivery:** Phishing email sent to Finance Dept.
4.  **Exploit:** User clicks "Enable Content". VBA runs.
5.  **Install:** Dridex adds Registry Run Key.
6.  **C2:** Connects to `45.33.2.1` to get commands.
7.  **Action:** Deploys Ryuk Ransomware throughout subnets.

### Task: The Defense Matrix
Select the best control for phases 3, 4, 6, and 7.

*   *Phase 3 (Delivery):* **DMARC/SPF Checks** (Reject spoofed mail).
*   *Phase 4 (Exploit):* **Attack Surface Reduction (ASR) Rule:** "Block Office Apps from creating child processes".
*   *Phase 6 (C2):* **IPS Signature** for Dridex traffic or **DNS Block** for known bad domains.
*   *Phase 7 (Action):* **Air-gapped Backups** (Recovery) & **Network Segmentation** (Prevent spread from Finance to Servers).

---

## 4. Critical Analysis: Model Limitations

The Kill Chain was designed in 2011 for "Perimeter" defense.
*   **Insider Threats:** Skip phases 1-4. They are already inside.
*   **Supply Chain Attacks:** Skip phases 1-3. The malware comes from a trusted vendor update (SolarWinds).
*   **Cloud:** "Installation" might just be an API key theft, not a binary on disk.

*The industry has moved toward **MITRE ATT&CK** for more granular behavioral mapping, but Kill Chain remains the best high-level strategic model for executives.*

---

## 5. Completion Criteria
1.  **Explain** why we cannot defend against "Weaponization". (It happens on the attacker's computer).
2.  **Identify** which phase "Phishing" belongs to. (Delivery).
3.  **Contrast** Left of Boom vs Right of Boom.

---

## 6. Further Research
*   **Read:** "Intelligence-Driven Computer Network Defense" (Lockheed Martin Whitepaper).
*   **Compare:** Look up the "Unified Kill Chain" which adds "In" and "Through" phases.
