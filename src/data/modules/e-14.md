# HTTP Protocol Deep Dive

## 1. Orientation

### What this module covers
This module revisits HTTP from an **Attacker's Perspective**. We focus on manipulating Headers, Methods, and encodings.

### Fit in the Learning Path
Web Hacking is simply "Sending unexpected HTTP packets". You need to know exactly what "Expected" looks like to break it.

### Learning Objectives
By the end of this module, you should understand:
*   How to craft raw HTTP requests.
*   **Host Header** attacks.
*   **Content-Type** confusion.

---

## 2. Core Content

### The Raw Request (Review)
```http
POST /login HTTP/1.1
Host: bank.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 20

user=admin&pass=1234
```

### Attack Vectors
1.  **Verb Tampering**: Changing `GET` to `POST`, or `DELETE`. Some servers forget to protect `HEAD` or `PUT`.
2.  **Host Header Injection**: Changing `Host: bank.com` to `Host: evil.com`. If the server uses this header to generate "Password Reset Links", you can hijack the account.
3.  **Content-Type Validation**: Uploading a PHP shell but calling it `image/png`. If the server only checks the Header, not the bytes, it executes code.

---

## 3. Guided Practice

### Mental Proxies
Imagine you are Burp Suite. modify the request.

**Original**:
```http
GET /admin/deleteUser?id=5 HTTP/1.1
Cookie: role=user
```
*   **Result**: 403 Forbidden.

**Modification A (Cookie Tampering)**:
Change `role=user` to `role=admin`.

**Modification B (Verb Tampering)**:
Change `GET` to `POST`. (Sometimes ACLs only block GET).

**Modification C (Parameter Pollution)**:
Change `id=5` to `id=5&id=1`. (Which one does the server take? The first? The last? An array?).

---

## 4. Reflection Check

1.  **State**: Since HTTP is stateless, can I replay a valid "Transfer Money" request 100 times? (Yes, unless the server implements "Anti-Replay" or CSRF tokens).
2.  **Encoding**: What is `%20`? (URL Encoding for Space). Why do we need it? (Because spaces break the HTTP format).
3.  **HTTPS**: Does HTTPS stop me from modifying these headers? (No. HTTPS encrypts the connection between Me and Server. Burp Suite sits *on my machine*, so it sees/modifies data before encryption).

---

## 5. Completion Criteria

This module is complete when:
1.  You can read a raw HTTP block and identify the Method, Path, Headers, and Body.
2.  You understand that every single line of an HTTP request is user-controlled input.
3.  You verify that HTTPS does not protect the server from Malicious Input.
