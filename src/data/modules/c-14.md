# Validating Network Visibility

## 1. What this module covers
Ensuring you can see traffic flows. "Who is talking to whom?". Network data is the backup when endpoint agents are disabled by the hacker.

## 2. Why this matters for purple teams
Sophisticated attackers kill the EDR agent. The Network (switches/firewalls) cannot be killed by the endpoint. It is the Source of Truth.

## 3. Core concepts explained clearly

### NetFlow / IPFIX
*   Metadata only: `SrcIP:Port -> DstIP:Port`, `Bytes`, `Time`.
*   Good for: Beacons, Data Exfiltration (Byte count), Scanning.

### PCAP (Packet Capture)
*   Full Payload: `GET /admin.php?pw=root HTTP/1.1`.
*   Good for: Exploit analysis, Credential stealing.
*   *Constraint*: Takes massive storage.

### DNS Logs
*   "What domains are we resolving?"
*   Critical for spotting C2 DGA (Domain Generation Algorithms).

## 4. Validation examples

### Exfiltration Emulation
1.  **Action**: Upload 100MB file to `mega.nz` (or generic file share) from a Critical Server.
2.  **Validation**:
    *   Do we see a connection to `mega.nz` IP?
    *   Do we see `Bytes Sent > 100MB`?
    *   Do we receive a "Large Upload" alert?
3.  **Gap**: If HTTPS Inspection is off, we see "Connection to Cloudflare", not "MEGA".

## 5. Common gaps and failures
*   **East-West Blindness**: "We log traffic to the Internet." What about traffic between Internal Servers? (Lateral Movement is invisible).
*   **UDP**: Often ignored. Hackers use UDP for C2 to avoid TCP logging.

## 6. Key takeaways
*   **Internal Visibility**: You need visibility INSIDE the perimeter (Core Switches).
*   **DNS is key**: Almost all malware uses DNS. Log it.
