# Web Authentication Mechanisms

## 1. Unit Brief: Proving Identity
Authentication (AuthN) is answering "Who are you?". Web apps use many methods, from simple username/password forms to complex OAuth flows. Authentication is the front door; if you break this, you own the account.

## 2. Real-World Relevance
*   **Brute Force**: Trying every key on the keyring.
*   **Credential Stuffing**: Using keys stolen from the neighbor's house.
*   **OAuth Abuse**: Tricking the house owner into giving you a key.

## 3. Core Concepts

### Basic & Digest Auth
Old school. The browser pops up a native dialog box. Credentials are sent in a base64 header (`Authorization: Basic dXNlcjpwYXNz`).
*   *Weakness*: Often sent over HTTP (cleartext) or easily brute-forced.

### Form-Based Auth
The standard HTML login page.
*   *Weakness*: SQL Injection in the fields, No rate limiting (allowing brute force).

### OAuth / OIDC (OpenID Connect)
"Log in with Google". The app never sees your password; it gets a "Token" from Google.
*   *Weakness*: Misconfigured redirect URIs can allow attackers to steal the token.

### Multi-Factor Authentication (MFA)
Something you know (Password) + Something you have (Phone).
*   *Bypass*: Phishing the code, SIM swapping, or sometimes simply deleting the `mfa_token` parameter from the request.

## 4. Practical Examples

### Base64 Decoding
You see a header: `Authorization: Basic YWRtaW46cGFzc3dvcmQ=`
```bash
$ echo "YWRtaW46cGFzc3dvcmQ=" | base64 -d
admin:password
```
*   **Result**: You have the credentials.

### OAuth Redirect Attack
1.  App sends you to Google: `google.com/auth?client_id=site&redirect_uri=site.com/callback`
2.  Attacker changes URL: `...&redirect_uri=attacker.com/callback`
3.  Victim logs in.
4.  Google sends the secret token to `attacker.com`.

## 5. Common Mistakes Beginners Make
*   **Assuming HTTPS protects against Phishing**: HTTPS encrypts the traffic, but if the site is `g00gle.com`, you are securely sending your password to a hacker.
*   **Ignoring "Forgot Password"**: This flow is often less secure than the main login.

## 6. Key Takeaways
*   Auth is the most attacked surface.
*   Always check if you can bypass authentication by simply forcing the browser to the `/dashboard` URL (Broken Access Control).
