# Indicators of Compromise (IOCs) & The Pyramid of Pain

## 1. Orientation

### What this module covers
In Cyber Threat Intelligence (CTI), not all data is created equal. An IP Address is easy to change; a TTP (Tactic, Technique, Procedure) is hard to change. This module defines the hierarchy of threat indicators using David Bianco's **Pyramid of Pain**.

### Learning Objectives
*   Categorize indicators into the 6 levels of the Pyramid of Pain.
*   Understand why "TTPs" are the gold standard of detection.
*   Differentiate between "Atomic", "Computed", and "Behavioral" indicators.

---

## 2. Core Content

### The Pyramid of Pain

| Level | Indicator | Value to Defender | Pain to Attacker |
| :--- | :--- | :--- | :--- |
| **Top** | **TTPs** | High | **Tough** (Must relearn tradecraft) |
| 5 | **Tools** | High | Challenging (Must rewrite software) |
| 4 | **Network Artifacts** | Medium | Annoying (Change User-Agent/C2) |
| 3 | **Domain Names** | Low | Simple (Register new domain) |
| 2 | **IP Addresses** | Low | Easy (Change VPN/Proxy) |
| **Base** | **Hash Values** | Low | **Trivial** (Change 1 bit of file) |

### Indicator Types
1.  **Atomic:** Small, simple pieces of data (IP, Email, Domain). High volume, short lifespan.
2.  **Computed:** Derived from data (Hashes: MD5, SHA256). Unique to specific files.
3.  **Behavioral:** Logic or actions (Macro executes PowerShell, Process A spawns Process B).

### The Ephemeral Nature of IOCs
An IP address used by APT29 today might be used by a grandmother in Ohio tomorrow. **Context is King.** Blocking IPs without context leads to false positives. 

---

## 3. Lab: Climbing the Pyramid

### Scenario
You have a report on "Emotet". Classify the following extract:

> "The malware arrives via email (phishing) containing a Word Doc. The Doc uses a Macro to spawn PowerShell. It connects to `192.168.55.10` to download `payload.exe` (Hash: `a1b2c3...`)."

**Classification:**
1.  **TTP:** Phishing (Initial Access), Macro spawns PowerShell (Execution).
2.  **Network Artifact:** Connection to `192.168.55.10`.
3.  **Hash:** `a1b2c3...`.

**Defender Strategy:**
*   Blocking the Hash? Helps for 5 minutes.
*   Blocking the IP? Helps for 1 day.
*   Blocking "Word spawning PowerShell"? **Stops the attack permanently** (until they change tactics).

---

## 4. Reflection
1.  Why do we still share Hashes if they are "trivial" to change? (Because they are cheap, easy, and give quick wins against lazy attackers).
2.  Why is detecting TTPs harder? (It requires understanding *intent* and *process*, not just matching a string).
