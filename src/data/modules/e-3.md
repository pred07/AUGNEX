# Legal Authorization, Scope, and Rules of Engagement

## 1. Unit Brief: The Most Important Documents
Before technical skill comes legal safety. In offensive security, the difference between a successful engagement and a felony arrest is often a single signature on a document called the "Rules of Engagement" (RoE).

## 2. Real-World Relevance
You never touch a target system without:
1.  **Written Authorization**: Signed by someone with the authority to grant it (C-Level Exec).
2.  **Defined Scope**: Explicit list of what you CAN and CANNOT touch.
3.  **Get Out of Jail Free Card**: A physical/digital copy of the authorization letter you carry with you (especially for physical pentests).

## 3. Core Concepts

### The Rules of Engagement (RoE)
This is the contract that governs the test. It includes:
*   **Timeline**: Start and End dates/times.
*   **Scope**: IP addresses, URLs, Domains.
*   **Forbidden Actions**: e.g., "Do not run DoS attacks", "Do not target the CEO's personal email".
*   **Emergency Contacts**: Who to call if you accidentally crash a server.

### Scope Creep
Moving outside the agreed boundaries.
*   **Example**: You find a server `dev.example.com` which is in scope. It accesses `api.thirdparty.com`. You decide to test the API.
*   **Problem**: You don't have permission to test `thirdparty.com`. You just committed a crime, even if you had permission for the first server.

### Third-Party Hosting (AWS/Azure/GCP)
Even if you have the client's permission, do you have the Cloud Provider's permission? Most modern cloud providers allow standard pentesting without prior notice, but *DoS* and *botnet* activities are strictly banned.

## 4. Practical Examples

### Scenario: The Forgotten Subdomain

**Scope**: `*.example.com`
**Found**: `legacy.example.com` pointing to 192.168.1.5 (Internal IP).
**Found**: `partner.example.com` pointing to a different company's server.

*   `legacy.example.com`: **In Scope** (probably).
*   `partner.example.com`: **Out of Scope** or requires validation. If you scan this and trigger alarms at the Partner company, your client will be liable.

### Terminal Context: Verifying Scope
Before launching `nmap`, verify the IP belongs to the client using `whois` or `nslookup`.

```bash
$ host target.com
target.com has address 93.184.216.34

$ whois 93.184.216.34 | grep OrgName
OrgName:        Example Organization
```
*   **Explanation**: Confirms the IP is owned by the organization you are authorized to test.

## 5. Common Mistakes Beginners Make
*   **"I thought it was part of the scope"**: Assumption is the mother of all legal screw-ups. Ask first.
*   **Testing Production during Peak Hours**: If the ROE says "Testing only between 10 PM and 4 AM", and you run a scanner at 2 PM causing a crash, you are in breach of contract.
*   **Scanning the wrong IP**: Typographical errors in IP lists happen. Always double-check.

## 6. Key Takeaways
*   **No Authorization = No Hacking**: Period.
*   **Scope is Rigid**: Do not wander off the path.
*   **The Contact List is Lifeline**: Know who to call when things break.
