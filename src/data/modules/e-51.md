# Windows Privilege Escalation Fundamentals

## 1. Unit Brief: Scaling the Windows
Windows PrivEsc is often about finding a service explicitly configured to run as SYSTEM, which you can tamper with.

## 2. Real-World Relevance
Corporate laptops often have third-party software (VPN clients, Antivirus, Mouse Drivers) installed as Services. These third-party tools are often insecure.

## 3. Core Concepts

### Unquoted Service Paths
Service Path: `C:\Program Files\My App\service.exe`.
*   Windows looks for: `C:\Program.exe` -> Fail.
*   Then: `C:\Program Files\My.exe` -> Fail.
*   Then: `C:\Program Files\My App\service.exe` -> Success.
*   **Attack**: If you put a virus named `C:\Program.exe`, Windows runs IT instead of the service. Result: SYSTEM.

### DLL Hijacking
An app tries to load `missing.dll`. If you place a malicious `missing.dll` in the same folder, the app loads your code.

### Token Privileges
`SeImpersonatePrivilege` (RottenPotato / JuicyPotato).
*   Allows a Service to impersonate a client connecting to it. If you trick SYSTEM to connect to you, you become SYSTEM.

## 4. Practical Examples

### Checking Privileges
```cmd
> whoami /priv
PRIVILEGES INFORMATION
----------------------
SeImpersonatePrivilege        Enabled
```
*   **Action**: Use `PrintSpoofer.exe` or `JuicyPotato` to escalate instantly to SYSTEM.

### AlwaysInstallElevated
A registry setting that allows any .msi file to run as SYSTEM.
1.  Check reg keys.
2.  Create malicious MSI with `msfvenom`.
3.  Run `msiexec /i evil.msi`.
4.  You are SYSTEM.

## 5. Common Mistakes Beginners Make
*   **Ignoring "Program Files (x86)"**: 32-bit apps are often older and less secure.
*   **Not checking output of WinPEAS**: WinPEAS prints a lot of red text. Read it carefully.

## 6. Key Takeaways
*   **Services are key**: Most Windows PrivEsc involves tricking a Service.
*   **Potatoes**: The "Potato" family of exploits (Juicy, Rotten, Rogue) targets `SeImpersonate`.
