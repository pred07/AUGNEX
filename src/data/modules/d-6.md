# Threats, Adversaries, and Attack Lifecycle

## 1. Orientation

### What this module covers
This module maps how adversaries operate—from initial reconnaissance through achieving their objectives. We examine the Cyber Kill Chain, MITRE ATT&CK framework, and the Pyramid of Pain, providing the mental models needed to anticipate, detect, and disrupt attacks at every stage.

### Fit in the Learning Path
Defense is not reactive guessing. Understanding attack lifecycles allows you to predict what comes next, prioritize detection, and break the chain before objectives are achieved.

### Learning Objectives
By the end of this module, you will:
*   Apply the Cyber Kill Chain to real attacks
*   Navigate and use the MITRE ATT&CK framework
*   Understand the Pyramid of Pain for prioritizing detection
*   Map threats to frameworks for intelligence sharing

---

## 2. Core Content

### Mental Model: The Attack as a Process

**How professionals think about this:**
Attacks aren't random events—they follow predictable phases. Understanding these phases allows defenders to detect attacks early, disrupt them mid-execution, and respond effectively.

```
THE ATTACKER'S JOURNEY:

OBJECTIVE:
Steal customer database

THE PATH:
┌────────────────────────────────────────────────────────────────┐
│ RECON → WEAPON → DELIVER → EXPLOIT → INSTALL → C2 → OBJECTIVE │
└────────────────────────────────────────────────────────────────┘
    │       │         │         │         │       │        │
    ▼       ▼         ▼         ▼         ▼       ▼        ▼
 Research  Build    Send      Code     Persist  Phone   Steal
 target    malware  email     executes backdoor  home    data

DEFENSE OPPORTUNITIES:
Every arrow is a chance to detect and stop the attack.
```

### The Cyber Kill Chain (Lockheed Martin)

**The seven phases:**

```
CYBER KILL CHAIN:

┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  1. RECONNAISSANCE                                                  │
│     └── Research the target                                         │
│         • OSINT, scanning, social engineering research              │
│         • Identify employees, technologies, vulnerabilities         │
│                                                                     │
│  2. WEAPONIZATION                                                   │
│     └── Build the attack package                                    │
│         • Create malware, exploit, phishing content                 │
│         • Package payload for delivery                              │
│                                                                     │
│  3. DELIVERY                                                        │
│     └── Transmit weapon to target                                   │
│         • Phishing email, malicious website, USB drop               │
│         • Watering hole attack, supply chain                        │
│                                                                     │
│  4. EXPLOITATION                                                    │
│     └── Code executes on target                                     │
│         • Software vulnerability, user action                       │
│         • Macro, script, exploit triggered                          │
│                                                                     │
│  5. INSTALLATION                                                    │
│     └── Establish persistence                                       │
│         • Backdoor, scheduled task, registry modification           │
│         • Survive reboot, maintain access                           │
│                                                                     │
│  6. COMMAND & CONTROL (C2)                                          │
│     └── Remote control channel                                      │
│         • HTTP/HTTPS beaconing, DNS tunneling                       │
│         • Encrypted communication to attacker infrastructure        │
│                                                                     │
│  7. ACTIONS ON OBJECTIVES                                           │
│     └── Achieve the mission                                         │
│         • Data theft, ransomware, destruction                       │
│         • Lateral movement to higher-value targets                  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

**Defensive actions per phase:**

| Phase | Defensive Actions |
|-------|-------------------|
| **Reconnaissance** | Monitor for scanning, limit public info |
| **Weaponization** | Pre-attack—limited defender visibility |
| **Delivery** | Email security, web filtering, awareness training |
| **Exploitation** | Patching, exploit mitigation, sandboxing |
| **Installation** | Application whitelisting, monitoring autoruns |
| **C2** | Network monitoring, DNS analysis, egress filtering |
| **Actions** | Data classification, DLP, segmentation |

### MITRE ATT&CK Framework

**What ATT&CK provides:**

```
MITRE ATT&CK STRUCTURE:

TACTICS (The "Why")              TECHNIQUES (The "How")
─────────────────────            ─────────────────────
Initial Access                   T1566 - Phishing
  └── How they got in            T1189 - Drive-by Compromise
                                 T1195 - Supply Chain Compromise

Execution                        T1059 - Command/Scripting Interpreter
  └── How they ran code          T1204 - User Execution
                                 T1053 - Scheduled Task/Job

Persistence                      T1547 - Boot/Logon Autostart
  └── How they stayed            T1053 - Scheduled Task/Job
                                 T1078 - Valid Accounts

Privilege Escalation             T1055 - Process Injection
  └── How they got admin         T1068 - Exploitation for Privilege Escalation
                                 T1548 - Abuse Elevation Control

Defense Evasion                  T1027 - Obfuscated Files
  └── How they hid                T1070 - Indicator Removal
                                 T1562 - Impair Defenses

Credential Access                T1003 - OS Credential Dumping
  └── How they got passwords     T1552 - Unsecured Credentials
                                 T1110 - Brute Force

Discovery                        T1087 - Account Discovery
  └── How they learned network   T1046 - Network Service Discovery
                                 T1083 - File and Directory Discovery

Lateral Movement                 T1021 - Remote Services
  └── How they moved             T1570 - Lateral Tool Transfer
                                 T1080 - Taint Shared Content

Collection                       T1005 - Data from Local System
  └── How they gathered data     T1560 - Archive Collected Data

Exfiltration                     T1041 - Exfiltration Over C2
  └── How they stole data        T1567 - Exfiltration Over Web Service

Impact                           T1486 - Data Encrypted for Impact
  └── How they caused damage     T1489 - Service Stop
```

**Using ATT&CK for detection:**

```
ATT&CK-BASED DETECTION DEVELOPMENT:

Step 1: Select technique
  T1053.005 - Scheduled Task

Step 2: Understand procedure
  Attacker creates scheduled task to run malware at boot

Step 3: Identify data sources
  - Windows Event Log 4698 (Task Created)
  - Sysmon Event 1 (Process Create for schtasks.exe)
  - Task file creation in C:\Windows\System32\Tasks\

Step 4: Create detection rule
  IF Event 4698 
  AND Task Action contains PowerShell/cmd/suspicious path
  THEN Alert

Step 5: Map to ATT&CK
  Detection covers: T1053.005
```

### The Pyramid of Pain

**What hurts attackers to change:**

```
PYRAMID OF PAIN:

                         ▲
                        /│\
                       / │ \   TTPs (Tactics, Techniques, Procedures)
                      /  │  \  (Hardest to change - requires new skills)
                     /   │   \
                    /────┼────\
                   /     │     \
                  /   TOOLS     \
                 /  (Custom      \
                /   malware,     \
               /    C2 frameworks)\
              /─────────┼─────────\
             /          │          \
            /   NETWORK/HOST        \
           /   ARTIFACTS             \
          /  (File paths, registry,   \
         /   mutex names)              \
        /──────────────┼───────────────\
       /               │                \
      /   DOMAIN NAMES                   \
     /  (C2 domains - medium cost)        \
    /─────────────────┼────────────────────\
   /                  │                     \
  /   IP ADDRESSES                           \
 /  (Easy to change - new VPS in minutes)     \
/──────────────────────────────────────────────\
      HASH VALUES
     (Change 1 byte = new hash)
     (Trivial to evade)
```

**Implications for detection:**

| Level | Detection Value | Evasion Cost |
|-------|-----------------|--------------|
| **Hashes** | Low | Trivial (change 1 byte) |
| **IP Addresses** | Low | Easy (new VPS) |
| **Domain Names** | Medium | Takes time/money |
| **Network/Host Artifacts** | Medium-High | Requires recoding |
| **Tools** | High | Significant effort |
| **TTPs** | Highest | Requires new tradecraft |

**Strategic implication:**
Focus detection on techniques (TTPs) rather than indicators (hashes/IPs).

### Threat Actor Categories

**Understanding adversaries:**

| Category | Motivation | Capabilities | Examples |
|----------|------------|--------------|----------|
| **Nation-State** | Espionage, disruption | Very high | APT28, APT41, Lazarus |
| **Cybercriminal** | Financial | Medium-high | REvil, LockBit, FIN7 |
| **Hacktivist** | Ideological | Low-medium | Anonymous |
| **Insider** | Grievance, profit | Varies | Employees, contractors |
| **Script Kiddie** | Notoriety | Low | Using public tools |

**Mapping actors to techniques:**
```
APT28 (Russia):
├── T1566 - Spearphishing
├── T1059.001 - PowerShell
├── T1053.005 - Scheduled Task
├── T1003 - Credential Dumping
└── T1041 - Exfiltration Over C2

FIN7 (Cybercrime):
├── T1566.001 - Spearphishing Attachment
├── T1059.005 - Visual Basic
├── T1218.011 - Rundll32
├── T1027 - Obfuscated Files
└── T1560 - Archive Collected Data

Knowing their techniques helps prioritize detection.
```

### Attack Lifecycle Mapping

**Converting incidents to intelligence:**

```
ATTACK NARRATIVE → KILL CHAIN → ATT&CK MAPPING

INCIDENT NARRATIVE:
"User received email with malicious PDF. PDF exploited Adobe Reader.
PowerShell script downloaded. Created scheduled task. Beacon
connects to evil.com every 30 minutes. Scans internal network.
Dumps domain credentials. Moves to domain controller. Encrypts
all file shares."

KILL CHAIN:
1. Delivery: Phishing email with PDF
2. Exploitation: Adobe Reader vulnerability
3. Installation: Scheduled task persistence
4. C2: HTTP beaconing to evil.com
5. Actions: Ransomware deployment

ATT&CK:
├── Initial Access: T1566.001 (Spearphishing Attachment)
├── Execution: T1059.001 (PowerShell)
├── Persistence: T1053.005 (Scheduled Task)
├── Command & Control: T1071.001 (Web Protocols)
├── Discovery: T1046 (Network Service Discovery)
├── Credential Access: T1003.001 (LSASS Memory)
├── Lateral Movement: T1021.002 (SMB/Windows Admin Shares)
└── Impact: T1486 (Data Encrypted for Impact)
```

---

## 3. Guided Practice

### Exercise 1: Kill Chain Mapping

Map this attack to the Kill Chain:

*"Attacker researches company on LinkedIn. Creates fake invoice document with macro. Sends to accounts payable employee. Employee opens and enables macros. Macro drops executable in temp folder. Executable adds registry run key. Connects to IP address every hour. Downloads additional tools. Exfiltrates customer database."*

| Kill Chain Phase | Activity |
|------------------|----------|
| Reconnaissance | ___ |
| Weaponization | ___ |
| Delivery | ___ |
| Exploitation | ___ |
| Installation | ___ |
| C2 | ___ |
| Actions on Objectives | ___ |

### Exercise 2: ATT&CK Navigator

Visit attack.mitre.org and:

1. Find three techniques for "Persistence"
   - ___
   - ___
   - ___

2. Find the data sources for T1003 (Credential Dumping)
   - ___

3. Find which groups use T1566 (Phishing)
   - ___

### Exercise 3: Pyramid of Pain Application

Classify these IOCs by Pyramid level:

| Indicator | Pyramid Level |
|-----------|---------------|
| File hash MD5:abc123... | ___ |
| Domain: evil.example.com | ___ |
| IP: 192.168.1.100 | ___ |
| "Attacker uses PowerShell to download" | ___ |
| "Attacker modifies registry Run key" | ___ |
| "Mimikatz.exe" | ___ |

---

## 4. Reflection Check

### Framework Understanding
1. Why is breaking the chain at "Delivery" better than breaking it at "Actions on Objectives"?

2. You see an attacker at "Lateral Movement." What should you expect next?

3. Why is ATT&CK preferred over Kill Chain for detailed defensive planning?

### Strategic Thinking
1. Your organization detects attackers by IP address. Using the Pyramid of Pain, how resilient is this detection?

2. An incident report mentions a specific malware hash. Why is sharing the *technique* more valuable than sharing the hash?

3. You're prioritizing detection development. Should you focus on APT28's techniques or generic scripts? Why?

---

## 5. Key Misconceptions

**MYTH: "Kill Chain is outdated"**
REALITY: Kill Chain provides strategic overview. ATT&CK provides tactical detail. Both are valuable and complementary.

**MYTH: "If we detect C2, we've caught them early"**
REALITY: C2 is phase 6 of 7. They've already compromised systems and established persistence.

**MYTH: "ATT&CK covers everything attackers do"**
REALITY: ATT&CK documents known techniques. New techniques are constantly emerging.

**MYTH: "We should collect all IOCs from threat intel"**
REALITY: Hash-based IOCs have minimal value (Pyramid bottom). Focus on technique-based detection.

**MYTH: "All attackers follow the Kill Chain sequentially"**
REALITY: Attackers iterate, skip steps, and loop back. Kill Chain is a model, not a strict sequence.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Recite** and explain the seven Kill Chain phases
2. **Navigate** MITRE ATT&CK for techniques, groups, and data sources
3. **Apply** the Pyramid of Pain to prioritize detection
4. **Map** real attacks to frameworks
5. **Use** frameworks for intelligence sharing

---

## 7. Further Depth (Optional)

*   **Resource:** MITRE ATT&CK Navigator for visualization
*   **Research:** Specific APT group profiles on ATT&CK
*   **Practice:** Map a real breach report to Kill Chain + ATT&CK
*   **Framework:** Study the Unified Kill Chain (extended model)
