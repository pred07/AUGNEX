# Types of Logs (System, Application, Security)

## 1. Orientation

### What this module covers
This module categorizes the major log types—System, Application, and Security logs. Understanding what each type contains and where to find it is essential for effective investigation and monitoring.

### Fit in the Learning Path
When investigating an incident, you need to know where to look. Different events are recorded in different logs. Looking in the wrong place wastes critical time.

### Learning Objectives
By the end of this module, you will:
*   Distinguish between system, application, and security logs
*   Map events to their appropriate log sources
*   Understand log formats and locations
*   Navigate logs efficiently during investigations

---

## 2. Core Content

### Mental Model: The Three Pillars

**How professionals think about this:**
Each log type answers different questions. System logs answer "Is the infrastructure healthy?", Security logs answer "Who did what?", Application logs answer "How did the software behave?"

```
THE LOG PILLARS:

┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│   SYSTEM LOGS               SECURITY LOGS           APPLICATION    │
│   "The Engine"              "The Bouncer"            LOGS          │
│                                                     "The User"      │
│   ┌─────────────┐          ┌─────────────┐        ┌─────────────┐  │
│   │ Hardware    │          │ Auth events │        │ App errors  │  │
│   │ Drivers     │          │ Access logs │        │ User actions│  │
│   │ Services    │          │ Privileges  │        │ Transactions│  │
│   │ Kernel      │          │ Policy      │        │ API calls   │  │
│   └─────────────┘          └─────────────┘        └─────────────┘  │
│         │                        │                      │          │
│         ▼                        ▼                      ▼          │
│   Did system                Did someone              Did user      │
│   work correctly?           break rules?             action work?  │
│                                                                     │
│   Examples:                 Examples:                Examples:      │
│   - Service start           - Login success          - DB query     │
│   - Disk error              - Login failure          - HTTP request │
│   - Memory alert            - File access            - Error 500    │
│   - Driver load             - Privilege use          - API call     │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### System Logs

**What system logs capture:**

| Event Category | Examples | Security Relevance |
|----------------|----------|-------------------|
| **Hardware** | Disk errors, memory failures | Availability attacks, hardware tampering |
| **Drivers** | Driver loads/failures | Rootkit installation detection |
| **Services** | Start, stop, crash | Persistence mechanism detection |
| **Kernel** | Panics, OOMs, security modules | Kernel exploits, stability attacks |
| **Boot** | Startup sequence | Bootkit detection |
| **Networking** | Interface up/down, DHCP | Network reconnaissance |

**Linux system logs:**

```
LINUX SYSTEM LOG LOCATIONS:

/var/log/syslog         # General system messages (Debian)
/var/log/messages       # General system messages (Red Hat)
/var/log/kern.log       # Kernel messages
/var/log/dmesg          # Boot messages
/var/log/boot.log       # Service startup
journalctl              # systemd journal (all logs)

Example entries:
Aug 15 10:00:01 server kernel: USB device attached
Aug 15 10:00:02 server systemd: nginx.service: Started
Aug 15 10:00:03 server kernel: EXT4-fs error: I/O error
```

**Windows system logs:**
```
WINDOWS SYSTEM LOG:

Location: Event Viewer → Windows Logs → System

Key Event IDs:
7045 - Service installed (persistence!)
7036 - Service started/stopped
6005 - Event log service started (boot time)
6006 - Event log service stopped (shutdown)
6008 - Unexpected shutdown
41   - System crashed
1001 - BSOD/bugcheck
```

### Security Logs

**What security logs capture:**

| Event Category | Examples | Why It Matters |
|----------------|----------|----------------|
| **Authentication** | Login success/failure | Brute force, credential theft |
| **Authorization** | Access granted/denied | Privilege abuse, IDOR |
| **Account Management** | User creation, password changes | Persistence, backdoor accounts |
| **Privilege Use** | Sudo, runas, admin actions | Privilege escalation |
| **Object Access** | File/registry access | Data theft, tampering |
| **Policy Changes** | Security settings modified | Defense evasion |

**Linux security logs:**

```
LINUX SECURITY LOG LOCATIONS:

/var/log/auth.log       # Authentication (Debian)
/var/log/secure         # Authentication (Red Hat)
/var/log/faillog        # Failed logins
/var/log/lastlog        # Last login by user
/var/log/btmp           # Bad login attempts (binary)
/var/log/wtmp           # Login records (binary)

Commands:
last                    # Show login history
lastb                   # Show failed logins
who                     # Current logins

Example entries:
Aug 15 10:00:01 server sshd[1234]: Accepted publickey for admin from 10.0.0.1
Aug 15 10:00:02 server sshd[1235]: Failed password for invalid user root from 10.0.0.2
Aug 15 10:00:03 server sudo: admin : TTY=pts/0 ; PWD=/home ; USER=root ; COMMAND=/bin/bash
```

**Windows security logs:**
```
WINDOWS SECURITY LOG:

Location: Event Viewer → Windows Logs → Security

Critical Event IDs:
4624 - Successful logon
4625 - Failed logon
4634 - Logoff
4648 - Explicit credential logon (runas)
4672 - Admin logon (special privileges)
4720 - User account created
4726 - User account deleted
4738 - User account changed
4732 - User added to local group
4756 - User added to global group
1102 - Audit log cleared (VERY suspicious)

Logon Types (in Event 4624):
2  - Interactive (keyboard)
3  - Network (file share)
4  - Batch (scheduled task)
5  - Service
7  - Unlock
10 - RemoteInteractive (RDP)
11 - CachedInteractive (offline)
```

### Application Logs

**What application logs capture:**

| Event Category | Examples | Security Relevance |
|----------------|----------|-------------------|
| **Web Server** | HTTP requests, errors | Attack detection, web exploitation |
| **Database** | Queries, connections | SQL injection, data access |
| **Email** | Send/receive, filters | Phishing, exfiltration |
| **Custom Apps** | Business logic | Application-specific attacks |
| **API** | Calls, responses | API abuse, authentication issues |

**Common application log locations:**

```
APPLICATION LOG LOCATIONS:

Web Servers:
/var/log/apache2/access.log    # Apache access
/var/log/apache2/error.log     # Apache errors
/var/log/nginx/access.log      # Nginx access
/var/log/nginx/error.log       # Nginx errors

Databases:
/var/log/mysql/mysql.log       # MySQL general
/var/log/mysql/error.log       # MySQL errors
/var/log/postgresql/           # PostgreSQL

Email:
/var/log/mail.log              # General mail
/var/log/maillog               # Red Hat mail

Example web log (Combined Log Format):
192.168.1.100 - admin [15/Aug/2024:10:00:01 +0000] "GET /admin/users HTTP/1.1" 200 4523 "https://site.com/" "Mozilla/5.0..."

Parsed:
- Client IP: 192.168.1.100
- User: admin (authenticated)
- Timestamp: 15/Aug/2024:10:00:01
- Method: GET
- Path: /admin/users
- Status: 200 (OK)
- Size: 4523 bytes
- Referrer: https://site.com/
- User-Agent: Mozilla/5.0...
```

### Log Formats

**Common formats:**

```
LOG FORMAT COMPARISON:

1. SYSLOG (Traditional)
────────────────────────
Aug 15 10:00:01 hostname process[pid]: message

Pros: Universal, human-readable
Cons: Unstructured, hard to parse programmatically


2. JSON (Modern)
────────────────────────
{"timestamp":"2024-08-15T10:00:01Z","host":"server","process":"sshd","pid":1234,"message":"login success"}

Pros: Machine-parseable, structured, extensible
Cons: More storage, harder to read raw


3. CEF (Common Event Format)
────────────────────────
CEF:0|Vendor|Product|Version|EventID|Name|Severity|keys=values

Pros: Standard for security products
Cons: Complex, specific to security use


4. CLF (Common Log Format - Web)
────────────────────────
127.0.0.1 - frank [10/Oct/2000:13:55:36 -0700] "GET /apache_pb.gif HTTP/1.0" 200 2326

Pros: Universal for web servers
Cons: Limited fields
```

### Log Correlation

**Connecting logs across systems:**

```
MULTI-LOG INVESTIGATION:

Alert: Suspicious file download

Step 1: Web proxy log (who downloaded?)
  └─► User: jsmith, URL: evil.com/malware.exe, Time: 10:00:00

Step 2: Endpoint log (what happened next?)
  └─► Process: malware.exe spawned powershell.exe, Time: 10:00:05

Step 3: Security log (privilege escalation?)
  └─► jsmith elevated to local admin, Time: 10:00:10

Step 4: Network log (C2 communication?)
  └─► Connection to 1.2.3.4:443, Time: 10:00:15

Step 5: File system log (what was accessed?)
  └─► Access to finance shares, Time: 10:01:00

CORRELATION REQUIREMENT: All timestamps align (NTP critical!)
```

---

## 3. Guided Practice

### Exercise 1: Log Source Mapping

For each event, identify the log type and specific log:

| Event | Log Type | Specific Log/Location |
|-------|----------|----------------------|
| SSH login failed | ___ | ___ |
| Apache returned 500 error | ___ | ___ |
| New Windows service installed | ___ | ___ |
| User added to Administrators group | ___ | ___ |
| Disk I/O error | ___ | ___ |
| SQL query failed | ___ | ___ |

### Exercise 2: Log Reading

Parse this Linux auth log entry:

```
Aug 15 10:30:45 web01 sshd[12345]: Failed password for invalid user admin from 192.168.1.100 port 54321 ssh2
```

- Timestamp: ___
- Hostname: ___
- Process: ___
- Event: ___
- User: ___
- Source IP: ___

### Exercise 3: Windows Event Analysis

For Windows Event ID 4624, answer:

- What event is this? ___
- Logon Type 3 means: ___
- Logon Type 10 means: ___
- Where do you find this log? ___

---

## 4. Reflection Check

### Log Understanding
1. A web app is being attacked with SQL injection. Which log would show the attack payloads?

2. You suspect a new service was installed for persistence. Which log type and event would you check?

3. Why is JSON format preferred over traditional syslog for modern systems?

### Practical Thinking
1. An investigation needs data from 5 different log sources. What makes this difficult?

2. Application logs are often developer-designed. What common problems do security teams face with them?

3. How do you investigate an event when the application doesn't log the relevant data?

---

## 5. Key Misconceptions

**MYTH: "Security logs have everything I need"**
REALITY: Security logs cover authentication and access. Many attacks leave traces in system or application logs.

**MYTH: "All logs are the same format"**
REALITY: Every system and application can have different formats. Normalization is required for analysis.

**MYTH: "Application logs are only for developers"**
REALITY: Application logs often contain attack signatures, error messages revealing injection, and business logic violations.

**MYTH: "More log sources always helps"**
REALITY: Without correlation and normalization, more logs can create more confusion, not clarity.

**MYTH: "Windows Event IDs are intuitive"**
REALITY: Event IDs require memorization or reference. 4624 = login success; 4625 = login failure (similar numbers, different meanings).

---

## 6. Completion Criteria

This module is complete when you can:

1. **Distinguish** between system, security, and application logs
2. **Map** events to their appropriate log sources
3. **Navigate** common log locations (Linux and Windows)
4. **Parse** log entries in common formats
5. **Understand** the need for log correlation

---

## 7. Further Depth (Optional)

*   **Practice:** Investigate a simulated incident across multiple log sources
*   **Tool:** Learn log parsing with tools like grep, awk, and jq
*   **Reference:** Create a cheat sheet of critical Windows Event IDs
*   **Research:** Log format standards (CEF, LEEF, JSON-LD)
