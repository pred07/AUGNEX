# Open-Source Intelligence (OSINT) Fundamentals

## 1. Orientation

### What this module covers
This module dives deep into OSINT—the art of extracting intelligence from publicly available sources. We focus on advanced Google dorking, metadata extraction, social media intelligence, and the systematic approach to OSINT that professionals use to build comprehensive target profiles.

### Fit in the Learning Path
Hackers don't always attack infrastructure—they attack information gaps. Finding a password in a PDF metadata, leaked credentials in a code repo, or an employee's personal email can bypass all technical controls.

### Learning Objectives
By the end of this module, you will:
*   Construct advanced Google dorks for targeted intelligence
*   Extract and analyze metadata from files
*   Gather social media intelligence systematically
*   Understand the legal and ethical boundaries of OSINT

---

## 2. Core Content

### Mental Model: The Information Ecosystem

**How professionals think about this:**
Organizations leak information constantly through documents, social media, job postings, and forgotten infrastructure. OSINT practitioners systematically harvest these data points to build attack paths.

```
THE OSINT INTELLIGENCE CYCLE:

┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  1. REQUIREMENTS                                                    │
│     └── What do I need to know?                                     │
│         - Network infrastructure?                                   │
│         - Employee names/emails?                                    │
│         - Technology stack?                                         │
│         - Credentials?                                              │
│                                                                     │
│  2. COLLECTION                                                      │
│     └── Where can I find it?                                        │
│         - Search engines                                            │
│         - Social media                                              │
│         - Code repositories                                         │
│         - Data breaches                                             │
│                                                                     │
│  3. PROCESSING                                                      │
│     └── Organize raw data into usable format                        │
│                                                                     │
│  4. ANALYSIS                                                        │
│     └── What does this mean?                                        │
│         - Connect the dots                                          │
│         - Identify attack paths                                     │
│         - Assess reliability                                        │
│                                                                     │
│  5. DISSEMINATION                                                   │
│     └── Document and share findings                                 │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### Advanced Google Dorking

**Operators reference:**

| Operator | Purpose | Example |
|----------|---------|---------|
| `site:` | Limit to domain | `site:company.com` |
| `filetype:` | Specific file types | `filetype:pdf` |
| `inurl:` | URL contains | `inurl:admin` |
| `intitle:` | Page title contains | `intitle:"login"` |
| `intext:` | Page body contains | `intext:"password"` |
| `cache:` | Cached version | `cache:company.com` |
| `"..."` | Exact phrase | `"internal use only"` |
| `-` | Exclude term | `site:company.com -www` |
| `*` | Wildcard | `admin*.company.com` |
| `OR` | Boolean OR | `filetype:pdf OR filetype:doc` |
| `AROUND(X)` | Words near each other | `password AROUND(5) admin` |

**Dork categories:**

```
INFRASTRUCTURE DISCOVERY:
─────────────────────────
site:company.com intitle:"index of"
site:company.com filetype:xml inurl:sitemap
site:company.com inurl:robots.txt
site:company.com "powered by" OR "running"


CREDENTIAL HUNTING:
─────────────────────────
site:company.com filetype:txt password
site:company.com filetype:env
site:company.com "api_key" OR "apikey" OR "api-key"
site:pastebin.com "company.com" password
site:github.com "company.com" password

SENSITIVE DOCUMENTS:
─────────────────────────
site:company.com filetype:pdf "confidential"
site:company.com filetype:doc "internal only"
site:company.com filetype:xls "employee"
site:company.com filetype:ppt "strategy"

ADMINISTRATION INTERFACES:
─────────────────────────
site:company.com inurl:admin
site:company.com inurl:login
site:company.com inurl:portal
site:company.com intitle:"admin panel"
site:company.com intitle:"dashboard"

ERROR MESSAGES / DEBUG:
─────────────────────────
site:company.com "error" filetype:php
site:company.com "warning" "mysql"
site:company.com "stack trace"
site:company.com "debug" OR "development"
```

**Automated dork tools:**
```bash
# Google Hacking Database (GHDB)
# https://www.exploit-db.com/google-hacking-database

# Pagodo - Passive Google Dork
python3 pagodo.py -d company.com -g dorks.txt

# DorkSearch
dorksearch -d company.com
```

### Metadata Extraction

**What metadata reveals:**

| File Type | Potential Metadata |
|-----------|-------------------|
| **Documents** | Author name, company, software version, edit history |
| **Images** | Camera model, GPS coordinates, date/time |
| **PDFs** | Author, creation tool, embedded files |
| **Videos** | Camera, location, encoding software |

**Using ExifTool:**
```bash
# Image metadata
exiftool image.jpg

# Common findings:
# GPS Position: 40.7128 N, 74.0060 W
# Author: John.Smith
# Software: Adobe Photoshop 2023
# Create Date: 2024:01:15 10:30:45

# Document metadata
exiftool document.pdf

# Common findings:
# Creator: Microsoft Word for Office 365
# Author: jsmith
# Company: Target Corp
# ModifyDate: 2024:01:10 09:15:22

# Recursive extraction
exiftool -r -csv /path/to/files > metadata.csv
```

**FOCA (Fingerprinting Organizations with Collected Archives):**
```
FOCA WORKFLOW:

1. Download all public documents
   - site:company.com filetype:pdf
   - site:company.com filetype:doc
   
2. Extract metadata automatically
   
3. Discover:
   - Internal usernames → Email addresses
   - Software versions → Vulnerability research
   - Server names → Network topology
   - Printer names → Physical locations
```

### Social Media Intelligence (SOCMINT)

**Platform-specific intelligence:**

| Platform | Intelligence Available |
|----------|----------------------|
| **LinkedIn** | Employees, roles, technologies, org structure |
| **Twitter/X** | Real-time events, opinions, relationships |
| **Facebook** | Personal info, photos, check-ins |
| **Instagram** | Photos, locations, metadata |
| **GitHub** | Code, secrets, developer identities |

**LinkedIn research:**
```
LINKEDIN INTELLIGENCE EXTRACTION:

1. EMPLOYEE ENUMERATION
   - Search: "Target Company" employees
   - Result: Names, titles, locations
   
2. TECHNOLOGY STACK
   - Search: "Target Company" + "engineer"
   - Look at skills sections
   - Result: They use AWS, Kubernetes, Python
   
3. SECURITY TEAM GAPS
   - Search: "Target Company" + "security"
   - Check job postings
   - Result: "Hiring SOC analyst" = understaffed
   
4. EMAIL FORMAT
   - Find one email (from breach data)
   - john.smith@company.com
   - Apply pattern to all names
```

**Twitter/X reconnaissance:**
```bash
# Search tweets from a company
from:companyaccount keyword

# Search by hashtag
#companyname breach OR hack OR vulnerability

# Find employees
"works at Target Company" twitter

# Tools: Twint (if still working), SNSCrape
```

### Code Repository Intelligence

**GitHub hunting:**
```
GITHUB SEARCH OPERATORS:

# Find credentials
company.com password
company.com api_key
company.com aws_secret

# Find configuration
filename:.env company
filename:config company.com
filename:wp-config

# Find by organization
org:companyname password
user:knowndevname password
```

**GitDorker automation:**
```bash
# Automated GitHub dorking
python3 gitdorker.py -tf tokens.txt -d dorks.txt -org company

# TruffleHog - find secrets in repos
trufflehog github --org=company

# GitLeaks - scan for secrets
gitleaks detect --source=/path/to/repo
```

### Breach Data Investigation

**Ethical considerations:**
- Checking IF data was breached: Legitimate research
- Using actual credentials: Likely criminal (without authorization)
- Report findings to client as vulnerability

**Breach checking services:**

| Service | Purpose |
|---------|---------|
| **Have I Been Pwned** | Check if email in breaches |
| **DeHashed** | Searchable breach database |
| **Intelligence X** | Historical breach data |

```bash
# Check if email is in breaches
# Use HIBP API or web interface

# Understanding breach data:
# - Validates email addresses exist
# - Shows password complexity (hashed vs plain)
# - Credential stuffing risk assessment
```

### OSINT Workflow and Documentation

**Systematic approach:**

```
OSINT INVESTIGATION TEMPLATE:

TARGET: [Company Name]
DATE: [Investigation Date]
SCOPE: [What we're looking for]

1. DOMAIN INTELLIGENCE
   - Primary domains: 
   - Subdomains found:
   - IP ranges:

2. EMPLOYEE INFORMATION
   - Names/Roles:
   - Email format:
   - Key personnel:

3. TECHNOLOGY STACK
   - Front-end:
   - Back-end:
   - Cloud providers:
   - Security tools:

4. DOCUMENT ANALYSIS
   - Files downloaded:
   - Metadata extracted:
   - Authors identified:

5. CREDENTIAL EXPOSURE
   - Breaches found:
   - Passwords (Y/N):
   - Risk assessment:

6. ATTACK SURFACE NOTES
   - Entry points identified:
   - Phishing targets:
   - Infrastructure weaknesses:
```

### Legal and Ethical Boundaries

**What's legal:**
- Searching public search engines
- Viewing publicly accessible websites
- Downloading public documents
- Reading public social media

**Gray areas:**
- Terms of service violations (automated scraping)
- Privacy concerns (combining data sources)
- Data protection laws (GDPR, CCPA)

**What's illegal:**
- Accessing accounts without authorization
- Using leaked credentials
- Social engineering under false pretenses
- Harassment or stalking

---

## 3. Guided Practice

### Exercise 1: Google Dorking

Construct dorks to find:

| Target | Your Dork |
|--------|-----------|
| PDF files from nasa.gov | ___ |
| Login pages with "admin" in URL | ___ |
| Directory listings on any site | ___ |
| SQL errors on any site | ___ |
| GitHub commits with "password" | ___ |

### Exercise 2: Metadata Extraction

Download a sample PDF and extract metadata:

```bash
# Find a public PDF
# site:nasa.gov filetype:pdf

# Download and analyze
wget [url] -O sample.pdf
exiftool sample.pdf
```

Record findings:
- Author: ___
- Creator software: ___
- Creation date: ___
- Other interesting fields: ___

### Exercise 3: OSINT Framework Use

Visit osintframework.com and identify tools for:

| Purpose | Tools Available |
|---------|----------------|
| Username search | ___ |
| Email validation | ___ |
| Phone number lookup | ___ |
| Image reverse search | ___ |

---

## 4. Reflection Check

### Technique Understanding
1. A company regularly posts job listings for "AWS Security Engineer with Terraform experience." What intelligence does this provide?

2. You find a PDF from the target with author "jsmith." How do you turn this into an email address?

3. Google dorking returns no results for passwords. Does this mean the company is secure?

### Ethical Thinking
1. You find leaked credentials for an employee of your client. What do you do with them?

2. Is it legal to create a fake LinkedIn profile to connect with target employees?

3. You discover the CEO's personal Facebook is public and shows vacation photos with location tags. Ethical to use?

---

## 5. Key Misconceptions

**MYTH: "Google finds everything on the internet"**
REALITY: Google only indexes a fraction of the web. Deep web, authenticated pages, and blocked sites aren't indexed.

**MYTH: "Old information is useless"**
REALITY: Metadata from old documents still reveals usernames. Old credentials may still work. Old infrastructure may still exist.

**MYTH: "Public information isn't valuable"**
REALITY: Aggregated public information becomes powerful intelligence. Combined data points reveal attack paths.

**MYTH: "OSINT is passive and always legal"**
REALITY: Some OSINT techniques (scraping, fake accounts) may violate ToS or laws. Know your boundaries.

**MYTH: "Metadata was stripped before publishing"**
REALITY: Most organizations don't strip metadata. Even "clean" documents often have revealing data.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Construct** effective Google dorks for various intelligence needs
2. **Extract** and analyze metadata from documents and images
3. **Investigate** social media profiles for relevant intelligence
4. **Check** breach databases ethically and legally
5. **Document** OSINT findings systematically

---

## 7. Further Depth (Optional)

*   **Resource:** OSINT Framework (osintframework.com) - comprehensive tool index
*   **Practice:** Complete a full OSINT investigation on a bug bounty target
*   **Tool:** Master Maltego for visual link analysis
*   **Training:** SANS SEC487 OSINT course materials
