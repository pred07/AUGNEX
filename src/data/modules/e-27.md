# Server-Side Request Forgery (SSRF)

## 1. Unit Brief: The Server is Your Proxy
SSRF tricks the server into making a request on your behalf. Since the request comes from a trusted internal server, it can bypass firewalls that block *you*.

## 2. Real-World Relevance
*   **Capital One Breach**: An SSRF vulnerability allowed access to the AWS Metadata Service, stealing credentials for S3 buckets.

## 3. Core Concepts

### Trust Boundaries
The firewall allows traffic from `Internal Web Server` to `Internal Database` or `Cloud Metadata`. It blocks traffic from `Internet`.
*   **Attack**: You tell the Web Server "Hey, fetch this URL for me".
*   "This URL" is `http://internal-database:admin`.
*   Web Server fetches it and shows you the result.

### Cloud Metadata Services
*   AWS/GCP/Azure use a magic IP `169.254.169.254` to give instances keys.
*   If you can force the server to curl this IP, you get the keys.

## 4. Practical Examples

### Port Scanning the Intranet
Feature: "Enter URL to import avatar".
*   Input: `http://localhost:22` -> Response "SSH-2.0..." (Port Open).
*   Input: `http://localhost:3306` -> Response "MySQL..." (Port Open).
*   Input: `http://192.168.1.5:80` -> Scan the internal network.

### AWS Metadata Theft
Input: `http://169.254.169.254/latest/meta-data/iam/security-credentials/`
*   **Result**: Returns the IAM Role name.
*   Follow up: `.../security-credentials/ROLE_NAME` -> Returns AccessKey, SecretKey, Token.

## 5. Common Mistakes Beginners Make
*   **Blind SSRF**: The server makes the request but doesn't show you the response.
    *   **Fix**: Use a "Collaborator" URL (DNS bin) to prove the server verified your link.
*   **Confusing SSRF and CSRF**: SSRF attacks the Server. CSRF attacks the User.

## 6. Key Takeaways
*   **Cloud Killer**: In cloud environments, SSRF is often a Critical/P0 vulnerability.
*   **Internal Access**: It turns an external pentest into an internal one.
