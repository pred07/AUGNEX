# Writing YARA Rules for Hunting

## 1. Orientation

### What this module covers
YARA is the "Pattern Matching Swiss Army Knife" for malware researchers. It allows you to create rules based on text or binary patterns to classify malware files.

### Learning Objectives
*   Write a basic **YARA Rule** (Strings, Conditions).
*   Use **Hex Strings** and **Wildcards**.
*   Hunt with YARA in **VirusTotal Intelligence**.

---

## 2. Core Content

### Anatomy of a Rule
```yara
rule Suspicious_PDF {
    meta:
        author = "Sentinel"
        description = "Detects PDFs with embedded EXE"
    strings:
        $magic = { 25 50 44 46 } // %PDF in Hex
        $exe_header = "This program cannot be run in DOS mode"
    condition:
        $magic at 0 and $exe_header
}
```

### Key Concepts
1.  **Strings:** The "What". Text (`"bad.com"`) or Hex (`{ E2 34 ?? C8 }`).
2.  **Condition:** The "Logic". (`3 of them`, `$a and not $b`, `filesize < 500KB`).
3.  **Efficiency:** Bad rules (short strings) slow down scanning. Don't search for "The".

### Usage
*   **Endpoint Scanning:** Run YARA against disk to find sleeping malware.
*   **Memory Scanning:** Run YARA against RAM to find beacons.
*   **Hunting:** Upload YARA to VT to get notified when *new* malware matches your rule.

---

## 3. Lab: Writing a Signature
**Sample:** Access to `malware.exe`.
**Analysis:** Contains string "HackedByGodzilla".
**Rule:**
```yara
rule Godzilla_Variant {
    strings:
        $s1 = "HackedByGodzilla" nocase
    condition:
        $s1 and filesize < 1MB
}
```

---

## 4. Completion Criteria
1.  **Write** a rule to detect the string "Cmd.exe" inside a file.
2.  **Explain** the `at 0` condition (Anchoring to start of file).
