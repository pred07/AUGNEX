# Active Directory Enumeration Techniques

## 1. Unit Brief: Drawing the Map
You are on a domain-joined PC. You are a regular user. You want to be Domain Admin. First, you must find where the Domain Admins are hiding.

## 2. Real-World Relevance
Without enumeration, you are guessing. With enumeration, you know exactly which server the CEO is logged into.

## 3. Core Concepts

### PowerView / SharpHound
Tools designed to query LDAP and map the domain.
*   **BloodHound**: Visualizes the path to Domain Admin. "User A -> Can Reset Password of User B -> Has RDP Access to Server C -> Domain Admin is Logged in there."

### Key Queries
*   **Get-NetUser**: List all users.
*   **Get-NetGroupMember "Domain Admins"**: Who is the target?
*   **Get-NetComputer**: List all servers.
*   **Find-LocalAdminAccess**: Where am I admin?

## 4. Practical Examples

### BloodHound
1.  Run `SharpHound.exe`. It collects a `.zip` file.
2.  Upload zip to BloodHound GUI.
3.  Query: "Shortest Path to Domain Admins".
4.  Graph: You see that the "Backup Service" account is a Domain Admin, and you can reset its password because of a misconfigured ACL.

### SPN Scanning (Kerberoasting prep)
Scanning for Service Principal Names.
`GetUserSPNs.ps1`
*   Finds service accounts (SQL, IIs). These accounts are vulnerable to offline cracking (Kerberoasting).

## 5. Common Mistakes Beginners Make
*   **Generating too much traffic**: Running BloodHound on a massive network can generate gigabytes of LDAP traffic, alerting the SOC. Use "Stealth" modes.
*   **Assuming you need exploits**: 90% of AD hacking is abusing legitimate features, not using exploits ("Living off the Land").

## 6. Key Takeaways
*   **Graph Theory**: AD is a graph of relationships.
*   **LDAP**: Identify the valuable objects.
