# Validating Authentication Visibility

## 1. Orientation

### What this module covers
This module covers testing your eyes. Can you actually *see* a login?

### Fit in the Learning Path
"Identity is the Perimeter." If you are blind here, game over.

### Learning Objectives
By the end of this module, you should understand:
*   **Source Validation** (From where?).
*   **Type Validation** (Interactive vs Network).
*   **Token Validation** (Pass-the-Hash).

---

## 2. Core Content

### The Test Plan
1.  **Local vs Domain**: `.\Administrator` vs `CORP\Administrator`. Do logs distinguish?
2.  **Protocol**: RDP (GUI) vs SMB (File Share) vs WinRM (PowerShell).
3.  **Failure**: Do you see the *reason*? (Bad Password vs Expired Account vs Locked Out).

### Pass-the-Hash (PtH)
*   **Attack**: Using the NTLM Hash to auth, not the password.
*   **Log**: Event ID 4624. Logon Type 3 (Network). Key Length 0.
*   *Validation*: Run Mimikatz PtH. Check Splunk. Do you see the anomaly?

---

## 3. Guided Practice

### Simulating a Spray
**Action**: Run a Password Spray (1 password against 100 users).

**Validation**:
*   **Firewall**: Sees 100 connections.
*   **DC Security Log**: Sees 100 Event 4625s.
*   **SIEM**: *Should* aggregate this into "Password Spray Detected".
    *   If it shows 100 separate alerts -> **Failure** (Alert Fatigue).
    *   If it shows 1 alert -> **Success**.

---

## 4. Reflection Check

1.  **Kerberos**: Do you log Ticket requests? (Event 4768/4769). Essential for Golden Ticket detection.
2.  **Service Accounts**: If a Service Account logs in interactively (Type 10), is that weird? (Yes! Service accounts are for services, not humans. Alert on Type 10).
3.  **Cloud**: Do you sync Azure AD logs? (If you only watch On-Prem, you miss the Office 365 breach).

---

## 5. Completion Criteria

This module is complete when:
1.  You can differentiate **Logon Types** (2, 3, 10).
2.  You have validated that **Password Spraying** triggers a smart alert.
3.  You ensure **Service Account** anomalies are detected.
