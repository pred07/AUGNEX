# SIGMA Rules for Detection

## 1. Orientation

### What this module covers
YARA is for *files*. SIGMA is for *logs*. SIGMA is a generic signature format that can be converted into Splunk SPL, Elastic Query, or Microsoft Sentinel KQL. It is the industry standard for sharing detection logic.

### Learning Objectives
*   Understand the **SIGMA Format** (YAML).
*   Write a rule for **Process Creation**.
*   Convert SIGMA to **SIEM Queries**.

---

## 2. Core Content

### The Problem
*   Analyst A uses Splunk.
*   Analyst B uses ELK.
*   Twitter shares: "Detect `whoami` running as SYSTEM."
*   Solution: Write logic in SIGMA. Convert for A and B.

### Rule Structure (YAML)
```yaml
title: Whoami Execution
status: experimental
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image|endswith: '\whoami.exe'
    condition: selection
level: low
```

### Key Fields
*   **Logsource:** Where to look (Windows, Sysmon, Linux).
*   **Detection:** The logic (Keywords, Maps).
*   **Condition:** Boolean logic (`selection1 and not filter`).

---

## 3. Lab: Writing a Rule
**Threat:** User runs `vssadmin delete shadows` (Ransomware behavior).
**SIGMA:**
```yaml
detection:
    selection:
        Image|endswith: '\vssadmin.exe'
        CommandLine|contains: 'delete shadows'
    condition: selection
```
**Deploy:** Convert to Splunk: `index=windows Image="*vssadmin.exe" CommandLine="*delete shadows*"`

---

## 4. Completion Criteria
1.  **Differentiate** SIGMA vs YARA. (Logs vs Files).
2.  **Explain** "Process Creation" log source.
