# Threat Hunting: Hypothesis-Driven Analysis

## 1. Orientation

### What this module covers
Threat Hunting is **proactive**. Instead of waiting for an alert (Reactive), you assume you are already breached and look for evidence. This requires the **Scientific Method**: Observation -> Hypothesis -> Test -> Conclusion.

### Learning Objectives
*   Differentiate between Alerting (SOC) and Hunting.
*   Formulate a testable Hypothesis.
*   Execute a Hunt using SIEM/EDR data.

---

## 2. Core Content

### The Hunting Loop
1.  **Hypothesis:** "I bet attackers are using PowerShell to download malware."
2.  **Investigate:** Generic query for `powershell.exe` making network connections.
3.  **Uncover patterns:** Filter out admin scripts. Find the anomaly.
4.  **Enrich:** Check hashes, IPs.
5.  **Automate:** If you find something, turn that search into a Detection Rule (SIGMA) so you don't have to hunt for it again.

### Hypothesis Generation
Good hypotheses come from verified Intelligence methods:
*   **Intelligence Driven:** "New Intel says APT29 uses `rundll32` for execution. Do we see that?"
*   **Situational Awareness:** "We just merged with Company X. Their network is likely dirty."
*   **Domain Expertise:** "Our payment portal is our crown jewel. How would I hack it?"

### Data Sources
*   **Endpoint:** Process creation, Command line arguments.
*   **Network:** DNS queries, Long connections (beacons).
*   **Auth:** Failed logins, lateral movement patterns (4624 type 3).

---

## 3. Lab: The PowerShell Hunt

### Scenario
Hypothesis: "Attackers are using encoded PowerShell commands to hide."

**Query:**
Search specific logs for ` -enc ` or ` -encodedcommand `.

**Refinement:**
Many admins use base64 encoding legitimately. 
*   *New Filter:* Length > 1000 characters.
*   *New Filter:* Exclude known Service Accounts.

**Findings:**
You find a user account `bob` running a 5000-character encoded string at 3 AM. **Confirmed Incident.**

---

## 4. Reflection
1.  Why is "Show me all bad things" a bad hypothesis? (It's not specific. You need to look for *specific behaviors*).
2.  If a Hunt finds nothing, is it a failure? (No. It proves that *specific* attack vector is likely not present, increasing confidence in security).
