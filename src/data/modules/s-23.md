# The Diamond Model of Intrusion Analysis

## 1. Orientation

### What this module covers
While the Kill Chain focuses on *process*, the Diamond Model focuses on *relationships*. Every intrusion event has four core features: **Adversary, Victim, Infrastructure, and Capability**. Mapping these points helps cluster activity into campaigns.

### Learning Objectives
*   Draw the Diamond Model.
*   Pivot between vertices to discover new intel.
*   Group events to identify a Campaign.

---

## 2. Core Content

### The Vertices
```
      Adversary
      /       \
Infrastructure Capability
      \       /
       Victim
```

1.  **Adversary:** Who is attacking? (Email address, Handle).
2.  **Victim:** Who is being attacked? (Network, Person, Asset).
3.  **Infrastructure:** What are they using to connect? (IP, Domain, Email Server).
4.  **Capability:** What tools are they using? (Malware, Exploit, TTP).

### The Pivot
The power of the model is moving from one known point to an unknown point.
*   *Example:* You know the **Capability** (A specific malware hash). You analyze it and find a C2 **Infrastructure** (IP). You query Passive DNS for that IP and find a new **Adversary** email registered to it.

### Meta-Features
*   **Timestamp:** When did it happen?
*   **Phase:** Where in the Kill Chain?
*   **Result:** Success/Failure?

---

## 3. Lab: Diamond Clustering

### Scenario
You have 3 incidents.

*   **Incident A:** Victim=Finance, Infra=1.2.3.4, Cap=DarkComet.
*   **Incident B:** Victim=HR, Infra=1.2.3.4, Cap=DarkComet.
*   **Incident C:** Victim=Engineering, Infra=5.6.7.8, Cap=CobaltStrike.

**Analysis:**
*   Incidents A and B share **Infrastructure** and **Capabilities**. They are likely the same **Adversary** (Campaign 1).
*   Incident C shares nothing. It is likely a different **Adversary** (Campaign 2).

---

## 4. Reflection
1.  How does the Diamond Model help in attribution? (It mathematically links victims and capabilities to infrastructure, which is often the bridge to the adversary's identity).
2.  Can you have the Diamond Model without an Adversary? (Yes. Most of the time the "Adversary" top vertex is unknown/blank at the start of an investigation).
