# Business Logic Vulnerabilities

## 1. Orientation

### What this module covers
This module revisits logic flaws with a focus on **Workflow Bypass** and **Rules Evasion**. "Hacking the process, not the code."

### Fit in the Learning Path
These bugs have no CVEs. Scanners cannot find them. They require you to understand the *business*.

### Learning Objectives
By the end of this module, you should understand:
*   **Workflow Bypass**.
*   **Trusted Client** fallacy.
*   **Price Manipulation**.

---

## 2. Core Content

### Workflow Bypass
Intended: A -> B -> C -> D.
Attack: A -> D.
*   Example: Skipping the "Payment" step and going straight to "Download Receipt".

### Trusted Client
The server trusts the data sent by the browser too much.
*   Example: Making a decision based on a cookie `is_vip=false`.

---

## 3. Guided Practice

### Analyzing an Order Flow
1.  **Add to Cart**: `POST /cart/add`.
2.  **Checkout**: `GET /checkout`.
3.  **Confirm**: `POST /order/confirm` (Validates Payment).
4.  **Success**: `GET /order?id=100`.

**Attack Ideas**:
*   Can I call `/order/confirm` with an empty cart?
*   Can I capture the request for `/order?id=100`, drop the Confirm step, and replay it?
*   Can I modify the currency? `price=100&currency=ZimbweanDollars`?

---

## 4. Reflection Check

1.  **Documentation**: Why is reading the Help/FAQ page useful for a hacker? (It tells you how the business logic *should* work, spotting deviations).
2.  **Limits**: If the site says "Max 2 per customer", can I enforce that with client-side JS? (No. I can just replay the request 100 times via Burp).
3.  **Impact**: Logic bugs often lead to financial loss, not system takeover. Which is worse? (Financial loss often hurts the company more immediately).

---

## 5. Completion Criteria

This module is complete when:
1.  You stop looking for syntax errors and start looking for logic gaps.
2.  You treat every "Step" in a process as optional until proven mandatory.
3.  You can articulate a "Workflow Bypass".
