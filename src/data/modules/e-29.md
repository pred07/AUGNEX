# Business Logic Vulnerabilities

## 1. Unit Brief: Valid Logic, Invalid Result
Business logic errors are flaws in the design, not the code. The code works "as intended," but the intention was wrong. Automated scanners **cannot** find these. Human intuition is required.

## 2. Real-World Relevance
*   **E-Commerce**: Buying an item for $0.01.
*   **Banking**: Transferring negative money `transfer(-100)` to add money to your account.
*   **Gaming**: Skipping the cooldown timer by repeating the generic API call.

## 3. Core Concepts

### Workflow Bypass
*   Intended: Step 1 (Cart) -> Step 2 (Pay) -> Step 3 (Ship).
*   Attack: Step 1 (Cart) -> Step 3 (Ship).
*   Flaw: Step 3 didn't check if Step 2 was completed successfully.

### Race Conditions (TOCTOU)
"Time of Check, Time of Use".
*   You click "Use Coupon" twice in 1 millisecond.
*   Thread A checks: Coupon Valid? Yes.
*   Thread B checks: Coupon Valid? Yes.
*   Thread A applies discount.
*   Thread B applies discount.
*   Result: Double discount.

## 4. Practical Examples

### The Negative Price
E-shop POST request:
`{"item": "ps5", "quantity": 1, "price": 500}`
*   **Attack**: Change price to `0` or `1`.
*   **Result**: If the server trusts the client-side price, you got a cheap PS5.

### Parameter Tampering
`POST /update_profile`
`user_id=100&subscription=free`
*   **Attack**: Change to `subscription=premium`.
*   **Result**: Free upgrade.

## 5. Common Mistakes Beginners Make
*   **Relying on Tools**: Burp Scanner won't find this. You have to understand the business. "What happens if I skip this step?"
*   **Thinking "They must have blocked this"**: They probably didn't.

## 6. Key Takeaways
*   **Think like a scammer**: How can I profit? How can I get free stuff?
*   **Scanners are blind here**: This is where manual pentesting shines.
