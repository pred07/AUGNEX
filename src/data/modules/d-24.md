# Process, File, and Registry Monitoring

## 1. Unit Brief: Deep Dive on Artifacts
Where do hackers hide? How do they survive reboots? The answers are in the Process list, the File system, and the Registry.

## 2. Real-World Relevance
*   **Rootkits**: Hide processes from the Task Manager.
*   **Time Stomping**: Modifying file timestamps to look old (blending in with OS files).

## 3. Core Concepts

### Process Hollowing
*   Hacker starts `notepad.exe` (Suspended).
*   Hacker empties the memory of Notepad.
*   Hacker injects virus code.
*   Hacker resumes Notepad.
*   **Result**: Task manager shows "Notepad", but it's actually malware.

### Registry Keys of Interest
*   **Auto-Start**: `Run`, `RunOnce`.
*   **Services**: `HKLM\SYSTEM\CurrentControlSet\Services`.
*   **Winlogon Helper**: `Userinit`.

## 4. Practical Examples

### Detecting Masquerading
*   **File**: `svchost.exe`.
*   **Location**: `C:\Users\Bob\svchost.exe`.
*   **Alert**: REAL svchost only runs from `C:\Windows\System32`.
*   **Conclusion**: Malware masquerading as a system process.

### Hashing Files
*   You find `suspicious.dll`.
*   Compare its Hash with known good Windows DLLs.
*   Mismatch = Altered/Malicious.

## 5. Common Mistakes Beginners Make
*   **Trusting Names**: "It's called `winupdate.exe`, so it must be valid." Check the Digital Signature!
*   **Ignoring Temp folders**: `C:\Windows\Temp` and `%APPDATA%` are favorite hiding spots for malware.

## 6. Key Takeaways
*   **Know your Home**: know what a clean Windows system looks like. (What processes run at boot? From where?).
*   **Signatures**: verify valid Microsoft Signatures.
