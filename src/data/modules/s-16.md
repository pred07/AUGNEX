# SIGMA: Generic Log Signatures

## 1. Orientation

### What this module covers
While YARA matches *files*, SIGMA matches *logs*. SIGMA is the open standard for SIEM rules. You write a rule in SIGMA, and it can be converted to Splunk (SPL), Elastic (KQL), or Microsoft Sentinel queries.

### Learning Objectives
*   Understand the YAML structure of a SIGMA rule.
*   Map Sigma fields to Windows Event Logs.
*   Convert a Sigma rule to a Splunk query.

---

## 2. Core Content

### The Problem
You have a generic detection: "Detect PowerShell downloading a file." 
*   Your Splunk Syntax: `index=winlog EventCode=4104 ...`
*   Your Client's Elastic Syntax: `event.code: 4104 AND process.name: powershell ...`
*   **Solution:** Write *one* SIGMA rule, convert to both.

### Rule Structure (YAML)
```yaml
title: Suspicious PowerShell Download
id: 1234-5678
status: experimental
description: Detects usage of Net.WebClient in PowerShell
logsource:
    product: windows
    service: powershell
detection:
    selection:
        EventID: 4104
        ScriptBlockText|contains:
            - 'System.Net.WebClient'
            - 'DownloadFile'
    condition: selection
level: medium
```

### Key Parsers
*   `selection`: The logic to match (AND logic by default within a list).
*   `condition`: specific logic (e.g., `selection1 and not selection2`).

---

## 3. Lab: Breaking the Query

### Task
Translate this English requirement into SIGMA logic:
"Detect any process clearing the Security Event Log (Event ID 1102)."

**Sigma Draft:**
```yaml
logsource:
    product: windows
    service: security
detection:
    selection:
        EventID: 1102
    condition: selection
```

**Splunk Output:** `index=wineventlog EventCode=1102`

---

## 4. Reflection
1.  Why is SIGMA called the "YARA of Logs"? (It standardizes detection logic independent of the backend tool).
2.  Where can you find pre-written Sigma rules? (The SigmaHQ GitHub repository is the main source).
