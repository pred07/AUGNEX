# CVE, CVSS, and Risk Context

## 1. Orientation

### What this module covers
This module explains how the security industry tracks, identifies, and scores vulnerabilities. Understanding CVE identifiers and CVSS scoring is essential for effective communication, prioritization, and professional reporting.

### Fit in the Learning Path
When you discover a vulnerability, you need to communicate it professionally. "I found a bad thing" is useless. "CVE-2021-44228 (Log4Shell), CVSS 10.0, actively exploited" tells everyone exactly what you found and how serious it is.

### Learning Objectives
By the end of this module, you will:
*   Decode and use CVE identifiers
*   Understand CVSS scoring components and calculations
*   Distinguish between technical severity and actual risk
*   Apply context to vulnerability prioritization

---

## 2. Core Content

### Mental Model: The Vulnerability Language

**How professionals think about this:**
CVE provides the dictionary (naming), CVSS provides the ruler (measuring). Together they create a common language for discussing vulnerabilities across organizations, tools, and reports.

```
THE VULNERABILITY IDENTIFICATION SYSTEM:

┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  VULNERABILITY DISCOVERED                                           │
│          │                                                          │
│          ▼                                                          │
│  ┌───────────────────────────────────────────────────────────────┐ │
│  │                    CVE ASSIGNMENT                              │ │
│  │                                                                │ │
│  │  CVE-YYYY-NNNNN                                                │ │
│  │  │    │    │                                                   │ │
│  │  │    │    └── Sequence number (arbitrary)                     │ │
│  │  │    └────── Year disclosed (not year discovered)             │ │
│  │  └─────────── Prefix (always CVE)                              │ │
│  │                                                                │ │
│  │  Example: CVE-2021-44228 (Log4Shell)                           │ │
│  └───────────────────────────────────────────────────────────────┘ │
│          │                                                          │
│          ▼                                                          │
│  ┌───────────────────────────────────────────────────────────────┐ │
│  │                    CVSS SCORING                                │ │
│  │                                                                │ │
│  │  Score: 0.0 - 10.0                                             │ │
│  │  Rating: None / Low / Medium / High / Critical                 │ │
│  │                                                                │ │
│  │  Example: CVE-2021-44228 = CVSS 10.0 (Critical)                │ │
│  └───────────────────────────────────────────────────────────────┘ │
│          │                                                          │
│          ▼                                                          │
│  ┌───────────────────────────────────────────────────────────────┐ │
│  │                    RISK ASSESSMENT                             │ │
│  │                                                                │ │
│  │  CVSS + Context = Actual Risk                                  │ │
│  │  - Is asset internet-facing?                                   │ │
│  │  - Is exploit available?                                       │ │
│  │  - Is it being exploited in the wild?                          │ │
│  │  - What's the business impact?                                 │ │
│  └───────────────────────────────────────────────────────────────┘ │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### CVE: The Universal Identifier

**CVE structure:**
```
CVE-2021-44228

CVE  - Constant prefix (Common Vulnerabilities and Exposures)
2021 - Year the CVE was assigned (not discovered or patched)
44228 - Sequence number (no significance, just unique)
```

**Key CVE databases:**

| Resource | URL | Content |
|----------|-----|---------|
| **NVD** | nvd.nist.gov | US government database with CVSS |
| **MITRE** | cve.mitre.org | Original CVE authority |
| **CVE Details** | cvedetails.com | Statistics and search |
| **Vulners** | vulners.com | Aggregated intelligence |
| **Exploit-DB** | exploit-db.com | CVEs with exploit code |

**Important CVEs to know:**

| CVE | Name | Impact |
|-----|------|--------|
| CVE-2017-0144 | EternalBlue | WannaCry ransomware |
| CVE-2017-5638 | Struts | Equifax breach |
| CVE-2021-44228 | Log4Shell | Universal Java RCE |
| CVE-2019-19781 | Citrix | VPN gateway RCE |
| CVE-2021-34527 | PrintNightmare | Windows print RCE |
| CVE-2014-0160 | Heartbleed | OpenSSL memory leak |
| CVE-2014-6271 | Shellshock | Bash RCE |

### CVSS: The Scoring System

**CVSS 3.1 Components:**

```
CVSS SCORING BREAKDOWN:

┌─────────────────────────────────────────────────────────────────────┐
│                    BASE SCORE (Intrinsic properties)                │
│                                                                     │
│  EXPLOITABILITY METRICS:                                            │
│  ├── Attack Vector (AV): N/A/L/P                                    │
│  │   Network > Adjacent > Local > Physical                          │
│  ├── Attack Complexity (AC): L/H                                    │
│  │   Low > High                                                     │
│  ├── Privileges Required (PR): N/L/H                                │
│  │   None > Low > High                                              │
│  └── User Interaction (UI): N/R                                     │
│      None > Required                                                │
│                                                                     │
│  IMPACT METRICS:                                                    │
│  ├── Confidentiality (C): H/L/N                                     │
│  │   High > Low > None                                              │
│  ├── Integrity (I): H/L/N                                           │
│  │   High > Low > None                                              │
│  └── Availability (A): H/L/N                                        │
│      High > Low > None                                              │
│                                                                     │
│  SCOPE (S): U/C                                                     │
│  Unchanged / Changed (affects other components)                     │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

**Understanding the vector string:**

```
FULL VECTOR STRING EXAMPLE:

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H = 9.8

Decoded:
CVSS:3.1  - Version 3.1
AV:N      - Attack Vector: Network (remote)
AC:L      - Attack Complexity: Low (easy)
PR:N      - Privileges Required: None (unauthenticated)
UI:N      - User Interaction: None (no click needed)
S:U       - Scope: Unchanged
C:H       - Confidentiality Impact: High (read all data)
I:H       - Integrity Impact: High (modify all data)
A:H       - Availability Impact: High (crash system)

This is nearly the worst case: Remote + Easy + No Auth + Full Impact
```

**Score ranges:**

| Score | Rating | Typical Action |
|-------|--------|----------------|
| 0.0 | None | Information only |
| 0.1-3.9 | Low | Fix when convenient |
| 4.0-6.9 | Medium | Fix in next patch cycle |
| 7.0-8.9 | High | Prioritize fix |
| 9.0-10.0 | Critical | Emergency patching |

### Temporal and Environmental Scores

**Beyond base score:**

```
TEMPORAL METRICS (Time-based factors):

Exploit Code Maturity (E):
├── Not Defined (X) - Unknown
├── Unproven (U) - No exploit exists
├── Proof of Concept (P) - Demo exists
├── Functional (F) - Working exploit
└── High (H) - Weaponized, wormable

Remediation Level (RL):
├── Not Defined (X)
├── Official Fix (O) - Patch available
├── Temporary Fix (T) - Workaround exists
├── Workaround (W) - Mitigation only
└── Unavailable (U) - No fix exists

Report Confidence (RC):
├── Not Defined (X)
├── Unknown (U) - Uncertain
├── Reasonable (R) - Probable
└── Confirmed (C) - Verified


ENVIRONMENTAL METRICS (Your context):

Confidentiality Requirement (CR): L/M/H
Integrity Requirement (IR): L/M/H
Availability Requirement (AR): L/M/H

Impact modifications based on your asset's importance.
```

### CVSS vs Real-World Risk

**The context problem:**

```
CVSS SCORE VS ACTUAL RISK:

SCENARIO 1:
  CVE: CVSS 9.8 (Critical)
  Context: Affects internal test server, no sensitive data, not internet-facing
  ACTUAL RISK: Low

SCENARIO 2:
  CVE: CVSS 6.5 (Medium)
  Context: Affects payment processing, internet-facing, exploit in the wild
  ACTUAL RISK: Critical

SCENARIO 3:
  CVE: CVSS 10.0 (Critical)
  Context: Affects vendor software you don't use
  ACTUAL RISK: Zero (not applicable)
```

**Risk factors beyond CVSS:**

| Factor | Impact on Risk |
|--------|----------------|
| **Internet exposure** | Increases risk dramatically |
| **Exploit availability** | Active exploitation = urgent |
| **Asset criticality** | Crown jewels vs test systems |
| **Data sensitivity** | PII/PHI vs marketing content |
| **Compensating controls** | WAF, segmentation may mitigate |
| **Attack surface** | How many systems affected |

### Vulnerability Prioritization Frameworks

**EPSS (Exploit Prediction Scoring System):**
```
EPSS predicts likelihood of exploitation within 30 days

EPSS Score: 0.0 - 1.0 (probability)

Example:
  CVE-2023-12345: CVSS 9.8, EPSS 0.001 (0.1% chance of exploit)
  CVE-2023-67890: CVSS 6.5, EPSS 0.950 (95% chance of exploit)

Which should you prioritize first? The 6.5 with high EPSS!
```

**CISA KEV (Known Exploited Vulnerabilities):**
```
KEV = CVEs confirmed exploited in the wild

If CVE is in KEV:
  - Someone is actively exploiting it RIGHT NOW
  - Federal agencies must patch within deadline
  - Private sector should treat as urgent
```

**Risk-based prioritization:**
```
PRIORITIZATION MATRIX:

                    HIGH CVSS           LOW CVSS
              ────────────────────────────────────────
              │ CRITICAL          │  MEDIUM         │
   EXPLOIT    │ Patch immediately │  Prioritize     │
   AVAILABLE  │ Everything else   │  based on asset │
              │ waits             │                 │
              ├───────────────────┼─────────────────┤
              │ HIGH              │  LOW            │
   NO         │ Schedule for      │  Include in     │
   EXPLOIT    │ next patch cycle  │  regular cycle  │
              │                   │                 │
              ────────────────────────────────────────
```

---

## 3. Guided Practice

### Exercise 1: CVE Lookup

Look up these CVEs on NVD and record:

| CVE | Product | CVSS Score | Vector |
|-----|---------|------------|--------|
| CVE-2021-44228 | ___ | ___ | ___ |
| CVE-2017-0144 | ___ | ___ | ___ |
| CVE-2019-19781 | ___ | ___ | ___ |

### Exercise 2: CVSS Calculation

Use the NVD CVSS Calculator to score this vulnerability:

*"A remote attacker can send a crafted HTTP request to a web server, without authentication, to execute arbitrary commands. The attack requires the victim to be running a specific configuration."*

- Attack Vector: ___
- Attack Complexity: ___
- Privileges Required: ___
- User Interaction: ___
- Impact (C/I/A): ___
- Calculated Score: ___

### Exercise 3: Risk Contextualization

For each scenario, adjust the risk level:

| Scenario | CVSS | Context | Actual Risk |
|----------|------|---------|-------------|
| 9.8 | Internal-only HR app, no sensitive data | ___ |
| 7.5 | Internet-facing login portal, exploit available | ___ |
| 5.5 | Core database server, critical data | ___ |

---

## 4. Reflection Check

### Scoring Understanding
1. A CVE has CVSS 10.0. Does this mean you're definitely vulnerable?

2. Why might a CVSS 6.5 vulnerability be more urgent than a CVSS 9.0?

3. The Attack Complexity is "High." What does this mean for the attacker?

### Practical Application
1. Your scanner reports 3,500 vulnerabilities. How do you prioritize?

2. A vendor says their CVE is "only 5.5 CVSS, not serious." How do you evaluate this?

3. CISA adds a CVE to the KEV catalog. What should this trigger in your organization?

---

## 5. Key Misconceptions

**MYTH: "CVSS 10.0 means we're definitely compromised"**
REALITY: CVSS measures technical severity, not whether you're exploited. Check if you're even running the affected software.

**MYTH: "Low CVSS means low priority"**
REALITY: CVSS ignores context. A "low" vulnerability on critical infrastructure may be high priority.

**MYTH: "We should patch all Criticals before any Mediums"**
REALITY: A Medium with active exploitation beats a Critical with no exploit code.

**MYTH: "CVE year indicates when the bug was introduced"**
REALITY: CVE year indicates when the CVE was assigned, not when the bug was created or discovered.

**MYTH: "Scanners accurately assess vulnerability risk"**
REALITY: Scanners assess technical presence. Risk requires human analysis of context.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Decode** CVE identifiers and look up vulnerability details
2. **Interpret** CVSS vectors and calculate/understand scores
3. **Distinguish** between technical severity and actual risk
4. **Apply** context to prioritize vulnerabilities
5. **Use** EPSS and KEV for exploitation intelligence

---

## 7. Further Depth (Optional)

*   **Tool:** Practice with NVD CVSS Calculator
*   **Resource:** CISA Known Exploited Vulnerabilities Catalog
*   **Framework:** Study EPSS for probability-based prioritization
*   **Practice:** Review a real vulnerability scan and prioritize findings
