# Logging Requirements from an Attackerâ€™s View

## 1. Orientation

### What this module covers
This module inverts the logic. Instead of "What *should* we log?", we ask "What does the attacker *hope* we don't log?"

### Fit in the Learning Path
Attackers thrive in the dark. Identification of "Anti-Forensics" capabilities is key to defensive engineering.

### Learning Objectives
By the end of this module, you should understand:
*   **The Golden Hour**: The time before logs are shipped.
*   **Granularity**: Why "Success/Fail" isn't enough.
*   **Tampering**.

---

## 2. Core Content

### The Attacker's Checklist
1.  **Can I clear the logs?** (`wevtutil cl Security`).
    *   *Counter*: Remote Log Forwarding (WORM storage).
2.  **Does the log show arguments?**
    *   *Hope*: Log says "PowerShell ran".
    *   *Fear*: Log says "PowerShell ran `c:\evil.ps1`". (Script Block Logging).
3.  **Is log rotation fast?**
    *   *Tactic*: Flood the log with garbage to overwrite the evidence of the breach.

---

## 3. Guided Practice

### The "Silent" Valid User
**Attack**: RDP Login with stolen credentials.
**Log**: Event ID 4624 (Successful Login).
**Attacker's Hope**: You ignore it because it looks like a valid user.

**Purple Team Validation**:
1.  Log in as "Bob" from a weird IP.
2.  Does the SIEM alert?
    *   No? -> **Gap**.
    *   Fix: Alert on "Geo-velocity" impossibility.

---

## 4. Reflection Check

1.  **Volume**: Can an attacker cause a Denial of Service on the SIEM? (Yes. By generating millions of logs. Rate limiting at the collector is needed).
2.  **Encryption**: If the attacker uses SSL, does the log see the payload? (No. Just the connection. You need SSL Inspection logs).
3.  **Blindness**: If you don't log "Process Creation", you are effectively blind to 90% of malware.

---

## 5. Completion Criteria

This module is complete when:
1.  You prioritize **Script Block Logging** (PowerShell).
2.  You verify that **Log Clearing** triggers a Critical Alert (Event ID 1102).
3.  You understand that logs are the attacker's primary threat.
