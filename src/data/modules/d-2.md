# SOC Structure and Operations

## 1. Orientation

### What this module covers
This module examines the structure, operations, and challenges of Security Operations Centers (SOCs). You will understand how SOCs process massive data volumes into actionable intelligence, how triage works at scale, why playbooks are essential, and what makes SOC operations effective versus dysfunctional.

### Fit in the Learning Path
Building on the overview of defensive roles (Module 1), this module focuses specifically on the operational engine of defense—the SOC. Understanding SOC operations is essential whether you're planning to work in one, build one, or (as a red teamer) attack organizations that have one.

### Learning Objectives
By the end of this module, you will:
*   Understand the triage funnel and why volume reduction is the core challenge
*   Explain the tiered analyst structure and escalation paths
*   Recognize the role of playbooks in consistent, scalable response
*   Identify common SOC failure modes and how to address them

---

## 2. Core Content

### Mental Model: The Signal-to-Noise Problem

**How professionals think about this:**
The SOC's fundamental challenge is extracting signal from overwhelming noise. A medium-sized organization generates billions of log events daily. The SOC must reduce this to the handful of actual security incidents that require action—without missing real attacks.

```
THE TRIAGE FUNNEL:

┌─────────────────────────────────────────────────────────────────────┐
│                     RAW EVENTS: 1,000,000,000/day                  │
│                  (Every log, every packet, every action)           │
└───────────────────────────────┬─────────────────────────────────────┘
                                │ Normalization, correlation
                                ▼
┌─────────────────────────────────────────────────────────────────────┐
│                        ALERTS: 10,000/day                          │
│                   (Rules triggered, anomalies flagged)             │
└───────────────────────────────┬─────────────────────────────────────┘
                                │ T1 Triage (false positive filtering)
                                ▼
┌─────────────────────────────────────────────────────────────────────┐
│                        INVESTIGATIONS: 100/day                     │
│                      (Analyst reviews warranted)                   │
└───────────────────────────────┬─────────────────────────────────────┘
                                │ T2 Analysis (context, correlation)
                                ▼
┌─────────────────────────────────────────────────────────────────────┐
│                        INCIDENTS: 5/day                            │
│                      (Confirmed security events)                   │
└───────────────────────────────┬─────────────────────────────────────┘
                                │ T3/IR (response, containment)
                                ▼
┌─────────────────────────────────────────────────────────────────────┐
│                        LESSONS LEARNED                             │
│                  (Detection improvement, process updates)          │
└─────────────────────────────────────────────────────────────────────┘
```

### The Tiered Analyst Model

Most SOCs use a tiered structure for efficiency and skill development:

**Tier 1: Alert Triage**
- **Primary function:** Initial alert review, false positive filtering
- **Volume:** Handles highest volume of alerts
- **Skills:** Tool proficiency, playbook execution, pattern recognition
- **Escalation to T2:** When alert requires deeper analysis
- **Time per alert:** 5-15 minutes

**Tier 2: Investigation**
- **Primary function:** Deep analysis, correlation, threat hunting
- **Volume:** Fewer cases, more depth
- **Skills:** Log analysis, threat intelligence, forensic thinking
- **Escalation to T3/IR:** When confirmed incident
- **Time per case:** 30 minutes to hours

**Tier 3: Expert/Incident Response**
- **Primary function:** Complex investigations, incident handling, advanced threats
- **Volume:** Few cases, maximum depth
- **Skills:** Advanced forensics, malware analysis, incident management
- **Escalation:** To management, legal, external IR firms
- **Time per incident:** Hours to days

```
ESCALATION FLOW:

         ┌─────────────┐
         │   ALERT     │
         └──────┬──────┘
                │
         ┌──────▼──────┐
         │   TIER 1    │──────► CLOSE (False Positive)
         │   Triage    │
         └──────┬──────┘
                │ (Needs investigation)
         ┌──────▼──────┐
         │   TIER 2    │──────► CLOSE (Benign activity)
         │  Analysis   │
         └──────┬──────┘
                │ (Confirmed incident)
         ┌──────▼──────┐
         │   TIER 3    │──────► INCIDENT RESPONSE
         │   Expert    │        (Contain, eradicate, recover)
         └─────────────┘
```

### The Reality of SOC Work

**Alert volume challenge:**
- Enterprise SOC: 10,000+ alerts per day
- Each analyst can meaningfully handle 50-100 alerts per shift
- Math problem: More alerts than analysts can process

**Solutions to volume:**
1. **Automation:** SOAR platforms auto-close known false positives
2. **Tuning:** Reduce false positive rates at alert generation
3. **Prioritization:** Focus human attention on high-severity alerts
4. **Enrichment:** Auto-add context to reduce research time

**The false positive tax:**
Every false positive wastes analyst time. If 90% of alerts are false positives, 90% of analyst effort is wasted. Alert tuning is critical operations work.

### Playbooks: Standardized Response

**Why playbooks exist:**
- Humans under stress make inconsistent decisions
- New analysts need guidance
- Complex procedures can't be remembered under pressure
- Compliance requires documented processes

**Playbook structure:**

```
PLAYBOOK: Ransomware Detection

TRIGGER: EDR alert "Ransomware behavior detected"

STEP 1: Verify alert
  - Check if file is known ransomware (VirusTotal hash lookup)
  - Check process ancestry (did Word spawn suspicious binary?)
  - Check for encryption behavior (file system monitoring)

STEP 2: Containment decision
  □ IF confirmed ransomware:
    - Isolate endpoint immediately (network disconnect)
    - Notify T3/IR lead
    - Initiate backup verification
  □ IF uncertain:
    - Escalate to T2 with findings
    - Do NOT isolate yet

STEP 3: Documentation
  - Log all actions in case management system
  - Preserve evidence for investigation
```

**Playbook categories:**
- **Alert triage:** How to handle specific alert types
- **Incident response:** How to contain specific threats
- **Escalation:** When and how to involve others
- **Communication:** Who to notify, what to say

### SOC Technologies

**Core technology stack:**

| Technology | Purpose | Examples |
|------------|---------|----------|
| **SIEM** | Log aggregation, correlation, alerting | Splunk, Sentinel, QRadar |
| **SOAR** | Automation, orchestration, response | Palo Alto XSOAR, Splunk SOAR |
| **EDR** | Endpoint visibility, detection, response | CrowdStrike, SentinelOne, Defender |
| **NDR** | Network traffic analysis, detection | Darktrace, ExtraHop, Zeek |
| **TIP** | Threat intelligence management | MISP, ThreatConnect |
| **Case Management** | Ticket tracking, investigation workflow | ServiceNow, TheHive |

**Data sources feeding the SOC:**
- Firewall logs
- Web proxy logs
- Email security logs
- Authentication logs (AD, LDAP, IdP)
- Endpoint telemetry (EDR)
- Cloud audit logs (AWS CloudTrail, Azure Activity)
- Application logs
- DNS logs
- Network flow data

### 24/7 Operations

**Why 24/7 matters:**
Attackers don't respect business hours. APT groups often operate during target's off-hours. Ransomware deploys at 2 AM. The SOC must always be watching.

**Shift models:**

| Model | Structure | Pros | Cons |
|-------|-----------|------|------|
| **Follow-the-sun** | Centers in multiple time zones | Normal hours, no burnout | Coordination complexity |
| **Traditional shifts** | 8-hour shifts at one location | Simple | Nights are hard to staff |
| **12-hour shifts** | 2-2-3 rotation | Fewer handoffs | Long shifts |

**Handoff procedures:**
- Document active investigations
- Brief incoming shift on priorities
- Ensure coverage of ongoing incidents
- Transfer context, not just tickets

### SOC Maturity Levels

**Level 1: Reactive**
- Responds to alerts when they occur
- Limited proactive capability
- High false positive rate
- Manual processes

**Level 2: Managed**
- Documented playbooks
- Regular alert tuning
- Some automation
- Metrics tracking

**Level 3: Proactive**
- Active threat hunting
- Threat intelligence integration
- SOAR automation
- Detection engineering practice

**Level 4: Optimizing**
- Continuous improvement cycle
- Purple team exercises
- Advanced analytics/ML
- Measured detection coverage

### Common SOC Failure Modes

**Alert fatigue:**
- Too many alerts
- Too many false positives
- Analysts become desensitized
- Real threats missed in the noise

**Tool tunnel vision:**
- Over-reliance on single tool
- Missing threats the tool doesn't detect
- No manual investigation capability

**Skill stagnation:**
- Analysts only execute playbooks
- No growth in critical thinking
- Unable to handle novel threats

**Coverage gaps:**
- Logs not collected
- Assets unknown
- Cloud environments unmonitored
- Shadow IT invisible

**Solutions:**
| Problem | Solution |
|---------|----------|
| Alert fatigue | Aggressive tuning, automation, prioritization |
| Tool tunnel vision | Multiple detection layers, threat hunting |
| Skill stagnation | Training, rotation, hunting exercises |
| Coverage gaps | Asset inventory, log audit, cloud integration |

---

## 3. Guided Practice

### Exercise 1: Alert Triage Decision

**Alert:** Failed login for user 'admin' (500 attempts in 1 minute, source IP: 185.220.101.x)

Walk through the triage:

1. **Initial assessment:** What type of attack is this? ___
2. **Context check:** What additional information do you need? ___
3. **TI lookup:** 185.220.101.x is a known Tor exit node. How does this change your assessment? ___
4. **Success check:** The 501st attempt was successful. How do you proceed? ___
5. **Response action:** What immediate action do you take? ___

### Exercise 2: Playbook Development

Create a basic playbook for this alert:

**Alert type:** "Impossible travel" (same user authenticated from two countries within 1 hour)

```
PLAYBOOK: Impossible Travel Alert

TRIGGER: ___

STEP 1: Initial assessment
  - ___
  - ___

STEP 2: Investigation
  - ___
  - ___

STEP 3: Decision tree
  □ IF legitimate (VPN, traveling):
    - ___
  □ IF anomalous:
    - ___

STEP 4: Documentation
  - ___
```

### Exercise 3: SOC Metrics

You're designing a SOC dashboard. Which metrics would you track?

| Category | Metric | Why It Matters |
|----------|--------|----------------|
| Volume | ___ | ___ |
| Efficiency | ___ | ___ |
| Quality | ___ | ___ |
| Coverage | ___ | ___ |

---

## 4. Reflection Check

### Operational Thinking
1. Your SOC has 10,000 alerts per day and 5 analysts. Each analyst can handle 100 alerts per shift. What's wrong with this math, and how do you fix it?

2. An analyst reports that 95% of alerts from the firewall are false positives. Is this a success or a problem?

3. At 2 AM, a T1 analyst sees an alert they've never encountered. The playbook doesn't cover it. What should they do?

### Strategic Thinking
1. Why do organizations struggle to staff night shifts? What are the trade-offs of different solutions?

2. A vendor claims their AI will reduce your SOC to 2 people. Why should you be skeptical?

3. How do you measure if a SOC is actually effective at stopping real threats (not just processing alerts)?

---

## 5. Key Misconceptions

**MYTH: "More alerts = better security"**
REALITY: More alerts create fatigue. Focused, high-fidelity alerts are better than high-volume noise.

**MYTH: "SIEM is the security"**
REALITY: SIEM is infrastructure. Security comes from analysts who use it effectively.

**MYTH: "T1 is 'junior' work that doesn't matter"**
REALITY: T1 is the front line. If T1 misses something, T2/T3 never see it. T1 decisions matter enormously.

**MYTH: "Automation will replace analysts"**
REALITY: Automation handles volume. Analysts handle complexity, judgment, and novelty.

**MYTH: "If we have a SOC, we're protected"**
REALITY: Poorly run SOCs provide false confidence. Effectiveness depends on people, process, and technology.

---

## 6. Completion Criteria

This module is complete when you can:

1. **Draw** the triage funnel and explain volume reduction
2. **Describe** the tiered analyst model and escalation path
3. **Explain** why playbooks are essential for consistent response
4. **Identify** common SOC failure modes and their solutions
5. **List** core SOC technologies and their purposes

---

## 7. Further Depth (Optional)

*   **Reading:** "The Practice of Network Security Monitoring" by Richard Bejtlich
*   **Framework:** Review MITRE D3FEND for defensive capabilities
*   **Practice:** Set up a home SIEM (Elastic SIEM, Wazuh) and process your own logs
*   **Research:** Compare SOC maturity models (CMMI, SOC-CMM)
