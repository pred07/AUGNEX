# Secure Coding Principles

## 1. Orientation

### What this module covers
Security is not just about breaking; it's about building. "Shift Left" means addressing security early in the SDLC. This module covers the universal principles of writing secure code, regardless of the language.

### Learning Objectives
*   Understand the CIA Triad in code.
*   Master Input Validation (Sanitization).
*   Master Output Encoding.
*   Apply the Principle of Least Privilege.

---

## 2. Core Content

### The Root of All Evil: Untrusted Input
Most web vulnerabilities (SQLi, XSS, Command Injection) stem from the same mistake: **Trusting user input.**

**Vulnerable Code (Python):**
```python
import os
user_input = input("Enter IP to ping: ")
os.system("ping " + user_input)
```
*   *Exploit:* Input `127.0.0.1; rm -rf /`

### Defensive Strategy 1: Input Validation
Assert that input matches expectations *before* processing.
*   **Allow-listing (Good):** "Only allow a-z, 0-9".
*   **Block-listing (Bad):** "Block the word 'script'". (Attackers will bypass with 'ScRipt').

**Secure Code:**
```python
import re
if not re.match(r"^[0-9\.]+", user_input):
    raise ValueError("Invalid IP format")
```

### Defensive Strategy 2: Parameterization
Never treat data as executable code. 
*   **SQL Injection:** Use Prepared Statements (`?` or `%s` placeholders) instead of string concatenation.

### Defensive Strategy 3: Output Encoding
When displaying data back to a user, convert special characters to HTML entities.
*   `<script>` becomes `&lt;script&gt;`.
*   This neutralizes Cross-Site Scripting (XSS).

---

## 3. Lab: Code Review

### Task
Identify the flaw in this PHP snippet:
```php
$id = $_GET['id'];
$query = "SELECT * FROM users WHERE id = " . $id;
```
*   **Flaw:** String concatenation allows SQL Injection.
*   **Fix:** Use `PDO` with prepared statements `prepare('SELECT * FROM users WHERE id = :id')`.

---

## 4. Reflection
1.  Why is Client-Side validation (JS) insufficient? (Attackers can bypass the browser and send requests directly via Burp Suite).
2.  Whose responsibility is secure code? (Every developer, not just the security team).
