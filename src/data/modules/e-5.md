# Threat Modeling and Attack Surface Mapping

## 1. Unit Brief: Thinking Like the Enemy
Threat modeling is the process of identifying potential threats and prioritizing them. Attack Surface Mapping is identifying every possible way into the system. Combined, they define *where* you will attack.

## 2. Real-World Relevance
You cannot secure (or hack) what you do not know exists.
*   **Defender**: "We patched the main website."
*   **Attacker**: "I entered through the forgotten marketing portal on a subdomain from 2018."
The marketing portal was part of the **Attack Surface** that the defender missed.

## 3. Core Concepts

### Attack Surface
The sum of all points where an unauthorized user can try to enter data or extract data from an environment.
*   **Digital**: Open ports (SSH, RDP), Web Forms, APIs, Email inputs.
*   **Physical**: Unlocked doors, discarded hard drives.
*   **Social**: Employees (Phishing targets).

### Threat Modeling Frameworks
*   **STRIDE**: Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, Elevation of Privilege.
*   **DREAD**: Damage, Reproducibility, Exploitability, Affected Users, Discoverability. (Used for scoring).

## 4. Practical Examples

### Mapping the Surface (Recon)
Target: `bank.com`

1.  **Subdomains**: `api.bank.com`, `dev.bank.com`, `mail.bank.com`.
2.  **IP Blocks**: 192.168.10.0/24.
3.  **Ports**: 80, 443, 22 (SSH Open?), 3389 (RDP Open?).
4.  **Technologies**: Nginx, PHP 7.4, WordPress.

**High Risk Identified**: `dev.bank.com` is running an old version of WordPress. This is the "path of least resistance."

### Terminal Context: Visualizing the Surface
Tools like `amass` or `nmap` help build this map.

```bash
$ nmap -p- --min-rate 1000 target.com
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
3306/tcp open  mysql
8080/tcp open  http-proxy
```
*   **Analysis**: The Attack Surface consists of 4 entry points.
    *   SSH: Brute force? Key theft?
    *   HTTP (80/8080): Web exploits?
    *   MySQL (3306): Exposed DB? Weak creds?

## 5. Common Mistakes Beginners Make
*   **Going "Deep" too fast**: Spending 10 hours attacking the fortified main Login page while leaving the `test.php` file on the same server unchecked.
*   **Ignoring Informational Findings**: "Server version header" seems useless, but if it reveals an unpatched version, it's critical intel.

## 6. Key Takeaways
*   **The Chain Link**: Security is only as strong as the weakest link. Finding the weakest link (Attack Surface Mapping) is 80% of the battle.
*   **Context Matters**: A vulnerability on a test server might be low risk, unless that test server has credentials to the production database.
