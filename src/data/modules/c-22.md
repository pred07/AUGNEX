# Endpoint Telemetry for Detection Testing

## 1. Orientation

### What this module covers
This module covers using **EDR** data for Purple Teaming.

### Fit in the Learning Path
The Endpoint is where the action is. You need to ensure your EDR sees the *technique*, not just the *file*.

### Learning Objectives
By the end of this module, you should understand:
*   **Event Tracing for Windows (ETW)**.
*   **Sysmon Config**.
*   **Telemetry Blindspots**.

---

## 2. Core Content

### ETW (Event Tracing for Windows)
The nervous system of Windows. EDRs hook into this.
*   **Test**: Run an activity (e.g., DNS Query).
*   **Verify**: Did the EDR catch the ETW provider event?

### Filter Bypass
Attackers unhook EDRs.
*   *Test*: Attempt to "Unload" Sysmon driver.
*   *Alert*: Does the SIEM yell "Sysmon Terminated"? (It should).

---

## 3. Guided Practice

### The "Mimikatz" Simulation
**Command**: `sekurlsa::logonpasswords`.
**Telemetry**:
1.  `ReadProcessMemory` on `lsass.exe`.
2.  `SeDebugPrivilege` requested.

**Validation**:
If you renamed `mimikatz.exe` to `notepad.exe`, did the EDR still catch the *behavior* (reading lsass)?
*   Yes -> Robust Telemetry.
*   No -> Brittle Telemetry.

---

## 4. Reflection Check

1.  **Sampling**: Do EDRs log *every* file open? (No. Too much data. They sample or focus on specific types).
2.  **Kernel**: EDRs sit in the Kernel. If they crash, the PC crashes (BSOD). Value stability.
3.  **Tamper**: Can Admin disable EDR? (Should be password protected).

---

## 5. Completion Criteria

This module is complete when:
1.  You check **ETW** availability.
2.  You validate **Tamper Protection**.
3.  You ensure telemetry works even when variables change.
