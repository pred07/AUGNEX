# Endpoint Telemetry for Detection Testing

## 1. What this module covers
Deep dive into what EDR (Endpoint Detection & Response) agents actually see.

## 2. Why this matters for purple teams
EDR is the primary sensor for modern security. Understanding its limits is crucial.

## 3. Core concepts explained clearly

### Userland vs Kernel
*   **Userland Hooks**: EDR intercepts API calls. Attackers can "Unhook" them.
*   **Kernel Callbacks**: EDR sits in the Kernel. Harder to evade.
*   *Purple Tip*: Test if your EDR catches "Unhooking" attempts.

### Data Types
*   **Process Start/Terminate**
*   **Image Load** (DLLs)
*   **Network Connection**
*   **File Create/Modify**
*   **Registry SetValue**

## 4. Validation examples

### Image Load Events
*   **Attack**: DLL Sideloading. (Putting a malicious DLL next to a legit EXE).
*   **Validation**:
    *   Run Legit App.
    *   Query SIEM: `Event="ImageLoad" Image="LegitApp.exe" LoadedImage="Malicious.dll"`.
    *   If EDR doesn't log Image Loads, you are blind to this.

## 5. Common gaps and failures
*   **Volume suppression**: EDR agents drop logs if the volume is too high to save CPU. Attackers spam events to cause drops.
*   **Exclusions**: Admin excluded `C:\Program Files\LegacyApp` from scanning. Attacker hides malware there.

## 6. Key takeaways
*   **Config matters**: "Standard" policy vs "Strict" policy makes a huge difference.
*   **Coverage**: Ensure every behavior is logged.
