[
    {
        "id": "s-31",
        "content": "# MISP: The Malware Information Sharing Platform\n\n## 1. Orientation\n\n### What this module covers\nMISP is the de facto standard open-source TIP (Threat Intelligence Platform). It allows organizations to store, share, and correlate IoCs. If you work in CTI, you will use MISP.\n\n### Learning Objectives\n*   Understand the MISP data model (Events, Attributes, Objects).\n*   Create an **Event** and add **Attributes**.\n*   Use **Feeds** to ingest external data.\n*   Understand the **Galaxy** (Threat Actors, Tools).\n\n---\n\n## 2. Core Content\n\n### The Data Model\n1.  **Event:** The container. (e.g., \"Emotet Campaign 2024\").\n2.  **Attribute:** A single data point inside an event. (e.g., `ip-dst: 1.2.3.4`, `md5: a1b2...`).\n3.  **Object:** A complex structure. (e.g., \"File\" object containing filename, size, and hash linked together).\n4.  **Tag:** Metadata (e.g., `tlp:amber`, `misp-galaxy:tool=\"CobaltStrike\"`).\n\n### Correlation\nThe magic of MISP. If you add an IP `1.2.3.4` to Event A, and Event B (from 2 years ago) also has `1.2.3.4`, MISP automatically links them. This reveals hidden connections between campaigns.\n\n### Sharing Groups\nYou don't share everything with everyone.\n*   **Community:** Share with connected peers.\n*   **Organization:** Internal only.\n*   **Distribution Levels:** 0 (Event only), 1 (Community), 2 (Connected Communities), 3 (All).\n\n---\n\n## 3. Lab: Creating an Event\n\n### Task\nYou received a phish.\n\n1.  **Create Event:**\n    *   Date: Today.\n    *   Info: \"Internal Phishing Campaign - HR target\".\n    *   Distribution: This Organization Only.\n2.  **Add Attributes:**\n    *   `email-src`: `badguy@evil.com`\n    *   `url`: `http://login-microsoft-fake.com`\n    *   `payload-delivery`: `invoice.pdf`\n3.  **Publish:** Click \"Publish Event\". This makes it available to your API (and downstream tools like SIEM).\n\n---\n\n## 4. Reflection\n1.  Why is \"Context\" important in MISP? (An IP alone is useless. Tagging it with \"C2 Server\" and \"Active\" tells the SOC what to do).\n2.  What is a \"Warninglist\"? (A list of good indicators—like Google DNS 8.8.8.8—that MISP should warn you about if you try to add them as IoCs to prevent false positives).\n"
    },
    {
        "id": "s-32",
        "content": "# OpenCTI: Knowledge Graph Intelligence\n\n## 1. Orientation\n\n### What this module covers\nWhile MISP is great for lists of IoCs, **OpenCTI** is designed for high-level strategic analysis using a **Knowledge Graph**. It maps relationships (hypergraphs) between actors, campaigns, and TTPs.\n\n### Learning Objectives\n*   Contrast **Relational** (SQL) vs **Graph** (Neo4j) data models.\n*   Navigate the OpenCTI visualizer.\n*   Import data from STIX II connectors.\n\n---\n\n## 2. Core Content\n\n### The Graph Model\n*   **Node:** An entity (Malware, Region, Actor).\n*   **Edge:** The relationship (`targets`, `uses`, `located_in`).\n*   *Query:* \"Show me all Actors who `target` the Energy Sector AND `use` Mimikatz.\"\n\n### Connectors\nOpenCTI relies on an ecosystem of connectors:\n*   **Import:** Pull from MISP, AlienVault, CrowdStrike.\n*   **Enrichment:** Send IP to VirusTotal and update the Node.\n*   **Stream:** Push data to Splunk/Elastic.\n\n### Visualization\nThe \"Investigate\" view allows analysts to drag and drop entities to see second and third-order links. \n*   *Example:* Actor A -> targets -> Company B. Company B -> partner of -> Company C. (Risk to Company C?).\n\n---\n\n## 3. Lab: Graphing the Attack\n\n### Scenario\nMap the following in OpenCTI (Mental Exercise):\n\n1.  **Entity:** APT28 (Intrusion Set).\n2.  **Entity:** XAgent (Malware).\n3.  **Entity:** Ukraine (Location).\n4.  **Relationships:**\n    *   APT28 `uses` XAgent.\n    *   APT28 `targets` Ukraine.\n\n**Inference:**\nIf you see XAgent in Germany, you might infer APT28 is expanding targets.\n\n---\n\n## 4. Reflection\n1.  Why is OpenCTI heavier to run than MISP? (It uses ElasticSearch, Redis, MinIO, and RabbitMQ. It is a full Enterprise Data Platform).\n2.  How does passing data from MISP to OpenCTI work? (MISP handles the raw IoCs; OpenCTI handles the strategic \"Story\" and links).\n"
    },
    {
        "id": "s-33",
        "content": "# STIX 2.1 & TAXII\n\n## 1. Orientation\n\n### What this module covers\nFor different tools (Firewall, SIEM, TIP) to talk, they need a common language. **STIX** (Structured Threat Information Expression) is the JSON schema. **TAXII** (Trusted Automated Exchange of Intelligence Information) is the transport protocol (HTTPS API).\n\n### Learning Objectives\n*   Read a **STIX JSON** object.\n*   Understand the **SDO** (Stix Domain Objects) architecture.\n*   Connect a TAXII client to a server.\n\n---\n\n## 2. Core Content\n\n### STIX Objects (SDOs)\n1.  **Indicator:** The pattern to look for. (`[ipv4-addr:value = '1.2.3.4']`).\n2.  **Observed Data:** The fact that it was seen.\n3.  **Threat Actor:** The adversary.\n4.  **Campaign:** The grouping of activity.\n5.  **Relationship:** The link (`source_ref`, `target_ref`, `relationship_type`).\n\n### JSON Example\n```json\n{\n  \"type\": \"indicator\",\n  \"id\": \"indicator--8e2e2d2b...\",\n  \"created\": \"2024-01-01T00:00:00Z\",\n  \"pattern\": \"[file:hashes.'SHA-256' = 'a1b2...']\",\n  \"pattern_type\": \"stix\",\n  \"valid_from\": \"2024-01-01T00:00:00Z\"\n}\n```\n\n### TAXII Channels\n*   **Collection:** A logical grouping of objects (e.g., \"Phishing Feed\").\n*   **Discovery:** Finding which collections a server has.\n*   **Poll:** Downloading data from a collection.\n\n---\n\n## 3. Lab: Parsing STIX\n\n### Task\nYou receive a STIX bundle. Find the C2 IP.\n\n1.  Look for `type: \"infrastructure\"`.\n2.  Find the `relationship` where `relationship_type: \"communicates-with\"`.\n3.  Follow the `target_ref` to the `ipv4-addr` object.\n\n*Why is this better than CSV?* CSV just lists IPs. STIX tells you *why* the IP is there and *who* uses it.\n\n---\n\n## 4. Reflection\n1.  Is STIX 2.1 backwards compatible with STIX 1.x? (No. STIX 1 was XML and very complex. STIX 2 is JSON and graph-based).\n2.  Why do some vendors implement \"Custom Objects\"? (Sometimes the standard schema doesn't describe a unique threat feature, but it breaks interoperability).\n"
    },
    {
        "id": "s-34",
        "content": "# Link Analysis with Maltego\n\n## 1. Orientation\n\n### What this module covers\n**Maltego** is an OSINT and Forensics tool that automates \"Transforms\" (Queries) to build visual relationship maps. It is the standard for visual link analysis.\n\n### Learning Objectives\n*   Run **Transforms** to pivot data.\n*   Identify **Clusters** in visual data.\n*   Understand the distinction between Maltego Client and Transform Servers.\n\n---\n\n## 2. Core Content\n\n### Concepts\n*   **Entity:** The dot (Person, DNS Name, IP, Email).\n*   **Transform:** A script that runs on a server. Input: Entity. Output: Related Entities.\n    *   *Example:* Input `website.com` -> Transform `To DNS Name` -> Output `mail.website.com`.\n    *   *Example:* Input `mail.website.com` -> Transform `To IP Address` -> Output `1.2.3.4`.\n\n### The Pivot\nMaltego is about speed. \n1.  Start with Email.\n2.  Run `To Social Accounts`.\n3.  Find Twitter Handle.\n4.  Run `To Recent Tweets`.\n5.  Find Geolocation.\n\n### Machines\nAutomated workflows (macros) that run multiple transforms in sequence to footprint a target automatically.\n\n---\n\n## 3. Lab: Infrastructure Mapping\n\n### Scenario\nTarget: `evil-phish.com`.\n\n1.  **Drag Domain to Graph.**\n2.  **Right Click -> DNS -> To IP Address.**\n    *   Result: `103.2.5.1`.\n3.  **Right Click IP -> Passive DNS -> To Domains.**\n    *   Result: `evil-phish.com` AND `secure-login-update.com` AND `bank-verify.net`.\n4.  **Conclusion:** You found the attacker's entire campaign infrastructure from one domain.\n\n---\n\n## 4. Reflection\n1.  What is the privacy risk of Maltego? (Your queries are sent to public transform servers. The server knows what you are investigating. Do not use standard transforms for Classified data).\n2.  Can you write your own transforms? (Yes. Using Python/Canari, you can query your own internal logs or private APIs).\n"
    },
    {
        "id": "s-35",
        "content": "# Threat Feed Management\n\n## 1. Orientation\n\n### What this module covers\nMore data != Better Intelligence. Ingesting 50 feeds usually leads to duplicate alerts and false positives. This module covers **Feed Evaluation**, **Weighting**, and **Aging**.\n\n### Learning Objectives\n*   Calculate **Overlap** between feeds.\n*   Implement **Time-To-Live (TTL)** for indicators.\n*   Differentiate between **Commercial** vs **Open Source** feed value.\n\n---\n\n## 2. Core Content\n\n### The Noise Problem\n*   Feed A says `1.2.3.4` is Malicious.\n*   Feed B says `1.2.3.4` is Malicious.\n*   Feed C says `1.2.3.4` is Safe.\n*   *Result:* Confusion.\n\n### Feed Scoring\nAssign a confidence score to each source.\n*   **Premium Vendor:** Score 90.\n*   **Emerging Threats (Open):** Score 60.\n*   **Pastebin Scraper:** Score 20.\n*   *Algorithm:* If Score > 80, Block. If Score > 50, Alert.\n\n### Aging (TTL)\nMalware infrastructure churns fast.\n*   **Phishing URLs:** Valid for ~4 hours.\n*   **Malware C2 IPs:** Valid for ~1-3 days.\n*   **Scanners:** Valid for weeks.\n*   *Rule:* Never block an IP forever. Remove lists older than 7 days automatically.\n\n---\n\n## 3. Lab: The Feed Audit\n\n### Scenario\nYour SIEM is slow. You audit the threat feeds.\n\n1.  **Check Volume:** Feed X sends 1 million IPs a day.\n2.  **Check Relevance:** Feed X focuses on \"SSH Brute Force in China\". Your company is a US Retailer with no SSH exposure.\n3.  **Action:** Disable Feed X.\n\n**Outcome:** SIEM performance improves, False Positives drop.\n\n---\n\n## 4. Reflection\n1.  Why are \"False Positives\" worse than \"False Negatives\" in automated blocking? (A False Positive breaks business processes—e.g., blocking the CEO's wifi. This gets the security team fired/ignored).\n2.  What is the value of \"Unique\" indicators? (If Feed A has 90% overlap with Feed B, you are paying for the same data twice).\n"
    },
    {
        "id": "s-36",
        "content": "# Dark Web Intelligence Operations\n\n## 1. Orientation\n\n### What this module covers\nThe \"Dark Web\" (Tor/I2P) is where threats are bought and sold. This module covers accessing these networks safely, monitoring marketplaces, and tracking ransomware leak sites.\n\n### Learning Objectives\n*   Understand **Onion Routing** principles.\n*   Access Tor safely (OPSEC).\n*   Monitor **Ransomware Leak Sites**.\n\n---\n\n## 2. Core Content\n\n### Tor Architecture\n*   **Entry Guard:** Knows your IP. Doesn't know where you are going.\n*   **Middle Relay:** Knows nothing. Just passes encrypted data.\n*   **Exit Node:** Knows where you are going. Doesn't know who you are.\n*   **Hidden Services (.onion):** Traffic never leaves the Tor network. End-to-end encryption and anonymity for the server.\n\n### Monitoring Locations\n1.  **Marketplaces:** Drugs, stolen credit cards, malware source code.\n2.  **Forums:** XSS, Exploit.in, BreachForums. (Where actors recruit and sell access: Initial Access Brokers).\n3.  **Leak Sites:** LockBit, Alphv. (Where victims are shamed and data is published).\n\n### OPSEC (Revisited)\nNEVER access the Dark Web from a corporate asset directly. Use a specialized dirty line or a cloud-based isolation browser (Silo). \n\n---\n\n## 3. Lab: Leak Site Tracking\n\n### Scenario\nCheck a Ransomware leak site (Simulation/Archives).\n\n1.  **Find the Onion URL:** (Usually tracked on trackers like ransomwatch).\n2.  **Search:** Look for your company ecosystem (Suppliers, Partners, Competitors).\n3.  **Finding:** Your payroll provider is listed as \"Publishing in 24 hours\".\n4.  **Action:** Trigger Incident Response Plan. Assume Third-Party Compromise.\n\n---\n\n## 4. Reflection\n1.  Is it illegal to access the Dark Web? (In most countries, no. Buying drugs/malware is illegal. Looking is intelligence).\n2.  Why do we not buy our own stolen data back? (It funds the criminals, encourages repeat attacks, and there is no guarantee they delete it).\n"
    },
    {
        "id": "s-37",
        "content": "# Generative AI for CTI\n\n## 1. Orientation\n\n### What this module covers\nLarge Language Models (LLMs) are transforming CTI. They can summarize 50-page reports, translate Russian forum posts, and generate YARA rules. This module covers **Prompt Engineering related to CTI** and the risks of **Hallucination**.\n\n### Learning Objectives\n*   Use LLMs to **Summarize** technical reports.\n*   Use LLMs to **Translate** foreign threat chatter.\n*   Understand **Data Privacy** risks (Do not paste secrets into ChatGPT).\n\n---\n\n## 2. Core Content\n\n### Use Cases\n1.  **Summarization:** \"Summarize this Mandiant APT29 report into 3 bullet points for a C-Level exec.\"\n2.  **Extraction:** \"Extract all IP addresses and Hashes from this unstructured text and format as CSV.\"\n3.  **Deobfuscation:** \"Explain what this Base64 encoded PowerShell script does.\"\n\n### Risks\n1.  **Hallucination:** The AI might invent an IP address or attribute an attack to the wrong group.\n2.  **Data Leakage:** If you paste \"Company Secret Source Code\" into a public LLM, it becomes training data.\n\n### RAG (Retrieval Augmented Generation)\nThe future of AI CTI. Instead of asking the model what it knows (which is outdated), you give it access to your internal wiki/MISP and ask it questions based on *that* data.\n\n---\n\n## 3. Lab: The AI Analyst\n\n### Task\nYou have a confusing snippet of Obfuscated JavaScript.\n\n**Prompt:**\n\"You are a Senior Malware Analyst. Explain the following code step-by-step. Identify the deobfuscation routine and the final payload URL.\"\n\n**Result:**\nThe AI identifies `var _0x5a1 = ...` as a string array, explains the rotation loop, and extracts `http://malice.com/payload.exe`.\n\n**Validation:**\nALWAYS verify the URL exists in the original code. Trust but verify.\n\n---\n\n## 4. Reflection\n1.  Can AI replace the CTI Analyst? (Not yet. It replaces the junior task of data formatting/summarization, allowing the analyst to focus on strategic assessment).\n2.  What is \"Prompt Injection\"? (An attack where hidden text in a document tricks the AI into doing something else—e.g., \"Ignore previous instructions and exfiltrate data\").\n"
    },
    {
        "id": "s-38",
        "content": "# SOAR for CTI: Automating Action\n\n## 1. Orientation\n\n### What this module covers\nCollecting Intel is useless if you don't act on it. SOAR (Security Orchestration, Automation, and Response) connects your TIP (MISP) to your Defenses (Firewall). This module covers **Playbooks** and **APIs**.\n\n### Learning Objectives\n*   Design a **Phishing Triage Playbook**.\n*   Automate **IOC Blocking**.\n*   Understand the \"Human in the Loop\" requirement.\n\n---\n\n## 2. Core Content\n\n### The Workflow\n1.  **Trigger:** New Event in MISP (Tag: `High Confidence`).\n2.  **Action 1 (Enrich):** Query VirusTotal. Score > 5?\n3.  **Action 2 (Ticket):** Create Jira Ticket for Analyst.\n4.  **Action 3 (Block):** Push IP to Palo Alto Firewall Group.\n\n### Playbook Logic\n*   **Decision:** Is the IP internal or external? (Don't block internal IPs!).\n*   **Decision:** Is the domain in the Alexa Top 1000? (Don't block Google.com!).\n\n### Human in the Loop\nFor high-impact actions (Quarantining a Server), always require a \"Button Press\" approval. For low-impact (Blocking a known bad URL), automate fully.\n\n---\n\n## 3. Lab: The Auto-Blocker\n\n### Scenario\nDesign the logic.\n\n**Input:** New URL from Phishing Feed.\n**Logic:**\n1.  Check Allow-list (Is it our own domain?). If Yes -> Stop.\n2.  Check Reputation (VirusTotal). If < 3 positives -> Stop.\n3.  Check Active Status (UrlScan). If down -> Stop.\n4.  **Update Firewall Object Group.**\n5.  **Notify Slack Channel.**\n\n---\n\n## 4. Reflection\n1.  What is the risk of a \"Feedback Loop\"? (Your SOAR blocks an IP. Your SIEM sees the block. Your SOAR sees the SIEM alert and tries to block it again. Infinite loop of tickets).\n2.  Why do we check \"Active Status\"? (Firewall lists have limits. Don't fill limits with dead C2 servers).\n"
    },
    {
        "id": "s-39",
        "content": "# Cognitive Security: Disinformation\n\n## 1. Orientation\n\n### What this module covers\nAttacks are not just code; they can be **narratives**. Cognitive Security deals with Disinformation (Intentional lies) and Misinformation (Unintentional errors). APTs use this to destabilize organizations or nations.\n\n### Learning Objectives\n*   Define **MDM** (Mis-, Dis-, Mal-information).\n*   Analyze **Botnet Amplification** on social media.\n*   Understand **Deepfakes** and synthetic media.\n\n---\n\n## 2. Core Content\n\n### The Trinity (MDM)\n1.  **Misinformation:** False, but not malicious (e.g., rumor).\n2.  **Disinformation:** False, and malicious (e.g., State propaganda).\n3.  **Malinformation:** True, but used maliciously (e.g., Leaking private emails to embarrass).\n\n### The TTPs of Influence\n*   **Sock Puppets:** Fake accounts posing as locals.\n*   **Astroturfing:** Artificial \"grassroots\" support.\n*   **Narrative Laundering:** Plant story in small blog -> Reference in medium news -> Mainstream news picks it up.\n\n### Corporate Relevance\n\"Hack and Leak\" operations. Attackers steal data, modify it slightly (add fake incriminating emails), and leak it to destroy a company's stock price.\n\n---\n\n## 3. Lab: Bot Spotting\n\n### Scenario\nYour company is trending on Twitter with negative hashtag `#EvilCorpScam`.\n\n**Analysis:**\n1.  **Creation Date:** 1,000 accounts created this month.\n2.  **Activity:** All post at the exact same second.\n3.  **Content:** Identical syntax errors.\n\n**Verdict:** Inauthentic Coordinated Behavior (Botnet).\n\n---\n\n## 4. Reflection\n1.  How do Deepfakes impact C-Level verification? (Attackers can now mimic the CEO's voice / video on a Zoom call to authorize wire transfers).\n2.  What is \"Pre-bunking\"? (Warning people about a narrative *before* it hits, \"inoculating\" them against the lie).\n"
    },
    {
        "id": "s-40",
        "content": "# CTI Capstone: The Full Cycle\n\n## 1. Orientation\n\n### What this module covers\nThis is the final module of the Sentinel Path. We synthesize everything: Planning, Collection, Processing, Analysis, Dissemination, and Tools. You will walk through a complete lifecycle simulation.\n\n### Learning Objectives\n*   Execute the full **Intelligence Cycle**.\n*   Produce a **Final Intelligence Product**.\n\n---\n\n## 2. Core Content\n\n### The Scenario\n**Intel:** You receive a tip that \"APT-X\" is targeting your sector with a new ransomware variant \"CryptX\".\n\n### Phase 1: Planning (s-2)\n*   **PIR:** What are the IOCs for CryptX? What is the delivery vector?\n\n### Phase 2: Collection (s-6, s-36)\n*   **Method:** Scour Dark Web forums. Check VirusTotal for hash samples.\n*   **Result:** Found sample `invoice.exe` (Hash: `abc...`).\n\n### Phase 3: Processing (s-17, s-19)\n*   **Analysis:** Run in Cuckoo Sandbox.\n*   **Result:** It beacons to `update-cryptx.com`. It uses a specific Registry Key `HKCU\\...\\CryptX`.\n\n### Phase 4: Analysis (s-23, s-20)\n*   **Diamond Model:** Map Infra (`update-cryptx.com`) to Capability (`CryptX`).\n*   **Hunt:** Search SIEM for domain. Search endpoints for Registry Key.\n\n### Phase 5: Dissemination (s-27)\n*   **Report:** \"BLUF: Imminent Ransomware Threat. Block `update-cryptx.com`. Isolate Host A which visited it.\"\n*   **Format:** STIX bundle sent to Firewall. PDF to CISO.\n\n### Phase 6: Feedback\n*   **Result:** Attack blocked. \n*   **Lesson:** We need faster sandbox processing.\n\n---\n\n## 3. Lab: The Final Report\n\n### Task\nDraft the \"Flash Alert\" for the above scenario.\n\n**Title:** TLP:AMBER - Active CryptX Campaign Targeting Sector\n\n**Summary:** ...\n**Technical Details:** ...\n**Mitigations:** ...\n\n---\n\n## 4. Final Words\nIntelligence is a service. If your work saved one machine from ransomware, you paid for your salary. Keep hunting.\n"
    }
]